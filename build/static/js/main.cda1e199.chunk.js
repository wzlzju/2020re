(window.webpackJsonpVISI2020=window.webpackJsonpVISI2020||[]).push([[0],{195:function(e,t){var a=[["\u4ea4\u901a\u8bbe\u65bd","Transport"],["\u4f11\u95f2\u5a31\u4e50","Entertainment"],["\u516c\u53f8\u4f01\u4e1a","Enterprise"],["\u533b\u7597","Hostipal"],["\u653f\u5e9c\u673a\u6784","Goverment"],["\u65c5\u6e38\u666f\u70b9","Tourist Attraction"],["\u751f\u6d3b\u670d\u52a1","Living Service "],["\u7f8e\u98df","Food"],["\u8d2d\u7269","Shooping"],["\u8fd0\u52a8\u5065\u8eab","Gym"]],n=["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],r={};a.map((function(e,t){r[e]=n[t]})),e.exports={POI_TYPES:a,POI_COLOR_MAP:r}},353:function(e,t){},467:function(e,t,a){e.exports=a.p+"static/media/arrow-circle.57861174.png"},495:function(e,t,a){e.exports=a(806)},500:function(e,t,a){},502:function(e,t,a){},507:function(e,t,a){},669:function(e,t,a){},732:function(e,t,a){},733:function(e,t){},738:function(e,t){e.exports="data:image/png;base64,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"},787:function(e,t){},789:function(e,t,a){},790:function(e,t,a){},791:function(e,t,a){},792:function(e,t,a){},793:function(e,t,a){},794:function(e,t,a){},795:function(e,t,a){},803:function(e,t,a){},804:function(e,t,a){},805:function(e,t,a){},806:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(30),o=a.n(i);a(500),a(501),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var c=a(3),s=a(4),l=a(6),u=a(5),d=a(7),m=(a(502),a(8)),h=a(98),p=(a(507),a(452)),f=function(){function e(){return Object(c.a)(this,e),e.instance||(e.instance=this,this.ev=new p),e.instance}return Object(s.a)(e,null,[{key:"get",value:function(){return(e.instance?e.instance:new e).ev}}]),e}();f.instance=null;var v=a(842),g=a(821),b=a(856);function y(e,t){var a=parseInt(e.slice(1,3),16),n=parseInt(e.slice(3,5),16),r=parseInt(e.slice(5,7),16);return t>=0?[a,n,r,Math.round(255*t)]:[a,n,r,255]}function k(e,t,a,n){var r=document.getElementById("tooltip"+n);e?(r.innerHTML=e.message,r.style.display="block",r.style.left=t+"px",r.style.top=a+"px"):r.style.display="none"}var E=[];function S(){for(var e=function(){return Math.random().toFixed(5).slice(2)},t=e();-1!=E.indexOf(t);)t=e();return E.push(t),t}function w(e,t){var a=g.a(b.a("#ffffff","#800026"),9);return a.unshift("rgb(255,255,255)"),a=a.map((function(e){return function(e){function t(e){var t=e.toString(16);return 1==t.length?"0"+t:t}var a=/\d+/g;return function(e,a,n){return"#"+t(e)+t(a)+t(n)}(parseInt(a.exec(e)[0]),parseInt(a.exec(e)[0]),parseInt(a.exec(e)[0]))}(e)})),v.a().domain(function(e,t){var a,n;if(void 0===t){var r=!0,i=!1,o=void 0;try{for(var c,s=e[Symbol.iterator]();!(r=(c=s.next()).done);r=!0){var l=c.value;null!=l&&(void 0===a?l>=l&&(a=n=l):(a>l&&(a=l),n<l&&(n=l)))}}catch(g){i=!0,o=g}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}}else{var u=-1,d=!0,m=!1,h=void 0;try{for(var p,f=e[Symbol.iterator]();!(d=(p=f.next()).done);d=!0){var v=p.value;null!=(v=t(v,++u,e))&&(void 0===a?v>=v&&(a=n=v):(a>v&&(a=v),n<v&&(n=v)))}}catch(g){m=!0,h=g}finally{try{d||null==f.return||f.return()}finally{if(m)throw h}}}return[a,n]}(e,t)).range(a)}var O=a(454),C=a(838),x=a(46),j=a(854),P=a(859),N=a(839),I=a(847),M=a(845),R=a(301),A=(a(826),a(853));a(669),C.a.Panel,x.a.createFromIconfontCN({scriptUrl:"//at.alicdn.com/t/font_1663760_lf9grftcv9g.js"});function T(e,t){return e?r.a.createElement(j.a,{className:"config-row",key:e.id+"-"+e.prop},r.a.createElement(P.a,{span:8},r.a.createElement("div",{className:"config-label"},e.label||e.prop)),r.a.createElement(P.a,{span:10},r.a.createElement(N.a,{min:e.min,max:e.max,step:e.step,onChange:t&&t.onParamChange.bind(t,e.id,e.prop),value:"number"===typeof e.value?e.value:0})),r.a.createElement(P.a,{span:2}),r.a.createElement(P.a,{span:4},r.a.createElement(I.a,{size:"small",min:e.min,max:e.max,step:e.step,value:e.value,onChange:t&&t.onParamChange.bind(t,e.id,e.prop)}))):r.a.createElement("div",null)}function L(e,t){return e?r.a.createElement(j.a,{className:"config-row",key:e.id+"-"+e.prop},r.a.createElement(P.a,{span:8},r.a.createElement("div",{className:"config-label"},e.label||e.prop)),r.a.createElement(P.a,{span:12}),r.a.createElement(P.a,{span:4},r.a.createElement(M.a,{className:"config-color",overlay:r.a.createElement(O.ChromePicker,{color:e.value,onChangeComplete:function(a){t&&t.onParamChange.call(t,e.id,e.prop,a.hex)}})},r.a.createElement(R.a,{style:{backgroundColor:e.value,width:"90%"}})))):r.a.createElement("div",null)}n.Component;var D=function(e,t){return parseFloat(e.toFixed(t))},F={longitude:120.66714,latitude:28.01308,zoom:12,maxZoom:16,pitch:0,bearing:0},B=[{layerId:"AnonymousTrajectoryLayer",renderParam:{widthScale:{value:-5,min:-20,max:5,step:1,renderFunc:T},arrowSize:{value:.5,min:.1,max:1,step:.01,renderFunc:T},translate:{value:10,min:0,max:1e3,step:1,renderFunc:T},scale:{value:.8,min:.1,max:1,step:.05,renderFunc:T},strokeColor:{value:"#5c5050",renderFunc:L},strokeOpacity:{value:1,min:.1,max:1,step:.01,renderFunc:T}}},{layerId:"ChoroplethMap",renderParam:{strokeWidth:{value:10,min:0,max:60,step:.1,renderFunc:T},strokeColor:{value:"#5c5050",renderFunc:L},strokeOpacity:{value:.5,min:0,max:1,step:.01,renderFunc:T},fillOpacity:{value:.45,min:0,max:1,step:.01,renderFunc:T}}},{layerId:"VoronoiRegion",renderParam:{strokeWidth:{value:10,min:.1,max:30,step:.1,renderFunc:T},strokeColor:{value:"#5c5050",renderFunc:L},strokeOpacity:{value:.5,min:.1,max:1,step:.01,renderFunc:T}}},{layerId:"PublicPoiPointsLayer",renderParam:{size:{value:20,min:1,max:100,step:1,renderFunc:T},opacity:{value:1,min:0,max:1,step:.01,renderFunc:T}}}],V=a(53),W=a(13),G=a(471),z=a(846),Q=a(259),Y=(a(732),a(163)),Z=function(e){var t=e.data,a=void 0===t?[]:t,n=e.visible,r=void 0===n||n,i=e.strokeWidth,o=e.strokeColor,c=e.opacity,s=[];return a.map((function(e){s.push(e.map((function(e){return[e.lng,e.lat]})))})),new Y.a({id:"PublicPolylineLayer",data:s,visible:r,pickable:!0,getWidth:i,getPath:function(e){return e},getColor:y(o,c),onHover:function(e){e.object,e.x,e.y}})},H=a(265),U=a(29),J=a(429),_=a(346),q=a(860),X=a(212),K=a(77);_.a;function $(e,t){var a=K.point(e),n=K.point(t);return K.distance(a,n,{units:"kilometers"})}function ee(e,t){var a=K.point(e),n=K.point(t);return(90-K.bearing(a,n))/180*Math.PI}function te(e,t){return e+Math.random()*(t-e)}function ae(e,t,a,n,r,i){return 1==i?Array(e).fill(0).map((function(e){return[te(t,a),te(n,r)]})):2==i?Array(e).fill(0).map((function(e){return{lng:te(t,a),lat:te(n,r)}})):void 0}var ne=function(e,t){var a=e.data,n=void 0===a?[]:a,r=e.visible,i=void 0===r||r,o=e.radius,c=e.fillColor,s=e.strokeColor,l=e.opacity;return new H.a({id:"pointLayer",data:n,visible:i,getPosition:function(e){return e.coordinates},getFillColor:y(c,1),getLineColor:y(s,1),getRadius:o,opacity:l,pickable:!0,stroked:!0,filled:!0,radiusMinPixels:1,radiusMaxPixels:100,lineWidthMinPixels:1,onHover:function(e){return k(e.object,e.x,e.y,t)}})};function re(e,t,a){var n=e.data,r=void 0===n?{}:n,i=e.visible,o=void 0===i||i,c=e.strokeOpacity,s=void 0===c?1:c,l=e.strokeWidth,u=void 0===l?1:l,d=e.strokeColor,m=void 0===d?"#5c5050":d,h=e.fillOpacity,p=void 0===h?.6:h;if(r)return console.log(r),new ie(Object(V.a)({},e,{data:r,visible:o,opacity:s,width:u,fillOpacity:p,strokeColor:m,layerId:"choroplethmap"+t}))}var ie=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"renderLayers",value:function(){var e=this;return[new J.a({id:"".concat("ChoroplethMapLayer","-polygon-layer-").concat(this.props.layerId),visible:this.props.visible,data:this.props.data,pickable:!0,stroked:!0,filled:!0,wireframe:!0,lineWidthMinPixels:1,extruded:!1,getPolygon:function(e){return e.polygon},updateTriggers:{getFillColor:this.props.fillOpacity},getFillColor:function(t){return y(t.fillColor,e.props.fillOpacity)},getLineColor:y(this.props.strokeColor,this.props.opacity),getLineWidth:this.props.width,onHover:function(e){e.object,e.x,e.y},lineWidthUnits:"meters"})]}}]),t}(_.a);ie.layerName="ChoroplethMapLayer";function oe(e,t,a){var n=e.data,r=void 0===n?{}:n,i=e.visible,o=void 0===i||i,c=e.strokeOpacity,s=void 0===c?1:c,l=e.strokeWidth,u=void 0===l?1:l,d=e.strokeColor,m=void 0===d?"#5c5050":d,h=e.fillOpacity,p=void 0===h?.6:h;if(r)return[new ce(Object(V.a)({},e,{data:r,visible:o,opacity:s,width:u,fillOpacity:p,strokeColor:m,layerId:"voronois"+t}))]}var ce=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"renderLayers",value:function(){var e=this;return[new J.a({id:"".concat("VoronoiLayer","-polygon-layer-").concat(this.props.layerId),visible:this.props.visible,data:this.props.data,pickable:!0,stroked:!0,filled:!0,wireframe:!0,lineWidthMinPixels:1,extruded:!1,getPolygon:function(e){return e.polygon},updateTriggers:{getFillColor:this.props.highLightId},getFillColor:function(t){var a,n=e.props.highLightId;t.fillColor;if(n)a=n!=t.id?[255,255,255,0]:y("#111111",0);else{a=y(a=t.fillColor?t.fillColor:"#ffffff",t.fillColor?e.props.fillOpacity:0)}return a},getLineColor:y(this.props.strokeColor,this.props.opacity),getLineWidth:this.props.width,onHover:function(e){e.object,e.x,e.y},lineWidthUnits:"meters"})]}}]),t}(_.a);ce.layerName="VoronoiLayer";var se=a(450),le=a(18),ue=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"getShaders",value:function(){return Object(V.a)({},Object(le.a)(Object(u.a)(t.prototype),"getShaders",this).call(this))}},{key:"initializeState",value:function(){Object(le.a)(Object(u.a)(t.prototype),"initializeState",this).call(this),this.state.attributeManager.addInstanced({instanceAngles:{size:1,accessor:"getAngle"}})}}]),t}(H.a),de=a(77),me=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"renderLayers",value:function(){var e=this;return[new se.a({id:"".concat("RegionMoveLayerVector","-line"),data:this.props.data,visible:this.props.visible,getSourcePosition:function(e){return[e.fromPoint.lng,e.fromPoint.lat]},getTargetPosition:function(e){return[e.toPoint.lng,e.toPoint.lat]},getColor:function(t){return y(e.props.vectorColor,e.props.vectorOpacity)},updateTriggers:{getWidth:this.props.width},getWidth:function(t){return e.props.width*t.support},widthScale:1,widthUnits:"meters"}),new ue({id:"".concat("RegionMoveLayerVector","-arrow-scatter"),data:this.props.data,visible:this.props.visible,getPosition:function(e){return[e.toPoint.lng,e.toPoint.lat]},getColor:function(t){return y(e.props.arrowColor,e.props.vectorOpacity)},updateTriggers:{getRadius:this.props.width},getAngle:function(e){return e.fromPoint,e.toPoint,0},getRadius:function(t){return e.props.width*t.support},radiusScale:.5,widthUnits:"meters"})]}}]),t}(_.a);me.layerName="RegionMoveLayerVector";a(738);var he=function(e,t){var a=e.visible,n=void 0===a||a,r=e.data,i=void 0===r?[]:r,o=e.opacity,c=void 0===o?1:o,s=e.size,l=void 0===s?10:s;return new H.a({id:"PublicGeoLocationLayer",data:i,visible:n,getPosition:function(e){return[e.lng,e.lat]},getFillColor:function(e){return y(e.color,c)},getLineColor:function(e){return y(e.color,c)},getRadius:l,opacity:c,pickable:!0,stroked:!0,filled:!0,radiusMinPixels:1,radiusMaxPixels:100,lineWidthMinPixels:1,onHover:function(e){return k(e.object,e.x,e.y,t)}})},pe=a(197),fe=function(e,t){var a,n=[],r=f.get();switch(e.method){case"polygon":a=pe.DrawPolygonMode;break;case"rect":a=pe.DrawRectangleMode;break;case"circle":a=pe.DrawCircleFromCenterMode;break;default:a=pe.ViewMode,n=[0]}return new pe.EditableGeoJsonLayer({id:"framSelect",visible:e.visible,data:e.data,mode:a,selectedFeatureIndexes:n,getFillColor:y("#1f78b4",.1),getLineColor:y("#000000",.7),getLineWidth:1,lineWidthMinPixels:2,lineWidthMaxPixels:2,getTentativeFillColor:[255,255,255,0],getLineDashArray:[1,2],onEdit:function(e){var a=e.updatedData,n=e.editType;e.featureIndexes;"addFeature"==n&&r.emit(t+"endMapFrameSelect",a)}})},ve=a(264),ge=a(69),be=a(467),ye=function(e,t){var a=e.visible,n=void 0===a||a,r=f.get(),i=e.center,o=e.radius,c=e.nest,s=Object(X.default)(i,o,{steps:64}).geometry.coordinates,l=i;s[0].map((function(e){e[0]>l[0]&&(l=e)}));var u={icon:[{id:"icon",coordinates:l,nest:c}],circle:s};return new ke({id:"".concat("circleLayer","-").concat(c),data:u,handleDragStart:function(e){var a=e.object;a&&"icon"==a.id&&r.emit(t+"startMoveCircleHandle")},handleDrag:function(e){var a=e.coordinate,n=e.object;if(n&&"icon"==n.id){var o=Object(ge.default)(i,a);r.emit(t+"movingCircleHanle",{radius:o,nest:n.nest})}},handleDragEnd:function(e){r.emit(t+"endMoveCircleHandle")},handleHover:function(e){},visible:n,fillOpacity:"inner"==c?.5:.1})},ke=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"initializeState",value:function(){}},{key:"renderLayers",value:function(){var e=this;return[new J.a({id:"".concat("circleLayer","-circle-polygon-layer")+Ee(),data:this.props.data.circle,visible:this.props.visible,pickable:!1,stroked:!0,filled:!0,wireframe:!0,lineWidthMinPixels:2,lineWidthMaxPixels:2,getPolygon:function(e){return e},getFillColor:function(t){return y("#1f78b4",e.props.fillOpacity)},getLineColor:y("#000000",.7),getLineWidth:2}),new ve.a({id:"".concat("circleLayer","-icon-layer")+Ee(),data:this.props.data.icon,visible:this.props.visible,getIcon:function(e){return{url:be,width:128,height:128}},sizeScale:2,getPosition:function(e){var t=e.coordinates;return t.push(100),t},getSize:20,pickable:!0,autoHighlight:!0})]}},{key:"onHover",value:function(e){this.props.handleHover(e)}},{key:"onDragStart",value:function(e){this.props.handleDragStart(e)}},{key:"onDrag",value:function(e){this.props.handleDrag(e)}},{key:"onDragEnd",value:function(){this.props.handleDragEnd()}}]),t}(_.a);function Ee(e){return Math.random().toFixed(5).slice(2)}ke.layerName="CircleSelectLayer";var Se=a(64),we=function(e){var t=e.viewport,a=e.data,i=e.widthScale,o=void 0===i?-5:i,c=e.strokeColor,s=void 0===c?"#5c5050":c,l=e.strokeOpacity,u=void 0===l?1:l,d=e.visible,m=void 0===d||d,h=e.translate,p=void 0===h?0:h,f=e.scale,v=void 0===f?.8:f,g=e.arrowSize,b=void 0===g?1:g;if(!t||!a)return null;var y=t.width,k=t.height,E=t.project,S=Object(n.useRef)(null),w=(a=a.filter((function(e){return e.start!=e.end}))).map((function(e){var t=function(e,t,a,n){var r=a||.8,i=[e.lng,e.lat],o=[t.lng,t.lat],c=de.lineString([i,o]),s=de.transformScale(c,r),l=de.bearing(i,o)+90,u=de.transformTranslate(s,n/1e3,l),d=Object(W.a)(u.geometry.coordinates,2),m=d[0],h=d[1];return[{lng:m[0],lat:m[1]},{lng:h[0],lat:h[1]}]}(e.fromPoint,e.toPoint,v,p),a=Object(W.a)(t,2),n=a[0],r=a[1];return{from:E([n.lng,n.lat]),to:E([r.lng,r.lat]),support:e.support}}));return Object(n.useEffect)((function(){!function(){t.width,t.height,t.project;var e=Se.e(S.current).select("g").selectAll(".arrow-line").data(w);e.exit().remove().style("transform",(function(e){return"rotate3d(1, 0, 0, ".concat(t.pitch,"deg)")}));var a=e.enter().append("line").attr("class","arrow-line");Se.e(S.current).select("defs").select("#arrow").select("path").style("fill",s);e.merge(a).attr("x1",(function(e){return e.from[0]})).attr("y1",(function(e){return e.from[1]})).attr("x2",(function(e){return e.to[0]})).attr("y2",(function(e){return e.to[1]})).style("transform-origin",(function(e){return"0px  ".concat(e.to[1],"px")})).style("transform",(function(e){return"rotate3d(1, 0, 0, ".concat(t.pitch,"deg)")})).attr("stroke-width",(function(e){return e.support*Math.pow(2,o)})).style("opacity",m?u:0).attr("stroke",s).attr("marker-end","url(#arrow)")}()})),r.a.createElement("svg",{style:{position:"absolute",pointerEvents:"none"},viewBox:"0 0 ".concat(y," ").concat(k),ref:S},r.a.createElement("defs",null,r.a.createElement("marker",{id:"arrow",markerWidth:"24",markerHeight:"24",viewBox:"0 0 ".concat(24/b," ").concat(24/b),refX:"8",refY:"12",markerUnits:"userSpaceOnUse",orient:"auto"},r.a.createElement("path",{d:"M4,4 L20,12 L4,20 L12,12 L4,4",style:{fill:"#f00"}}))),r.a.createElement("g",null))};var Oe=function(e,t){if(e){var a=[];return Object.keys(e).map((function(n){var r,i=e[n];switch(n){case"framSelect":r=fe;break;case"ChoroplethMap":r=re;break;case"VoronoiRegion":r=oe;break;case"PublicWeiboPointsLayer":r=ne;break;case"AnonymousPointsLayer":r=re;break;case"PublicTrajectoryLayer":r=Z;break;case"AnonymousTrajectoryLayer":break;case"PublicPoiPointsLayer":r=he;break;case"circle":r=ye;break;default:return}if(i){if(!r)return;if(Array.isArray(r))r.map((function(e){a.push(e.call(null,i,t))}));else{if(ye==r)return a.push(ye(Object(V.a)({},i,{radius:i.outerRadius,nest:"outer"}),t)),void a.push(ye(Object(V.a)({},i,{radius:i.innerRadius,nest:"inner"}),t));a.push(r.call(null,i,t,n))}}})),a}},Ce=function(e){var t=e.mapId,a=Oe(e.params,t),i=Object(n.useState)(),o=Object(W.a)(i,2),c=o[0],s=o[1],l=Object(n.useRef)();return Object(n.useEffect)((function(){var t=l.current,a=t.clientWidth,n=t.clientHeight,r=Object(V.a)({},F,{width:e.width||a,height:e.height||n});s(new Q.a(r))}),[]),r.a.createElement("div",{id:"map",ref:l},r.a.createElement(z.a,{controller:e.controller,layers:a,initialViewState:F,getCursor:function(){return e.params.framSelect&&e.params.framSelect.cursor?"crosshair":"grab"},onViewStateChange:function(e){var t=e.viewState;s(new Q.a(t))}},r.a.createElement(G.a,{reuseMaps:!0,mapStyle:"mapbox://styles/mapbox/light-v9",preventStyleDiffing:!0,mapboxApiAccessToken:"pk.eyJ1IjoieWtqYWdlIiwiYSI6ImNrNnp5dzZhbjFhMHczbm12OTR5bmU4ankifQ.cOEClSRYNtYFUAFhnUEXhA"})),r.a.createElement(we,Object.assign({viewport:c},e.params.AnonymousTrajectoryLayer)),r.a.createElement("div",{id:"tooltip".concat(t),style:{position:"absolute",zIndex:1,pointerEvents:"none"}}))},xe=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).getId=function(){return a.state.id},a.state={id:S(),params:{},layersParams:{},controller:!0},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){var e=this.state,t=e.id,a=e.layersParams,n=this.props,r=n.params,i=n.datas,o=f.get();o.on(t+"startMapFrameSelect",this.setFrameSelect,this),o.on(t+"endMapFrameSelect",this.finishFrameSelect,this),o.on(t+"changeMapFrameSelectVisible",this.showFrameSelect,this),o.on(t+"changeMapCircleSelectVisible",this.changeCircleSelectVisible,this),o.on(t+"movingCircleHanle",this.updatePoint,this),o.on(t+"endMoveCircleHandle",this.handleDragEnd,this),o.on(t+"startMoveCircleHandle",this.handleDragStart,this),a=je(i,r,a),this.setState({layersParams:a}),r||this.setState({params:r}),this.updatePoint({})}},{key:"componentDidMount",value:function(){this.props.onRef&&this.props.onRef(this)}},{key:"componentWillUnmount",value:function(){}},{key:"componentWillReceiveProps",value:function(e){var t=this.state,a=t.params,n=t.layersParams;e.params&&e.datas&&(n=je(e.datas,e.params,n),this.setState({params:a,layersParams:n}),this.print({params:e.params,datas:e.datas}))}},{key:"render",value:function(){var e=this.state,t=e.layersParams,a=e.controller,r=e.id,i=this.props;return n.createElement("div",{className:"deck-map"},n.createElement(Ce,Object.assign({},i,{params:t,controller:a,mapId:r})))}},{key:"setFrameSelect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"rect",t=arguments.length>1?arguments[1]:void 0,a=this.state.layersParams,n={cursor:!0,method:e,data:t||{type:"FeatureCollection",features:[]},visible:!0};a.framSelect=n,a.framSelect.cursor=!0,a.framSelect.method=e,this.setState({layersParams:a})}},{key:"finishFrameSelect",value:function(e){var t=this.state.layersParams,a=e.features,n=t.framSelect.data.features;t.framSelect={cursor:!1,draw:!1,data:{type:"FeatureCollection",features:n.concat(a)},visible:!0},this.setState({layersParams:t})}},{key:"updateFrameSelect",value:function(e){var t=this.state.layersParams;t.framSelect={cursor:!1,draw:!1,data:e,visible:!0},this.setState({layersParams:t})}},{key:"showFrameSelect",value:function(e){var t=this.state.layersParams;t.framSelect&&(t.framSelect.visible=e,this.setState({layersParams:t}))}},{key:"updatePoint",value:function(e){var t=e.center,a=e.radius,n=e.nest,r=this.state.layersParams;if(t=t||[F.longitude,F.latitude],a=a||2,n){var i=r.circle,o=i.innerRadius,c=i.outerRadius;"inner"==n?a<=c-.1&&a>0&&(r.circle.innerRadius=a):"outer"==n&&a>=o+.1&&(r.circle.outerRadius=a)}else r.circle={center:t,innerRadius:a,outerRadius:a+1,visible:!1};this.setState({layersParams:r})}},{key:"changeCircleSelectVisible",value:function(e){var t=this.state.layersParams;t.circle.visible=e,this.setState({layersParams:t})}},{key:"handleDragStart",value:function(){this.setState({controller:!1})}},{key:"handleDragEnd",value:function(){var e=this.state,t=e.id,a=e.layersParams;this.setState({controller:!0}),f.get().emit(t+"endCircleRadiusChange",a.circle)}},{key:"print",value:function(e){0}}]),t}(n.Component),je=function(e,t,a){return e&&t?(Object.keys(t).map((function(e){a[e]||(a[e]={}),a[e]=t[e]})),Object.keys(e).map((function(t){a[t]||(a[t]={}),a[t].data=e[t]})),a):a},Pe=a(848),Ne=(a(789),a(12)),Ie=a.n(Ne),Me=a(24),Re=C.a.Panel,Ae=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={configs:B},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){this.state.configs.map((function(e){e.renderParam.visible={value:!0}}))}},{key:"componentDidMount",value:function(e){var t=this.props.handleRenderParamChange,a=this.state.configs;t&&t(Be(a))}},{key:"onParamChange",value:function(e,t,a){var n=this.state.configs,r=Le(e),i=Object(W.a)(r,2),o=i[0],c=i[1];n.map((function(e){e.layerId==o&&(e[c][t].value=a)})),this.setState({configs:n});var s=this.props.handleRenderParamChange;"renderParam"==c&&s&&s(Be(n))}},{key:"geneRenderPanel",value:function(e,t){var a=this;return De(t,(function(t,n){var r=Te(e,"renderParam"),i=t,o=Object(V.a)({id:r,prop:i},n);if(n.renderFunc)return n.renderFunc.call(null,o,a)}))}},{key:"geneQueryPanel",value:function(e,t){var a=this.props.mapId;"circleRadius"in t&&(t.circleRadius.mapId=a);var n=this;return De(t,(function(t,a){var r=Te(e,"dataQueryParam"),i=t,o=Object(V.a)({id:r,prop:i},a);return a.renderFunc.call(null,o,n)}))}},{key:"handleQueryData",value:function(){var e=Object(Me.a)(Ie.a.mark((function e(t){var a,n,r,i,o;return Ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=this.state.configs,n=this.props.handleQuery,r={},i=0;case 4:if(!(i<a.length)){e.next=13;break}if((o=a[i]).layerId!=t){e.next=10;break}return r=o.dataQueryParam,o.loading=!0,e.abrupt("break",13);case 10:i++,e.next=4;break;case 13:if(r=Fe(r),this.setState({configs:a}),!n){e.next=21;break}return e.next=18,n(t,r);case 18:a[i].length=e.sent,a[i].loading=!1,this.setState({configs:a});case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"geneOneLayer",value:function(e){var t=e.layerId,a=e.renderParam;e.dataQueryParam,e.loading,e.length;return r.a.createElement(Re,{key:Te(t,"renderParam"),header:t,showArrow:!1,extra:Ve(Te(t,"renderParam"),a.visible.value,this)},this.geneRenderPanel(t,a))}},{key:"render",value:function(){var e=this,t=this.state.configs;return r.a.createElement(C.a,{expandIconPosition:"right",defaultActiveKey:[t[0].layerId]},t.map((function(t){return e.geneOneLayer(t)})))}}]),t}(n.Component),Te=function(e,t){return"".concat(e).concat(";").concat(t)},Le=function(e){return e.split(";")};function De(e,t){var a;return Object.keys(e).map((function(n){return a=e[n],t(n,a)}))}var Fe=function(e){var t={};return Object.keys(e).map((function(a){t[a]=e[a].value})),t},Be=function(e){var t={};return e.map((function(e){t[e.layerId]=Fe(e.renderParam)})),t},Ve=function(e,t,a){return r.a.createElement(x.a,{type:t?"eye":"eye-invisible",onClick:function(n){t=!t,a.onParamChange(e,"visible",t),n.stopPropagation()}})},We=x.a.createFromIconfontCN({scriptUrl:"//at.alicdn.com/t/font_1663760_0bsgedjrt1bo.js"}),Ge=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).handleGlobalSetFrameRegion=function(e){var t=a.mapRef.getId(),n=f.get();n.emit(t+"changeMapFrameSelectVisible",!0),n.emit(t+"startMapFrameSelect"),a.handleGlobalFrameRegionCallBack(e)},a.handleGlobalFrameRegionCallBack=function(e){var t=a.state.mapId,n=f.get(),r=t+"endMapFrameSelect";n.once(r,(function(a){n.emit(e+"finishGlobalFrameRegion",a),n.emit(t+"changeMapFrameSelectVisible",!1)}),Object(m.a)(a))},a.handleRenderParamChange=function(e){a.setState({params:e})},a.state={configVisible:!1,params:{}},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){console.log(" global map init ")}},{key:"componentDidMount",value:function(){var e=this.mapRef.getId();this.setState({mapId:e}),f.get().on("globalSetFrameRegion",this.handleGlobalSetFrameRegion,this)}},{key:"render",value:function(){var e=this,t=this.props.map.data,a=this,n=this.state,i=n.configVisible,o=n.params;return r.a.createElement("div",{className:"app"},r.a.createElement(xe,Object.assign({},t,{params:o,ref:function(e){return a.mapRef=e}})),r.a.createElement(Pe.a,{placement:"left",onClose:function(){return e.setState({configVisible:!1})},mask:!1,visible:i,getContainer:!1,style:{position:"absolute",opacity:.9,left:"-10px",width:"400px",pointerEvents:i?"all":"none"},width:450},r.a.createElement(Ae,{mapId:this.state.mapId,handleQuery:this.handleQuery,handleRenderParamChange:this.handleRenderParamChange})),i?null:r.a.createElement("div",{className:"config-btn"},r.a.createElement(R.a,{onClick:function(){return e.setState({configVisible:!0})},type:"primary",shape:"circle",size:"large"},r.a.createElement(We,{type:"icon-configuration"}))))}}]),t}(n.Component),ze=Object(h.b)((function(e){return{map:e.map}}),(function(e){return{}}))(Ge),Qe=a(468),Ye=a(852),Ze={width:500,height:300},He={width:300,height:400},Ue=a(851),Je=(a(790),function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).handleNodeDelete=function(){var e=a.props,t=e.id,n=e.onNodeDelete;n&&n(t)},a.state={},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=this.props.connectDragSource,a=e.type,n=e.x,i=e.y,o=e.width,c=e.height,s=e.source,l=e.num;return t(r.a.createElement("div",{className:"node",style:{width:o,height:c,left:n,top:i,border:"2px solid ".concat(s?s.color:"#AFABAB")}},"TYPE_COND_NODE"==a?r.a.createElement("div",{className:"node-header"},r.a.createElement("div",{style:{width:"50px"}}),r.a.createElement("input",{className:"node-header__title",defaultValue:"Condition Node"}),r.a.createElement("div",{className:"node-header__btn-area"},r.a.createElement(R.a,{className:"zoom-btn"},r.a.createElement(We,{type:"icon-zuixiaohua"})),r.a.createElement(R.a,{className:"close-btn",onClick:this.handleNodeDelete},r.a.createElement(We,{type:"icon-guanbi"})))):r.a.createElement("div",{className:"node-header",style:{backgroundColor:s.color}},r.a.createElement(We,{className:"node-header__type-icon",type:s.icon}),r.a.createElement("div",{className:"node-header__title"},s.name," x ",_e(l,a)),r.a.createElement(R.a,{className:"close-btn",onClick:this.handleNodeDelete},r.a.createElement(We,{type:"icon-guanbi"}))),e.children))}}]),t}(n.Component));Je.defaultProps={x:20,y:20};var _e=function(e,t){return"TYPE_RES_PUBLIC_NODE"==t?e:e<=10?"(below 10)":(e=Math.floor(e/10))+"0+"};var qe=Je=Object(Ue.a)("NODE",{beginDrag:function(e){return{id:e.id,x:e.x,y:e.y}}},(function(e,t){return{connectDragSource:e.dragSource(),isDragging:t.isDragging()}}))(Je),Xe=(a(791),function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).onChange=function(e){var t=e.target.value,n=a.props,r=n.onChange,i=n.id;r&&r.call(null,i,t)},a.state={},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.title,a=e.value,n=e.unit;return r.a.createElement("div",{className:"config__row"},r.a.createElement("div",{className:"config__row__title"},t),r.a.createElement("input",{className:"config__row__number",onChange:this.onChange,defaultValue:a}),r.a.createElement("div",{className:"config__row__unit"},n))}}]),t}(n.Component));Xe.defaultProps={title:"xxx",value:123,unit:"km",onChange:function(){}};var Ke=Xe,$e=(a(792),a(849)),et=a(832),tt=a(833),at=a(1),nt=a.n(at),rt=(a(793),function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={width:360,height:60},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){}},{key:"componentWillReceiveProps",value:function(e){(function(e,t){var a=e.startTime,n=e.endTime,r=t.startTime,i=t.endTime;return!(a||n||r||i)||!(!a&&!n&&r&&i)&&(a.toString()==r.toString()&&n.toString()==i.toString())})(this.props,e)||this.renderTimeline(e)}},{key:"componentDidMount",value:function(){var e=this,t=this.containRef,a=t.clientWidth;t.clientHeight;this.setState({width:a,height:60},(function(){e.renderTimeline()}))}},{key:"renderTimeline",value:function(e){this.clearTimeline(),this.setTimeScale(e),this.setAxis(),this.setZoom(),this.setBrush()}},{key:"setTimeScale",value:function(e){var t=this.state,a=t.width,n=(t.height,e||this.props),r=n.startTime,i=n.endTime;r&&i?(r="2000-01-01 "+r,i="2000-01-01 "+i):(r="2000-01-01 00:00:00",i="2000-01-01 12:00:00");var o=new Date(r),c=new Date(i),s=[o,c],l=Se.d().range([0,a-30]),u=Se.d().range([0,a-30]);l.domain(s),u.domain(s),this.timeScale=l,this.timeScale2=u,this.timeStart=o,this.timeEnd=c}},{key:"setAxis",value:function(){var e=this.timeScale,t=this.state,a=(t.width,t.height,Se.a(e));a.ticks(4).tickFormat(Se.f("%H:%M"));var n=Se.e(this.refs.axisSvg).append("g").call(a);n.attr("transform","translate(".concat(15,", -2 )")),this.syncAsix=function(){n.call(a)}}},{key:"setZoom",value:function(e){var t=this,a=Se.e(this.refs.zoomSvg),n=Se.g().scaleExtent([.5,100]).on("zoom",(function(){t.zoomedFunc()}));a.call(n)}},{key:"zoomedFunc",value:function(){var e=this.timeScale,t=this.timeScale2,a=this.s,n=Se.c.transform;if(a){var r=[e.invert(a[0]),e.invert(a[1])];e.domain(n.rescaleX(t).domain());var i=[e(r[0]),e(r[1])];this.syncAsix(),this.syncBrush(i)}}},{key:"setBrush",value:function(){var e=this,t=this,a=this.state,n=a.width,r=(a.height,Se.b().extent([[0,0],[n-30,10]]).on("start",(function(){e.setBrushStyle()})).on("brush",(function(){e.s=Se.c.selection,e.setBrushStyle()})).on("end",t.hanldeTimeChange.bind(t)));this.setBrushStyle(),Se.e(this.refs.brushSvg).append("g").call(r).call(r.move,[0,n-30]).attr("transform","translate(".concat(15,",").concat(20,")")),this.syncBrush=function(e){Se.e(t.refs.brushSvg).select("g").call(r.move,e)}}},{key:"hanldeTimeChange",value:function(){var e=this.state,t=(e.height,e.width,e.brushRadius,this.timeStart),a=this.timeEnd,n=this.timeScale,r=this.props.onChange,i=Se.e(this.refs.brushSvg),o=+i.select(".handle--w").attr("x")+3,c=+i.select(".handle--e").attr("x")+3,s=n.invert(o),l=n.invert(c);t.toString()==s.toString()&&a.toString()==l.toString()||(this.timeStart=s,this.timeEnd=l,r&&r(s,l))}},{key:"clearTimeline",value:function(){Se.e(this.refs.axisSvg).selectAll("*").remove(),Se.e(this.refs.brushSvg).selectAll("*").remove(),Se.e(this.refs.zoomSvg).selectAll("*").remove()}},{key:"render",value:function(){var e=this,t=this.state,a=t.width,n=t.height;return r.a.createElement("div",{className:"timeline-contain",ref:function(t){return e.containRef=t}},a>=10&&n>=10?r.a.createElement(r.a.Fragment,null,r.a.createElement("svg",{ref:"axisSvg",width:a,height:n}),r.a.createElement("svg",{ref:"zoomSvg",className:"zoom-contain",width:a,height:n}),r.a.createElement("svg",{ref:"brushSvg",className:"brush-contain",width:a,height:n})):null)}},{key:"setBrushStyle",value:function(){var e=this.state.height-40;e=e>10?e:10;var t=Se.e(this.refs.brushSvg);t.select(".selection").attr("height",e),t.select(".overlay").attr("height",e),t.select(".handle--e").attr("width",e).attr("height",e).attr("transform","translate(-".concat(e/2,",0)")).attr("rx",e).attr("ry",e).attr("y",0),t.select(".handle--w").attr("width",e).attr("height",e).attr("transform","translate(-".concat(e/2,",0)")).attr("rx",e).attr("ry",e).attr("y",0)}}]),t}(n.Component));Map.propTypes={startTime:nt.a.string,endTime:nt.a.string,width:nt.a.number,height:nt.a.number,onChange:nt.a.func};var it=rt,ot=(a(794),function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).handleChange=function(e){var t=a.props.changeStep;t&&t(e)},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.steps,n=t.current;return r.a.createElement("div",{className:"steps-contain"},a.map((function(t,i){var o=i<n,c=i!=a.length-1?r.a.createElement(st,{checked:o}):null;return r.a.createElement(r.a.Fragment,null,r.a.createElement(ct,{title:t.title,i:i,checked:o,handleClick:e.handleChange}),c)})))}}]),t}(n.Component));function ct(e){var t=e.checked,a=e.title,n=e.handleClick,i=e.i;return r.a.createElement("div",{className:t?"step-contain":"step-contain unchecked",onClick:n.bind(null,i+1)},a)}function st(e){var t=e.checked;return r.a.createElement("div",{className:t?"arrow-contain":"arrow-contain unchecked"},r.a.createElement(We,{type:"icon-arrow-"}))}ot.defaultProps={current:1,steps:[{title:"Spatial Partition"},{title:"Information Graph"},{title:"Exploration"}]};$e.a.Step;var lt=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).changeStep=function(e){a.setState({current:e})},a.handleValueChange=function(e,t){var n=a.state.params;n.map((function(a){a.id==e&&(a.value=t)})),a.setState({params:n})},a.handleRun=Object(Me.a)(Ie.a.mark((function e(){var t,n,r,i,o,c,s,l,u;return Ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=a.state,n=t.current,r=t.params,i=a.props,o=i.id,c=i.condNodeId,s=i.source,e.t0=n,e.next=1===e.t0?5:2===e.t0?12:3===e.t0?18:24;break;case 5:return u=dt(r,"minRaidus"),a.setState({running:!0}),l={radius:u,id:o,condNodeId:c,source:s},e.next=10,a.props.onSpatialPartition(l);case 10:return a.setState({running:!1}),e.abrupt("break",24);case 12:return a.setState({running:!0}),l=a.getCondition(),e.next=16,a.props.onInformationGraph(l);case 16:return a.setState({running:!1}),e.abrupt("break",24);case 18:return a.setState({running:!0}),l=a.getCondition(),e.next=22,a.props.onVisualization(l);case 22:return a.setState({running:!1}),e.abrupt("break",24);case 24:case"end":return e.stop()}}),e)}))),a.handleTimeChange=function(e,t){var n=a.state,r=(n.params,n.region,[e.toString(),t.toString()]),i=a.getCondition({timeRange:r});a.props.onVisualization(i),a.setState({timeRange:r})},a.handleRegionSelect=function(){var e=Object(m.a)(a),t=a.props.id,n=f.get(),r=t+"finishGlobalFrameRegion";n.once(r,(function(t){var a=t.features[0].geometry.coordinates[0],n=e.getCondition({region:a});e.props.onVisualization(n),e.setState({region:a})})),n.emit("globalSetFrameRegion",t)},a.getCondition=function(e){var t=a.state,n=t.params,r=t.timeRange,i=t.region,o=a.props,c=o.id,s=o.condNodeId,l=o.source;return Object(V.a)({k:dt(n,"k"),timeInterval:dt(n,"time"),id:c,condNodeId:s,region:i,timeRange:r,source:l},e)},a.switchToGlobalMap=function(){var e=a.props,t=e.data,n=e.id;a.props.switchToGlobalMap({data:t,id:n})},a.state={current:1,steps:[{title:"Spatial Partition"},{title:"Information Graph"},{title:"Exploration"}],running:!1,params:[{id:"minRaidus",title:"Minimum Distance Within a Aroup",value:1,unit:"km",step:1},{id:"maxRaidus",title:"Maximum Region Radius",value:2,unit:"km",step:1},{id:"time",title:"Time Interval",value:10,unit:"min",step:2},{id:"k",title:"K in K-Anonymity",value:5,unit:"",step:3}],timeRange:null,region:null},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=this.state,n=a.current,i=a.steps,o=a.params;a.running;return r.a.createElement(qe,t,r.a.createElement("div",{className:"naviga"},r.a.createElement(ot,{current:n,changeStep:this.changeStep,steps:i})),r.a.createElement("div",{className:"left"},r.a.createElement("div",{className:"config"},1==n?r.a.createElement("div",{className:"select-contain"},r.a.createElement(et.a,{className:"header"}," Partition Method "),r.a.createElement("select",null,r.a.createElement("option",{value:"1"},"density-based clustering"),r.a.createElement("option",{value:"2"},"NxN grid clustering"),r.a.createElement("option",{value:"3"},"using station region"))):null,r.a.createElement(et.a,{className:"header"}," Parameters "),o.filter((function(e){return e.step==n})).map((function(t){return r.a.createElement(Ke,Object.assign({key:t.id},t,{onChange:e.handleValueChange}))}))),r.a.createElement("div",{className:"bottom"},r.a.createElement(R.a,{type:"primary",color:"red",loading:this.state.running,onClick:this.handleRun,className:"submit-btn type-public"},3!=n?"Run":"Visualization"))),3!=n?r.a.createElement("div",{className:"right float-box"},r.a.createElement(xe,t.data),r.a.createElement("div",{className:"open-btn"},r.a.createElement(R.a,{onClick:this.switchToGlobalMap,size:"small"},r.a.createElement(We,{type:"icon-open_in_new-px"})))):r.a.createElement("div",{className:"right config divide-left"},r.a.createElement(et.a,{className:"header"}," Region Selection "),r.a.createElement("div",{className:"config__icon"},r.a.createElement("div",{className:"config__icon__title"},"Rectangle"),r.a.createElement("div",{className:"config__icon__entity"},r.a.createElement(R.a,{onClick:this.handleRegionSelect,size:"small"},r.a.createElement(We,{type:"icon-box-select"})))),r.a.createElement(et.a,{className:"header"}," Timeline  "),r.a.createElement("div",{className:"config__time"},r.a.createElement(it,{startTime:t.timeRange&&t.timeRange.start,endTime:t.timeRange&&t.timeRange.end,onChange:this.handleTimeChange})),r.a.createElement("div",{className:"bottom",style:{paddingLeft:"5px"}},r.a.createElement(R.a,{type:"primary",loading:!1,onClick:null,className:"submit-btn type-public"}," Save as Picture "))))}}]),t}(n.Component),ut=Object(h.b)((function(e){e.map;return{}}),(function(e){return{switchToGlobalMap:function(t){return e({type:"SWITCH_TO_GLOBAL_MAP",payload:t})}}}))(lt),dt=function(e,t){var a=new Map;e.map((function(e){return a.set(e.id,e)}));var n=a.get(t);return n?n.value:null},mt=a(836),ht=a(840),pt=(a(795),a(169)),ft=a(469),vt=a.n(ft),gt=a(195),bt={mainTitle:{fontSize:18,color:"#707070",textAlign:"center"}},yt=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.statics,t=Object.keys(e).map((function(t){return{type:t,count:e[t]}})),a=(new vt.a).createView().source(t);return a.source(t).transform({type:"sort",callback:function(e,t){return t.count-e.count}}),r.a.createElement(pt.Chart,{scale:{count:{alias:"Numbers"},type:{alias:"Types"}},data:a,forceFit:!0,height:220,padding:[20,30,30,20]},r.a.createElement("h3",{className:"main-title",style:bt.mainTitle},"The Distirbuion of POI's Types"),r.a.createElement(pt.Coord,null),r.a.createElement(pt.Axis,{title:{offset:10,position:"end"},label:null,name:"type"}),r.a.createElement(pt.Axis,{title:{offset:5,position:"end"},label:null,name:"count"}),r.a.createElement(pt.Tooltip,null),r.a.createElement(pt.Geom,{type:"interval",position:"type*count",color:"#FB8072",tooltip:["type*count",function(e,t){return{name:e,value:t}}]}))}}]),t}(r.a.Component),kt=(mt.a.TabPane,ht.a.Option,function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).switchToGlobalMap=function(){var e=a.props,t=e.data,n=e.id;a.props.switchToGlobalMap({data:t,id:n})},a.handleCheck=function(e){console.log(e)},a.geneRecords=function(){var e=Object(m.a)(a).props.data.datas.PublicPoiPointsLayer;return r.a.createElement("div",{className:"record-contain"},r.a.createElement("div",{className:"head-row record-row"},r.a.createElement("div",{className:"record-row__check"},r.a.createElement("input",{type:"checkbox",onClick:a.handleCheck.bind(Object(m.a)(a),"*"),id:"all"}),r.a.createElement("label",{htmlFor:"all"}," ")),r.a.createElement("div",{className:"record-row__title"},"Select ALL")),r.a.createElement("div",{className:"record-area"},e.map((function(e,t){return r.a.createElement("div",{className:"record-row"},r.a.createElement("div",{className:"record-row__check",key:t},r.a.createElement("input",{type:"checkbox",onClick:a.handleCheck.bind(Object(m.a)(a),t),id:t}),r.a.createElement("label",{htmlFor:t}," ")),r.a.createElement("div",{className:"record-row__title"},e.name))}))))},a.geneStatics=function(){var e=a.state.subMode;return r.a.createElement("div",{style:{position:"relative",width:"100%",height:"100%"}},r.a.createElement("div",{className:"middle"},1==e?a.geneMa():a.geneChart()),r.a.createElement("div",{className:"left",style:{float:"right"}},r.a.createElement("div",{className:1==e?"sub choose":"sub",onClick:function(){a.setState({subMode:1})}},"HeatMap"),r.a.createElement("div",{className:2==e?"sub choose":"sub",onClick:function(){a.setState({subMode:2})}},"Types")))},a.geneMa=function(){var e=Object(m.a)(a).props;return r.a.createElement(xe,e.data)},a.geneChart=function(){var e=Object(m.a)(a).props;return r.a.createElement(yt,e.data)},a.state={mode:2,subMode:2},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=this.state.mode;return r.a.createElement(qe,t,r.a.createElement("div",{className:"public"},r.a.createElement("div",{className:"left"},r.a.createElement("div",{className:1==a?"sub choose":"sub",onClick:function(){e.setState({mode:1})}},"Data Records"),r.a.createElement("div",{className:2==a?"sub choose":"sub",onClick:function(){e.setState({mode:2})}},"Data Statistics")),r.a.createElement("div",{className:"right"},1==a?this.geneRecords():this.geneStatics())))}}]),t}(n.Component)),Et=Object(h.b)((function(e){e.map;return{}}),(function(e){return{switchToGlobalMap:function(t){return e({type:"SWITCH_TO_GLOBAL_MAP",payload:t})}}}))(kt),St=(a(803),a(855).a.Group,function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).handleTimeChange=function(e,t){var n=t.target.value,r=a.state.time;r[e]=n,a.setState({time:r})},a.handleRegionSelect=function(){var e=Object(m.a)(a),t=a.state.maps,n=a.props.id,r=f.get(),i=n+"finishGlobalFrameRegion";r.once(i,(function(a){var n=e.state.regions;t.push({params:{framSelect:{cursor:!1,draw:!1,visible:!0}},datas:{framSelect:a}});var r=a.features[0].geometry.coordinates[0];n.push(r),e.setState({maps:t,regions:n})})),r.emit("globalSetFrameRegion",n)},a.handleCondDelete=function(e,t){var n=a.state.regions;t.preventDefault();var r=a.state.maps;r=r.filter((function(t,a){return t!=e||(n.splice(a,1),!1)})),a.setState({maps:r,regions:n})},a.handleQuery=Object(Me.a)(Ie.a.mark((function e(){var t,n,r,i,o,c,s,l,u;return Ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.state,n=t.selected,r=t.time,i=t.regions,o=t.checkedList,c=a.props,s=c.onQuery,l=c.id,u={condNodeId:l,source:n,time:r,checkedList:o,regions:i[0]},!s){e.next=9;break}return a.setState({querying:!0}),e.next=7,s(l,u);case 7:e.sent,a.setState({querying:!1});case 9:case"end":return e.stop()}}),e)}))),a.onChangeType=function(e){a.setState({checkedList:e,indeterminate:!!e.length&&e.length<gt.POI_TYPES.length,checkAll:e.length===gt.POI_TYPES.length})},a.onCheckAllChange=function(e){a.setState({checkedList:e.target.checked?gt.POI_TYPES:[],indeterminate:!1,checkAll:e.target.checked})},a.state={dataSource:[{name:"people",color:"#80B1D3",icon:"icon-7"},{name:"weibo",color:"#80B1D3",icon:"icon-weibo"},{name:"taxi",color:"#80B1D3",icon:"icon-chuzuche"},{name:"poi",color:"#FB8072",icon:"icon-poi"}],selected:null,time:{start:"00:00",end:"23:59"},regions:[],querying:!1,maps:[],checkedList:gt.POI_TYPES.slice(2,6),indeterminate:!0,checkAll:!1},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){var e=this.state,t=e.dataSource;e.selected;this.setState({selected:t[3]})}},{key:"render",value:function(){var e=this,t=this,a=this.props,n=this.state,i=n.dataSource,o=n.selected,c=n.time,s=n.regions,l=n.maps,u=n.checkedList;return r.a.createElement(qe,a,r.a.createElement("div",{className:"data-source"},i.map((function(e,a){return r.a.createElement(tt.a,{content:e.name,title:null,key:a},r.a.createElement(R.a,{style:{backgroundColor:e.color,opacity:e.name==o.name?1:.3},onClick:function(){t.setState({selected:e})},type:"primary",size:"large"},r.a.createElement(We,{type:e.icon})))}))),r.a.createElement(et.a,{className:"header"},"Input Tools"),r.a.createElement("div",{className:"input"},r.a.createElement("div",{className:"input__row"},r.a.createElement("div",{className:"input__row__title"},"Region Selection"),r.a.createElement("div",{className:"input__row__selectbtn",onClick:this.handleRegionSelect},r.a.createElement(We,{type:"icon-frame-select"}))),"poi"!=o.name?r.a.createElement("div",{className:"input__row"},r.a.createElement("div",{className:"input__row__title"},"Time Selection"),r.a.createElement("div",{className:"input__row__time"},r.a.createElement("input",{onChange:this.handleTimeChange.bind(this,"start"),defaultValue:c.start,className:"input__row__time--start  ".concat(wt(c.start)?"":"error")}),"~",r.a.createElement("input",{onChange:this.handleTimeChange.bind(this,"end"),defaultValue:c.end,className:"input__row__time--end  ".concat(wt(c.end)?"":"error")}))):null),r.a.createElement(et.a,{className:"header"},"Condition List"),r.a.createElement("div",{className:"cond"},l.map((function(t,a){return r.a.createElement("details",{className:"cond__row",key:a},r.a.createElement("summary",null,r.a.createElement("div",{className:"cond__row__title"},"Region"),r.a.createElement("div",{className:"cond__row__btn",onClick:e.handleCondDelete.bind(e,t)},r.a.createElement(We,{type:"icon-shanchu"}))),r.a.createElement("div",{className:"cond__row__map float-box"},r.a.createElement(xe,Object.assign({},t,{ref:function(e){return t.mapRef=e}}))))}))),r.a.createElement("div",{className:"bottom"},r.a.createElement(R.a,{loading:this.state.querying,disabled:!Ot(o,c,s,u),onClick:this.handleQuery,type:"primary",className:"submit-btn"},"Query")))}}]),t}(n.Component)),wt=function(e){var t=e.match(/^(\d\d):(\d\d)$/);if(!t)return!1;var a=parseInt(t[1]),n=parseInt(t[2]);return n>=0&&n<60&&a>=0&&a<24},Ot=function(e,t,a,n){if("poi"==e.name)return n.length>0;var r=null!=e,i=wt(t.start)&&wt(t.end),o=a.length>0;return r&&i&&o},Ct=(a(804),function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).apply(this,arguments))).state={},e}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.width,a=e.height,n=e.links;return r.a.createElement("svg",{className:"links-panel",width:t,height:a},r.a.createElement(jt,null),n.map((function(e,t){return r.a.createElement(xt,{key:t,link:e})})))}}]),t}(r.a.Component));Ct.defaultProps={width:100,height:100};var xt=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).apply(this,arguments))).state={},e}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.link,t=function(e,t,a){a=a||0;var n,r,i,o="M"+e.x+","+e.y+" ";i=-(e.x-t.x)/(t.y-e.y);var c=function(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}},s=c(e,t),l=c(e,s),u=c(s,t);(i>50||i<-50)&&(i=50);return l.x=l.x+a,l.y=i*a+l.y,u.x=u.x-a,u.y=-i*a+u.y,n="C"+l.x+","+l.y+" "+u.x+","+u.y+" ",r=t.x+","+t.y+" ",o+n+r}(e.start,e.end,1);return r.a.createElement("path",{d:t,className:"link",markerEnd:"url(#arrow)",strokeDasharray:"10, 5"})}}]),t}(n.Component);xt.defaultProps={link:{start:{x:100,y:100},end:{x:250,y:250}}};var jt=function(){return r.a.createElement("defs",null,r.a.createElement("marker",{id:"arrow",markerWidth:"26",markerHeight:"26",viewBox:"0 0 36 36",refX:"18",refY:"18",markerUnits:"userSpaceOnUse",orient:"auto"},r.a.createElement("path",{d:"M6,6 L30,18 L6,30 L18,18 L6,6",style:{fill:"#bfbfbf"}})))};var Pt=Ct,Nt=a(183),It=a(193),Mt=a(225),Rt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Object(c.a)(this,e),this.data={},this.queryData={},this.url="ws://".concat("116.62.46.132",":").concat(3001,"/ws"),this.ws=null,this.url+=t,this.queryData=a}return Object(s.a)(e,[{key:"_connect",value:function(){var e=Object(Me.a)(Ie.a.mark((function e(){var t;return Ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Lt(this.url);case 2:this.ws=e.sent,this.queryData=JSON.stringify(this.queryData),this.ws.send(this.queryData),t=this,this.data[Symbol.asyncIterator]=Object(Mt.a)(Ie.a.mark((function e(){return Ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(3==t.ws.readState){e.next=7;break}return e.next=3,Object(It.a)(Dt(t.ws,"message"));case 3:return e.next=5,e.sent.data;case 5:e.next=0;break;case 7:case"end":return e.stop()}}),e)})));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getData",value:function(){var e=Object(Me.a)(Ie.a.mark((function e(){return Ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._connect();case 2:return e.abrupt("return",this.data);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();function At(e){return Tt.apply(this,arguments)}function Tt(){return(Tt=Object(Me.a)(Ie.a.mark((function e(t){var a,n,r,i,o,c,s,l,u,d,m,h=arguments;return Ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=h.length>1&&void 0!==h[1]?h[1]:null,n=new Rt(t,a),e.next=4,n.getData();case 4:r=e.sent,i=!0,o=!1,e.prev=7,s=Object(Nt.a)(r);case 9:return e.next=11,s.next();case 11:return l=e.sent,i=l.done,e.next=15,l.value;case 15:if(u=e.sent,i){e.next=23;break}return d=u,m=JSON.parse(d),e.abrupt("return",m);case 20:i=!0,e.next=9;break;case 23:e.next=29;break;case 25:e.prev=25,e.t0=e.catch(7),o=!0,c=e.t0;case 29:if(e.prev=29,e.prev=30,i||null==s.return){e.next=34;break}return e.next=34,s.return();case 34:if(e.prev=34,!o){e.next=37;break}throw c;case 37:return e.finish(34);case 38:return e.finish(29);case 39:case"end":return e.stop()}}),e,null,[[7,25,29,39],[30,,34,38]])})))).apply(this,arguments)}function Lt(e){return new Promise((function(t,a){var n=new WebSocket(e);n.onopen=function(){t(n)},n.onerror=function(){a(n)}}))}var Dt=function(e,t){return new Promise((function(a){e.addEventListener(t,(function n(){e.removeEventListener(t,n),a.apply(void 0,arguments)}))}))},Ft=0,Bt=function(e,t,a,n){var r="TYPE_COND_NODE"==e?He:Ze;t="TYPE_COND_NODE"==e?t/2:t;for(var i=function(){return{x:t*Math.random()-r.width,y:a*Math.random()-r.height}},o=function(e,t){return!n||e>n.x&&Math.abs(t-n.y)<200},c=i(),s=c.x,l=c.y,u=0;s<0||l<0||!o(s,l);){var d=i();if(s=d.x,l=d.y,++u>1e3)break}return{id:Ft++,type:e,x:s,y:l,width:r.width,height:r.height}},Vt=function(e,t){return{start:{id:e.id,x:e.x+He.width+4,y:e.y+He.height/2},end:{id:t.id,x:t.x-4,y:t.y+Ze.height/2}}},Wt=(a(805),function(e,t){return{id:e,condNodeId:t,k:5,timeInterval:10,region:[[120.60466748065197,28.0314177803758],[120.70310305847188,28.0314177803758],[120.70310305847188,27.983296387860495],[120.60466748065197,27.983296387860495],[120.60466748065197,28.0314177803758]],timeRange:["Sat Jan 01 2000 01:22:00 GMT+0800 (\u4e2d\u56fd\u6807\u51c6\u65f6\u95f4)","Sat Jan 01 2000 08:34:07 GMT+0800 (\u4e2d\u56fd\u6807\u51c6\u65f6\u95f4)"],source:{name:"taxi",color:"#80B1D3",icon:"icon-chuzuche"}}}),Gt=function(e,t){return{id:e,condNodeId:t,k:5,timeInterval:10,region:[[120.60466748065197,28.0314177803758],[120.70310305847188,28.0314177803758],[120.70310305847188,27.983296387860495],[120.60466748065197,27.983296387860495],[120.60466748065197,28.0314177803758]],timeRange:["Sat Jan 01 2000 01:22:00 GMT+0800 (\u4e2d\u56fd\u6807\u51c6\u65f6\u95f4)","Sat Jan 01 2000 08:34:07 GMT+0800 (\u4e2d\u56fd\u6807\u51c6\u65f6\u95f4)"]}},zt=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).handleQuery=function(){var e=Object(Me.a)(Ie.a.mark((function e(t,n){var r,i,o,c,s,l,u,d,m;return Ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log(n),r=a.state.nodes,i=n.source,n.time,n.regions,o=n.condNodeId,c=r.find((function(e){return e.id==o})),(s="poi"==i.name?a.geneNode("TYPE_RES_PUBLIC_NODE",c):a.geneNode("TYPE_RES_NODE",c)).timeRange=n.time,s.source=i,l=Object(V.a)({radius:1},n,{id:s.id}),e.t0=i.name,e.next="taxi"===e.t0?11:"weibo"===e.t0?17:"poi"===e.t0?23:29;break;case 11:return e.next=13,At("/taxiSpatialPartition",l);case 13:return u=e.sent,d=u.num,u={params:{VoronoiRegion:{},AnonymousTrajectoryLayer:{}},datas:{VoronoiRegion:u.data}},e.abrupt("break",30);case 17:return e.next=19,At("/weiboSpatialPartition",l);case 19:return u=e.sent,d=u.num,u={params:{VoronoiRegion:{},ChoroplethMap:{}},datas:{VoronoiRegion:u.data}},e.abrupt("break",30);case 23:return e.next=25,At("/pois",l);case 25:return m=e.sent,d=m.num,u={params:{PublicPoiPointsLayer:{}},datas:{PublicPoiPointsLayer:m.data},statics:m.statics},e.abrupt("break",30);case 29:u=[];case 30:return s.num=d,a.addResNode(s,u,t),e.abrupt("return",s.id);case 33:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),a.handleSpatialPartition=function(){var e=Object(Me.a)(Ie.a.mark((function e(t){var n,r,i,o;return Ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log(t),n=t.id,r=t.source,i=a.state.nodes,e.t0=r.name,e.next="taxi"===e.t0?6:"weibo"===e.t0?10:14;break;case 6:return e.next=8,At("/taxiSpatialPartition",t);case 8:return o=e.sent,e.abrupt("break",15);case 10:return e.next=12,At("/weiboSpatialPartition",t);case 12:return o=e.sent,e.abrupt("break",15);case 14:o=[];case 15:return i.map((function(e){e.id==n&&(e.num=o.num,e.data.datas.VoronoiRegion=o.data)})),a.setState({nodes:i}),e.abrupt("return");case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.handleInformationGraph=function(){var e=Object(Me.a)(Ie.a.mark((function e(t){var n,r,i,o,c,s;return Ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=a.state.nodes,r=t.id,i=t.source,n.map((function(e){e.id==r&&(c=e)})),e.t0=i.name,e.next="taxi"===e.t0?6:"weibo"===e.t0?11:18;break;case 6:return e.next=8,At("/taxiInformationGraph",t);case 8:return o=e.sent,c.data.datas.AnonymousTrajectoryLayer=o,e.abrupt("break",19);case 11:return e.next=13,At("/weiboInformationGraph",t);case 13:return o=e.sent,s=w(o,(function(e){return e.support})),o=o.map((function(e){return e.fillColor=s(e.support),e})),c.data.datas.ChoroplethMap=o,e.abrupt("break",19);case 18:o=[];case 19:return a.setState({nodes:n}),e.abrupt("return",c);case 21:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.handleVisualization=function(){var e=Object(Me.a)(Ie.a.mark((function e(t){var n,r,i;return Ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,e.next=3,a.handleInformationGraph(t);case 3:return r=e.sent,i=r.data,a.props.switchToGlobalMap({id:n,data:i}),e.abrupt("return");case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.geneNode=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"TYPE_COND_NODE",t=arguments.length>1?arguments[1]:void 0,n=a.panelRef,r=n.scrollHeight,i=n.scrollWidth,o=Bt(e,i,r,t);return o},a.addResNode=function(e,t,n){var r=a.state.nodes;e.data=t,e.condNodeId=n,r.push(e),a.setState({nodes:r});var i=r.find((function(e){return e.id==n}));a.addLink(i,e)},a.addCondNode=function(){var e=a.state.nodes,t=a.geneNode("TYPE_COND_NODE");return e.push(t),a.setState({nodes:e}),t.id},a.addLink=function(e,t){var n=a.state.links;n.push(Vt(e,t)),a.setState({links:n})},a.handleDeleteNode=function(e){var t=a.state,n=t.nodes,r=t.links;n=n.filter((function(t){return t.id!=e})),r=r.filter((function(t){return t.start.id!=e&&t.end.id})),a.setState({nodes:n,links:r})},a.state={nodes:[],width:100,height:100,links:[]},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this.panelRef,t=e.clientWidth,a=e.clientHeight;this.setState({width:t,height:a})}},{key:"moveNode",value:function(e,t,a){var n=this.panelRef,r=n.scrollHeight,i=n.scrollWidth,o=this.state,c=o.nodes,s=o.links;c=c.map((function(n){return n.id==e&&(n.x=t,n.y=a),n})),s=s.map((function(t){var a=t.start,n=t.end;if(a.id==e||n.id==e){var r=c.find((function(e){return e.id==a.id})),i=c.find((function(e){return e.id==n.id}));return Vt(r,i)}return t})),this.setState({nodes:c,links:s,width:i,height:r})}},{key:"render",value:function(){var e=this,t=this,a=this.props.connectDropTarget,n=this.state.nodes;return a(r.a.createElement("div",{className:"query-app",ref:function(e){return t.panelRef=e}},n.map((function(t,a){var n=t.type;return"TYPE_RES_NODE"==n?r.a.createElement(ut,Object.assign({key:a},t,{onNodeDelete:e.handleDeleteNode,onSpatialPartition:e.handleSpatialPartition,onInformationGraph:e.handleInformationGraph,onVisualization:e.handleVisualization})):"TYPE_RES_PUBLIC_NODE"==n?r.a.createElement(Et,Object.assign({key:a},t,{onNodeDelete:e.handleDeleteNode})):r.a.createElement(St,Object.assign({onNodeDelete:e.handleDeleteNode,key:a},t,{onQuery:e.handleQuery}))})),r.a.createElement(Pt,{links:this.state.links,width:this.state.width,height:this.state.height}),r.a.createElement("div",{className:"add-btn"},r.a.createElement(R.a,{onClick:t.addCondNode,type:"primary",shape:"circle",size:"large"},r.a.createElement(We,{type:"icon-add"})))))}},{key:"mockTaxi",value:function(){var e=Object(Me.a)(Ie.a.mark((function e(){var t,a,n;return Ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.addCondNode(),a={condNodeId:0,source:{name:"taxi",color:"#80B1D3",icon:"icon-chuzuche"},time:{start:"01:22",end:"08:45"},regions:[[120.60172173806302,28.03901714020917],[120.7091164652158,28.03901714020917],[120.7091164652158,27.987819597085878],[120.60172173806302,27.987819597085878],[120.60172173806302,28.03901714020917]]},e.next=4,this.handleQuery(t,a);case 4:n=e.sent,a=Wt(t,n);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"mockWeibo",value:function(){var e=Object(Me.a)(Ie.a.mark((function e(){var t,a,n;return Ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.addCondNode(),a={condNodeId:0,source:{name:"weibo",color:"#80B1D3",icon:"icon-weibo"},time:{start:"07:22",end:"08:45"},regions:[[120.60172173806302,28.03901714020917],[120.7091164652158,28.03901714020917],[120.7091164652158,27.987819597085878],[120.60172173806302,27.987819597085878],[120.60172173806302,28.03901714020917]]},e.next=4,this.handleQuery(t,a);case 4:n=e.sent,a=Gt(t,n);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"mockPOI",value:function(){var e=Object(Me.a)(Ie.a.mark((function e(){var t,a;return Ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.addCondNode(),a={condNodeId:0,source:{name:"poi",color:"#FB8072",icon:"icon-poi"}},e.next=4,this.handleQuery(t,a);case 4:e.sent;case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),t}(n.Component),Qt={drop:function(e,t,a){if(!a)return null;var n=t.getItem(),r=t.getDifferenceFromInitialOffset();if(r&&n){var i=Math.round(n.x+r.x),o=Math.round(n.y+r.y);a.moveNode(n.id,i,o)}},hover:function(e,t,a){if(!a)return null}};zt=Object(Ye.a)("NODE",Qt,(function(e,t){return{connectDropTarget:e.dropTarget()}}))(zt);var Yt=zt=Object(h.b)((function(e){return Object(Qe.a)(e),{}}),(function(e){return{switchToGlobalMap:function(t){return e({type:"SWITCH_TO_GLOBAL_MAP",payload:t})}}}))(zt),Zt=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"map-view"},r.a.createElement(ze,null)),r.a.createElement("div",{className:"query-view"},r.a.createElement(Yt,null)))}}]),t}(n.Component),Ht=a(145),Ut={currentMapId:-1,data:{}};var Jt=Object(Ht.b)({map:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ut,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SWITCH_TO_GLOBAL_MAP":return Object(V.a)({},e,{currentMapId:t.payload.id,data:t.payload.data});default:return e}}}),_t=a(834),qt=a(472);o.a.render(r.a.createElement((function(){return r.a.createElement(h.a,{store:Object(Ht.c)(Jt)},r.a.createElement(_t.a,{backend:qt.a},r.a.createElement(Zt,null)))}),null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[495,1,2]]]);
//# sourceMappingURL=main.cda1e199.chunk.js.map