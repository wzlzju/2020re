{"version":3,"sources":["../server/config.js","components/map/layers/arrow-circle.png","components/map/layers/position.png","serviceWorker.js","util/event.js","components/map/util.js","components/config/ConfigRow.js","components/map/config.js","components/map/layers/PublicPolylineLayer.js","components/map/layers/data-utility/SimulationLayer.js","components/map/layers/WeiboSinglePoint.js","components/map/layers/ChoroplethMapLayer.js","components/map/layers/VoronoiLayer.js","components/map/layers/ArrowLayer.js","components/map/layers/RegionMoveLayer.js","components/map/layers/PublicGeoLocationLayer.js","components/map/layers/FrameSelectLayer.js","components/map/layers/CircleLayer.js","components/map/layers/GlyphLayer.js","components/map/Layers.js","components/map/index.js","components/map/Panel.js","components/iconfont.js","MapPanel/index.js","QueryPanel/config.js","components/query/Node.js","components/config/NumberRow.js","components/time/Timeline.js","components/config/Step.js","components/query/ResNode.js","components/chart/line.js","components/query/ResNodePublic.js","components/query/CondNode.js","components/query/Links.js","util/query.js","QueryPanel/util.js","QueryPanel/mock.js","QueryPanel/index.js","App.js","store/map.js","store/index.js","index.js"],"names":["POI_TYPES","POI_COLORS","POI_COLOR_MAP","map","type","i","module","exports","Boolean","window","location","hostname","match","Event","instance","this","ev","EventEmitter","hexToRGBArray","hex","alpha","r","parseInt","slice","g","b","Math","round","setTooltip","object","x","y","mapId","el","document","getElementById","innerHTML","style","display","left","top","ids","generateMapId","fn","random","toFixed","id","indexOf","push","colorScale","numbers","valueof","colors","d3Interpolate","unshift","rgb","rgbString","componentToHex","c","toString","length","reg","rgbToHex","exec","d3Scale","domain","values","min","max","undefined","value","index","_extent","range","Collapse","Panel","Icon","createFromIconfontCN","scriptUrl","NumRow","param","self","className","key","span","step","onChange","onParamChange","bind","size","ColorRow","overlay","color","onChangeComplete","call","Component","floatPrecision","float","num","parseFloat","INITIAL_VIEW_STATE","longitude","latitude","zoom","maxZoom","pitch","bearing","defaultLayerConfigs","layerId","renderParam","widthScale","renderFunc","arrowSize","translate","scale","strokeOpacity","strokeWidth","fillOpacity","opacity","PublicPolylineLayer","subProps","data","visible","strokeColor","paths","line","p","PathLayer","pickable","getWidth","getPath","d","getColor","onHover","turf","require","CompositeLayer","spatialDistance1","a","from","point","to","distance","units","angle1","PI","lower","upper","randomPointList","lnglower","lngupper","latlower","latupper","mode","Array","fill","e","lng","lat","WeiboSinglePoint","radius","fillColor","ScatterplotLayer","getPosition","coordinates","getFillColor","getLineColor","getRadius","stroked","filled","radiusMinPixels","radiusMaxPixels","lineWidthMinPixels","info","createChoroplethMap","console","log","VoronoiLayer","width","PolygonLayer","props","wireframe","extruded","getPolygon","updateTriggers","getLineWidth","lineWidthUnits","layerName","createVoronoiRegionLayer","highLightId","MyArrowPlotLayer","state","attributeManager","addInstanced","instanceAngles","accessor","RegionMoveLayer","LineLayer","getSourcePosition","fromPoint","getTargetPosition","toPoint","widthUnits","getAngle","radiusScale","PublicGeoLocationLayer","FrameSelect","selectedFeatureIndexes","get","DrawPolygonMode","DrawRectangleMode","DrawCircleFromCenterMode","ViewMode","EditableGeoJsonLayer","lineWidthMaxPixels","getTentativeFillColor","getLineDashArray","onEdit","updatedData","editType","featureIndexes","emit","CircleLayer","center","nest","circleData","circle","steps","iconData","lnglat","CircleSelectLayer","handleDragStart","handleDrag","coor","newRadius","handleDragEnd","handleHover","SELECT_FILL_OPACITY","getRamdomStamp","IconLayer","getIcon","url","ICON","height","sizeScale","getSize","autoHighlight","argument","viewport","project","inputEl","useRef","points","filter","p1","p2","scaleRatio","p1Arr","p2Arr","scaleLine","angle","translatedLine","np1","np2","support","useEffect","selected","d3","current","select","selectAll","exit","remove","enter","append","attr","merge","pow","render","viewBox","ref","markerWidth","markerHeight","refX","refY","markerUnits","orient","_getLayers","params","layers","Object","keys","isArray","_fn","Layers","useState","setViewport","mapRef","clientWidth","clientHeight","WebMercatorViewport","controller","initialViewState","getCursor","onViewStateChange","v","viewState","reuseMaps","mapStyle","preventStyleDiffing","mapboxApiAccessToken","GlyphLayer","position","Map","getId","layersParams","datas","on","setFrameSelect","finishFrameSelect","showFrameSelect","changeCircleSelectVisible","updatePoint","mixParamsAndData","setState","onRef","nextProps","print","method","defaultParams","features","newFeatures","originFeatures","concat","innerRadius","outerRadius","obj","React","MyPanel","configs","config","propName","handleRenderParamChange","configRenderParamsGetter","resolveId","paramCategory","iterateObj","renderPropName","paramObject","composeId","prop","queryParam","handleQuery","configObj","paramsValueGetter","layerConfig","dataQueryParam","loading","header","showArrow","extra","genExtraVisibleIcon","geneRenderPanel","expandIconPosition","defaultActiveKey","geneOneLayer","composed","split","paramObj","newPamraObj","res","onClick","event","stopPropagation","MyIcon","MapPanel","handleGlobalSetFrameRegion","fromId","handleGlobalFrameRegionCallBack","eventName","once","newConfigs","configVisible","placement","onClose","mask","getContainer","shape","HOC","connect","dispatch","RES_NODE","COND_NODE","Node","handleNodeDelete","onNodeDelete","connectDragSource","source","border","defaultValue","_formatNumber","children","defaultProps","floor","DragSource","beginDrag","monitor","dragSource","isDragging","NumberRow","target","title","unit","Timeline","prevProps","timeStart","timeEnd","newTimeStart","newTimeEnd","isSameTime","renderTimeline","containRef","clearTimeline","setTimeScale","setAxis","setZoom","setBrush","startTime","endTime","Date","timeRange","timeScale","timeScale2","axisFunc","ticks","tickFormat","topAxis","refs","axisSvg","syncAsix","item","svg","zoomSvg","zoomFunc","scaleExtent","zoomedFunc","s","t","transform","s_t","invert","rescaleX","s_","syncBrush","brushFunc","extent","setBrushStyle","selection","hanldeTimeChange","brushSvg","move","brushRadius","brushG","rectStart","rectEnd","ELEMENT_TOP","propTypes","PropTypes","string","number","func","Steps","handleChange","changeStep","checked","arrow","Arrow","handleClick","Step","ResNode","handleValueChange","paramId","handleRun","condNodeId","minRaidus","getParamsValue","running","condition","onSpatialPartition","getCondition","onInformationGraph","onVisualization","handleTimeChange","start","end","region","handleRegionSelect","k","timeInterval","switchToGlobalMap","paddingLeft","argvs","payload","set","styles","mainTitle","fontSize","textAlign","Basic","statics","count","dv","DataSet","createView","callback","alias","forceFit","padding","offset","label","name","tooltip","ResNodePublic","Tabs","TabPane","Select","Option","handleCheck","geneRecords","pois","htmlFor","poi","geneStatics","subMode","geneMa","geneChart","CondNode","Checkbox","Group","time","maps","regions","handleCondDelete","preventDefault","_map","splice","checkedList","onQuery","querying","onChangeType","indeterminate","checkAll","onCheckAllChange","dataSource","icon","content","backgroundColor","checkTime","disabled","checkCondition","timeStr","hours","minutes","cSource","cTime","cRegion","Links","arguments","links","link","Link","_path","curv","q","l","k2","_center","c0","c1","c2","svgPathCurv","markerEnd","strokeDasharray","ArrowDefine","Query","queryData","ws","JSON","stringify","send","that","Symbol","asyncIterator","readState","oncePromise","_connect","fetchWS","router","getData","parse","Promise","resolve","reject","WebSocket","onopen","onerror","emitter","addEventListener","handler","removeEventListener","idBase","geneNode","baseNode","node","_gen","rightThanBaseNode","abs","geneLink","nodeStart","nodeEnd","taxiGraphCondition","resNodeId","weiboGraphCondition","QueryPanel","nodes","condNode","find","addResNode","handleSpatialPartition","handleInformationGraph","retNode","handleVisualization","panelRef","scrollHeight","scrollWidth","util","startNode","addLink","addCondNode","endNode","handleDeleteNode","connectDropTarget","cond","targetSpec","drop","component","getItem","delta","getDifferenceFromInitialOffset","moveNode","hover","DropTarget","dropTarget","App","INITIAL_STATE","currentMapId","combineReducers","action","ReactDOM","store","createStore","DndProvider","backend","Backend","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.cda1e199.chunk.js","sourcesContent":["var POI_TYPES = [['交通设施', 'Transport'], ['休闲娱乐', 'Entertainment'], ['公司企业', 'Enterprise'], ['医疗', 'Hostipal'], ['政府机构', 'Goverment'], ['旅游景点', 'Tourist Attraction'], ['生活服务', 'Living Service '], ['美食', 'Food'], ['购物', 'Shooping'], ['运动健身', 'Gym']];\nvar POI_COLORS = ['#a6cee3', '#1f78b4', '#b2df8a', '#33a02c', '#fb9a99', '#e31a1c', '#fdbf6f', '#ff7f00', '#cab2d6', '#6a3d9a', '#ffff99', '#b15928'];\nvar POI_COLOR_MAP = {};\nPOI_TYPES.map(function (type, i) {\n  POI_COLOR_MAP[type] = POI_COLORS[i];\n});\nmodule.exports = {\n  POI_TYPES: POI_TYPES,\n  POI_COLOR_MAP: POI_COLOR_MAP\n};","module.exports = __webpack_public_path__ + \"static/media/arrow-circle.57861174.png\";","module.exports = \"data:image/png;base64,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\"","// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\n          );\n        });\n      } else {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the old content will have been purged and\n              // the fresh content will have been added to the cache.\n              // It's the perfect time to display a \"New content is\n              // available; please refresh.\" message in your web app.\n              console.log('New content is available; please refresh.');\n\n              // Execute callback\n              if (config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type').indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","\n/*\n\tsingleton event management\n\tAPI refer https://github.com/primus/eventemitter3\n*/\n\nimport * as  EventEmitter from 'eventemitter3'\n\nexport default class Event {\n\tstatic instance = null\n\tconstructor(){\n\t\tif(!Event.instance){\n\t\t \tEvent.instance = this\n\t\t \tthis.ev = new EventEmitter()\n\t\t}\n\t\treturn Event.instance\n\t}\n\tstatic get(){\n\t\tlet instance =  Event.instance ? Event.instance : new Event()\n\t\treturn instance.ev\n\t}\n}","import * as d3Scale from 'd3-scale'\nimport * as d3Interpolate from 'd3-interpolate'\n\n// https://css-tricks.com/converting-color-spaces-in-javascript/\nexport function hexToRGBArray(hex, alpha) {\n    var r = parseInt(hex.slice(1, 3), 16),\n        g = parseInt(hex.slice(3, 5), 16),\n        b = parseInt(hex.slice(5, 7), 16);\n\n    let arr \n\n    if ( alpha >= 0 ) {\n       arr =  [r , g , b , Math.round( 255 * alpha) ] \n    } else {\n       arr =  [r , g , b , 255] \n    }\n    return arr\n}\n\nexport function setTooltip( object, x, y , mapId ) {\n  const el = document.getElementById('tooltip'+mapId);\n  if (object) {\n    el.innerHTML = object['message'];\n    el.style.display = 'block';\n    el.style.left = x + 'px';\n    el.style.top = y + 'px';\n  } else {\n    el.style.display = 'none';\n  }\n}\n\nexport function rgbToHex( rgbString ){\n  function componentToHex(c) {\n    var hex = c.toString(16);\n    return hex.length == 1 ? \"0\" + hex : hex;\n  }\n  function rgbToHex(r, g, b) {\n    return \"#\" + componentToHex(r) + componentToHex(g) + componentToHex(b);\n  }\n  let reg = /\\d+/g\n  let r  = parseInt(reg.exec( rgbString )[0])\n  let g  = parseInt(reg.exec( rgbString )[0])\n  let b  = parseInt(reg.exec( rgbString )[0])\n  return rgbToHex( r , g , b)\n}\n// console.log( rgbToHex(\"rgb(152, 67, 98)\") )\n\n\nexport function _precision( flaotNum   ){\n  const bitCount = 5\n  return parseFloat( flaotNum.toFixed(bitCount) )\n}\n\n\nconst ids = []\nexport function generateMapId(){\n    let fn = () =>  Math.random().toFixed(5).slice(2),\n        id = fn()\n    while( ids.indexOf(id) != -1 ){\n       id = fn()\n    }\n    ids.push( id )\n    return id \n} \n\nexport function colorScale( numbers , valueof){\n    let colors =  \n      d3Interpolate.quantize(\n        d3Interpolate.interpolateHcl(\"#ffffff\", \"#800026\"),\n        9\n      )\n    colors.unshift('rgb(255,255,255)')\n    colors = colors.map( (rgb) => rgbToHex(rgb) )\n    // console.log( colors )\n    var scale = d3Scale.scaleQuantize()\n      .domain( _extent(numbers , valueof) )\n      .range( colors )\n    return scale\n}\n\n\nfunction  _extent(values, valueof) {\n  let min;\n  let max;\n  if (valueof === undefined) {\n    for (const value of values) {\n      if (value != null) {\n        if (min === undefined) {\n          if (value >= value) min = max = value;\n        } else {\n          if (min > value) min = value;\n          if (max < value) max = value;\n        }\n      }\n    }\n  } else {\n    let index = -1;\n    for (let value of values) {\n      if ((value = valueof(value, ++index, values)) != null) {\n        if (min === undefined) {\n          if (value >= value) min = max = value;\n        } else {\n          if (min > value) min = value;\n          if (max < value) max = value;\n        }\n      }\n    }\n  }\n  return [min, max];\n}","import React, { Component } from 'react';\n\nimport { ChromePicker } from 'react-color';\n\nimport { Collapse,\n         Radio,\n         Icon,\n         Select,\n         Slider,\n         InputNumber,\n         Row,\n         Dropdown,\n         Col , Button, Switch ,Divider } from 'antd';\n\nimport './ConfigRow.scss'\n\nimport Event from '@/util/event'\n\nconst { Panel } = Collapse;\n\n// 参考 https://3x.ant.design/components/icon/#Custom-Font-Icon  // generated by iconfont.cn\nexport const MyIcon = Icon.createFromIconfontCN({\n    scriptUrl : \n        '//at.alicdn.com/t/font_1663760_lf9grftcv9g.js'\n});\n\n\n/*\n  param : {\n      'min' , \n      'max' ,\n      'step' ,\n      'label' ,\n      'value',\n      'id',\n      'prop',  \n  },\n  self : {\n    onParamChange ,\n  }\n*/\nexport function NumRow( param , self) {\n  if( !param ) return (<div></div>)\n  return (\n      <Row className=\"config-row\" key={param['id'] + '-' + param['prop']}>\n\n        <Col span={8}>\n          <div className='config-label'>\n            { param['label'] || param['prop'] } \n          </div>\n        </Col>\n        <Col span={10}>\n          <Slider\n            min={param['min']}\n            max={param['max']}\n            step={param['step']}\n            onChange={self && self.onParamChange.bind(self , param['id']  , param['prop'] )}\n            value={typeof param['value'] === 'number' ?  param['value']  : 0}\n          />\n        </Col>\n        <Col span={2}/>\n        <Col span={4}>\n          <InputNumber\n            size=\"small\"\n            min={param['min']}\n            max={param['max']}\n            step={param['step']}\n            value={  param['value']  }\n            onChange={self && self.onParamChange.bind(self , param['id'] , param['prop']) }\n          />\n        </Col>\n      </Row>\n  )\n}\n\n\n/*\n  param : {\n      'label' ,\n      'value' : '#5c5050' , \n      'id',\n      'prop',  \n  },\n  self : {\n    onParamChange ,\n  }\n*/\n// http://casesandberg.github.io/react-color/\nexport function ColorRow(param , self){\n  if( !param ) return (<div></div>)\n  return (\n      <Row className=\"config-row\" key={ param['id'] + '-' + param['prop'] }>\n        \n        <Col span={8}>\n          <div className='config-label'>\n            { param['label'] || param['prop'] } \n          </div>\n        </Col>\n        <Col span={12}/>\n        <Col span={4}>\n            <Dropdown \n              className='config-color'\n              overlay={ \n                <ChromePicker color={param['value']} onChangeComplete={(color)=>{\n                  self && self.onParamChange.call(self , param['id'] , param['prop'] , color['hex'])}}/> \n              }\n            >\n              <Button  style={{ 'backgroundColor': param['value'] , 'width': '90%' }}></Button>\n            </Dropdown>\n        </Col>\n      </Row>\n  )\n}\n\n/*\n  param : {\n      'label' ,\n      'value' : true , \n      'id',\n      'prop',  \n  },\n  self : {\n    onParamChange ,\n  }\n*/\nexport function ToggleRow(param , self){\n  if( !param ) return (<div></div>)\n\n  return (\n      <Row className=\"config-row\" key={param['id'] + '-' + param['prop']}>\n        <Col span={8}>\n          <div className='config-label'>\n            { param['label'] || param['prop'] } \n          </div>\n        </Col>\n        <Col span={12}></Col>\n        <Col span={4}>\n            <Switch \n              checked={param['value']}\n              size=\"small\"\n              onChange={self && self.onParamChange.bind(self , param['id'] , param['prop']) }\n             />\n        </Col>\n      </Row>\n  )\n}\n\n\n\n/*\n  param : {\n      'label' ,\n      'value' : true , \n      'id',\n      'prop', \n      'mapId' : 0 ,\n      'value' : [ innerRadius, outerRadius ],\n      'unit' : 'm'\n  },\n  self : {\n    onParamChange ,\n  }\n*/\n\nexport function circleRadiusRow(param ,self ){\n    if(!param)  return (<div></div>)\n    return  <CircleRadiusSelect  \n              param={param} context={self} \n              key={ `${param['id']}-${param['prop']}-0` }\n            />\n}\n\nclass CircleRadiusSelect extends Component{\n      constructor(props){\n        super(props)\n        this.state = {\n           visible : true,\n           disabled : false\n        }\n      }\n\n      componentDidMount(){\n\n      }\n      handleCircleShowOnMap( visible ){\n        let { mapId } = this.props['param']\n        let ev = Event.get()\n        // console.log( ev , visible)\n        ev.emit(mapId + 'changeMapCircleSelectVisible' , visible)\n        this.setState({  mapCircleSelectVisible : !visible })\n        this.registerCallBackFuncToMap()\n      }\n      registerCallBackFuncToMap(){\n        let { mapId } = this.props['param']\n        let ev = Event.get()\n        \n        // 注册一次\n        const name = mapId + 'endCircleRadiusChange'\n\n        if( ev.eventNames().indexOf(name) == -1){\n          ev.on( name , this.setCircleRadius , this)\n        }\n      }\n      setCircleRadius = (value) => {\n        let { innerRadius , outerRadius } = value\n        console.log( innerRadius , outerRadius )\n\n        innerRadius = floatPrecision( innerRadius , 2)\n        outerRadius = floatPrecision( outerRadius , 2)\n        let { context,param } = this.props\n        let returnValue = [ innerRadius , outerRadius ]\n        param && context && context.onParamChange.call(context , param['id'] , param['prop'] , returnValue ) \n      }\n      handleVisibleChange = ( visible )=>{\n         this.setState({ visible:!visible })\n         this.handleCircleShowOnMap( visible )\n      }\n      render(){\n        let { visible,disabled } = this.state \n        let { param } = this.props\n        \n        return(\n          <div>\n            <Row className=\"config-row\" key={ `${param['id']}-${param['prop']}-1` }>\n              <Col span={8}>\n                <div className='config-label'>\n                  { param['label'] || param['prop'] } \n                </div>\n              </Col>\n              <Col span={12}></Col>\n              <Col span={4}>\n                <Radio.Group \n                  value=\"small\"\n                  style={{\n                    position : 'absolute',\n                    right : '10px'\n                  }}\n                >\n                  <Radio.Button \n                    disabled={ disabled }\n                    onChange={ this.handleVisibleChange.bind(this,visible) } >\n                      {   visible \n                          ? ( <Icon type=\"eye-invisible\"  /> ) \n                          : ( <Icon type=\"eye\"  /> )\n                      }\n                  </Radio.Button>\n               </Radio.Group>\n\n              </Col>\n            </Row>\n            <Row className=\"config-row\" key={`${param['id']}-${param['prop']}-2`}>\n              <Col span={2}/>\n              <Col span={10}>\n                <div className='config-label sub-row'>\n                    innerRadius: { param['value'][0] }  { param['unit'] }\n                </div>\n              </Col>\n              <Col span={2}/>\n              <Col span={10}>\n                <div className='config-label sub-row'>\n                    outerRadius: { param['value'][1] } { param['unit'] }\n                </div>\n              </Col>\n            </Row>  \n          </div>\n        )\n      }\n}\n\n\n\nconst floatPrecision = ( float , num ) => parseFloat( float.toFixed( num ) )","import { NumRow, ColorRow, circleRadiusRow } from  '@/components/config/ConfigRow'\n\nexport const MAP_STYLE = 'mapbox://styles/mapbox/light-v9'\nexport const MAPBOX_TOKEN = 'pk.eyJ1IjoieWtqYWdlIiwiYSI6ImNrNnp5dzZhbjFhMHczbm12OTR5bmU4ankifQ.cOEClSRYNtYFUAFhnUEXhA';\n\nexport const INITIAL_VIEW_STATE = {\n  \tlongitude: 120.66714,\n    latitude: 28.01308 ,   // 温州 \n\t  // longitude: 121.4282297911128 , latitude: 31.12090037100896 , // 上海\n  \tzoom: 12,\n  \tmaxZoom: 16,\n  \tpitch: 0,\n  \tbearing: 0\n};\n\n// export const CONSOLE_PRINT =  true   \nexport const CONSOLE_PRINT =  false \n\nexport const SELECT_STROKE_COLOR = '#000000'\nexport const SELECT_STROKE_OPACITY = 0.7\nexport const SELECT_FILL_COLOR = '#1f78b4'\nexport const SELECT_FILL_OPACITY = 0.1\n\nexport const defaultLayerConfigs = [\n  {\n    layerId : 'AnonymousTrajectoryLayer',\n    renderParam : {\n        widthScale : {\n            \"value\": -5 , \"min\": -20, \"max\": 5, \"step\": 1 ,\n            renderFunc : NumRow\n        },\n        arrowSize : {\n            \"value\": 0.5, \"min\": 0.1, \"max\": 1, \"step\": 0.01 ,\n            renderFunc : NumRow\n        },\n        translate : {\n            \"value\": 10 , \"min\": 0, \"max\": 1000, \"step\": 1,\n            renderFunc : NumRow\n        },\n        scale : {\n            \"value\": 0.8 , \"min\": 0.1, \"max\": 1, \"step\": 0.05,\n            renderFunc : NumRow\n        },\n        \"strokeColor\": {\n            \"value\": \"#5c5050\",\n            renderFunc : ColorRow\n        },\n        strokeOpacity : {\n            \"value\": 1, \"min\": 0.1, \"max\": 1, \"step\": 0.01 ,\n            renderFunc : NumRow\n        },\n    }\n  },\n  {\n    layerId : 'ChoroplethMap',\n    renderParam : {\n        strokeWidth : {\n            \"value\": 10, \"min\": 0, \"max\": 60, \"step\": 0.1 ,\n            renderFunc : NumRow\n        },\n        \"strokeColor\": {\n            \"value\": \"#5c5050\",\n            renderFunc : ColorRow\n        },\n        strokeOpacity : {\n            \"value\": 0.5, \"min\": 0 , \"max\": 1, \"step\": 0.01 ,\n            renderFunc : NumRow\n        },\n        fillOpacity : {\n            \"value\": 0.45, \"min\": 0, \"max\": 1, \"step\": 0.01 ,\n            renderFunc : NumRow\n        },\n    }\n  },\n  {\n    layerId : 'VoronoiRegion',\n    renderParam : {\n        strokeWidth : {\n            \"value\": 10, \"min\": 0.1, \"max\": 30, \"step\": 0.1 ,\n            renderFunc : NumRow\n        },\n        \"strokeColor\": {\n            \"value\": \"#5c5050\",\n            renderFunc : ColorRow\n        },\n        strokeOpacity : {\n            \"value\": 0.5, \"min\": 0.1, \"max\": 1, \"step\": 0.01 ,\n            renderFunc : NumRow\n        },\n        // fillColor : {\n        //     \"value\": \"#5c5050\",\n        //     renderFunc : ColorRow\n        // },\n        // fillOpacity : {\n        //     \"value\": 1, \"min\": 0.1, \"max\": 1, \"step\": 0.01 ,\n        //     renderFunc : NumRow\n        // },\n    }\n  },\n  {\n    layerId : 'PublicPoiPointsLayer',\n    renderParam : {\n        size : {\n            \"value\": 20, \"min\": 1, \"max\": 100, \"step\": 1 ,\n            renderFunc : NumRow\n        },\n        opacity : {\n            \"value\": 1, \"min\": 0, \"max\": 1, \"step\": 0.01 ,\n            renderFunc : NumRow\n        },\n    }\n  }\n]\nexport const defaultLayerConfigsBack = [\n{\n\tlayerId : 'PublicTrajectoryLayer',\n\trenderParam : {\n        \"strokeWidth\": {\n            \"value\": 10,\n            \"min\": 0.1,\n            \"max\": 30,\n            \"step\": 0.1,\n            renderFunc : NumRow\n        },\n        \"strokeColor\": {\n            \"value\": \"#5c5050\",\n            renderFunc : ColorRow\n        },\n        \"strokeOpacity\": {\n            \"value\": 1,\n            \"min\": 0.1,\n            \"max\": 1,\n            \"step\": 0.01,\n            renderFunc : NumRow\n        }\n\t},\n\tdataQueryParam : {}\n},\n{\n  layerId : 'AnonymousTrajectoryLayer',\n  renderParam : {\n        \"strokeWidth\": {\n            \"value\": 10,\n            \"min\": 0.1,\n            \"max\": 50,\n            \"step\": 0.1,\n            renderFunc : NumRow\n        },\n        \"vectorWidth\": {\n            \"value\": 10,\n            \"min\": 0.1,\n            \"max\": 50,\n            \"step\": 0.1,\n            renderFunc : NumRow\n        },\n        \"vectorColor\": {\n            \"value\": \"#5c5050\",\n            renderFunc : ColorRow\n        },\n        \"arrowColor\": {\n            \"value\": \"#5c5050\",\n            renderFunc : ColorRow\n        },\n        \"strokeColor\": {\n            \"value\": \"#5c5050\",\n            renderFunc : ColorRow\n        },\n        \"vectorOpacity\": {\n            \"value\": 1,\n            \"min\": 0.1,\n            \"max\": 1,\n            \"step\": 0.01,\n            renderFunc : NumRow\n        },\n        \"strokeOpacity\": {\n            \"value\": 1,\n            \"min\": 0.1,\n            \"max\": 1,\n            \"step\": 0.01,\n            renderFunc : NumRow\n        },\n  },\n  dataQueryParam : {\n        'maxRadius' : {\n          label : 'maxRadius',\n          value : 6,\n          min : 0,\n          max : 10,\n          unit : 'KM',\n          step: 0.01,\n          renderFunc: NumRow\n        },\n        'k' : {\n          label : 'kAnonymity',\n          value : 5,\n          min : 1,\n          max : 20,\n          unit : '',\n          renderFunc: NumRow\n        },\n        'p' : {\n          label : 'pValue',\n          value : 0.2,\n          min : 0.1,\n          max : 1,\n          step: 0.1,\n          unit : '',\n          renderFunc: NumRow\n        },\n        'circleRadius' : {\n          renderFunc : circleRadiusRow,\n          mapId : 0 ,\n          value : [ 1, 3 ],\n          unit : 'm'\n        }\n  },\n},\n{\n  layerId : 'AnonymousPointsLayer',\n  renderParam : {\n        \"strokeColor\": {\n            \"value\": \"#5c5050\",\n            renderFunc : ColorRow\n        },\n        \"strokeOpacity\": {\n            \"value\": 1,\n            \"min\": 0.01,\n            \"max\": 1,\n            \"step\": 0.01,\n            renderFunc : NumRow\n        }\n  },\n  dataQueryParam : {\n        'k' : {\n          label : 'kAnonymity',\n          value : 5,\n          min : 1,\n          max : 20,\n          unit : '',\n          renderFunc: NumRow\n        },\n        'circleRadius' : {\n          renderFunc : circleRadiusRow,\n          mapId : 0 ,\n          value : [ 1, 3 ],\n          unit : 'm'\n        }\n  },\n},\n{\n  layerId : 'PublicPoiPointsLayer',\n  renderParam : {\n        \"opacity\": {\n            \"value\": 1,\n            \"min\": 0.01,\n            \"max\": 1,\n            \"step\": 0.01,\n            renderFunc : NumRow\n        },\n        \"size\": {\n            \"value\": 5,\n            \"min\": 1,\n            \"max\": 20,\n            \"step\": 1,\n            renderFunc : NumRow\n        }\n  },\n  dataQueryParam : {\n  },\n},\n{\n  layerId : 'PublicWeiboPointsLayer',\n  renderParam : {\n        \"strokeColor\": {\n            \"value\": \"#5c5050\",\n            renderFunc : ColorRow\n        },\n        \"opacity\": {\n            \"value\": 1,\n            \"min\": 0.01,\n            \"max\": 1,\n            \"step\": 0.01,\n            renderFunc : NumRow\n        },\n        \"fillColor\": {\n            \"value\": \"#5c5050\",\n            renderFunc : ColorRow\n        },\n        \"radius\": {\n            \"value\": 5,\n            \"min\": 1,\n            \"max\": 20,\n            \"step\": 1,\n            renderFunc : NumRow\n        }\n  },\n  dataQueryParam : {\n  },\n},\n]\n","import { PathLayer } from '@deck.gl/layers';\nimport { hexToRGBArray } from '../util.js'\n\nconst id = 'PublicPolylineLayer'  // 表示从 params 中取数据的 id  , 唯一\n\nexport const  PublicPolylineLayer = ( subProps ) => {\n\tconst { \n\t\tdata = [],\n\t\tvisible = true,\n\t\tstrokeWidth,\n\t\tstrokeColor,\n\t\topacity\n\t} = subProps\n\n\t// data preprocess \n\tlet paths = []\n\tdata.map((line)=>{\n\t\tpaths.push( line.map((p)=> [ p['lng'],p['lat']] ))\n\t})\n\n\t// layer \n\treturn new PathLayer({\n\t    id,\n\t    data : paths ,\n\t    visible,\n\t    pickable: true,\n\t    getWidth:  strokeWidth ,\n\t    getPath: d => d,\n\t    getColor: hexToRGBArray(strokeColor , opacity),\n\t    onHover: ({object, x, y}) => {\n\t    }\n\t});\n}","import {  PolygonLayer, SolidPolygonLayer } from '@deck.gl/layers';\r\nimport { ScatterplotLayer } from '@deck.gl/layers';\r\nimport { CompositeLayer } from '@deck.gl/core'\r\n\r\nimport { PathStyleExtension } from '@deck.gl/extensions';\r\n\r\nimport { hexToRGBArray } from '../../util.js'\r\n\r\nimport circle from '@turf/circle';\r\n\r\n//import Event from '@/util/event'\r\n\r\nconst turf = require('@turf/turf')\r\n\r\nexport function createSimulationLayer( subProps ){\r\n\r\n\t//return new SimulationLayer( subProps )\r\n\tconsole.log('subProps', subProps)\r\n\r\n\treturn new SimulationLayer( {...subProps} )\r\n}\r\n\r\nexport class SimulationLayer extends CompositeLayer {\r\n\trenderLayers() {\r\n\t\tconst {region, simulation} = process(this.props['data'])\r\n\t    return [\r\n\t\t\tnew PolygonLayer({\r\n\t\t\t    //id: `${id}-polygon-layer-${this.props['layerId']}`,\r\n\t\t\t\tvisible :  true, \r\n\t\t\t    data : region,\r\n\t\t\t    pickable: true,\r\n\t\t\t    stroked: true,\r\n\t\t\t    filled: true,\r\n\t\t\t    dashJustified: true,\r\n\t\t\t    wireframe: true,\r\n\t\t\t    lineWidthMinPixels: 1,\r\n\t\t\t    extruded: false,\r\n\t\t\t    getPolygon: d =>  d,\r\n\t\t\t\t/*updateTriggers: {\r\n\t\t\t\t    getFillColor: this.props['highLightId']\r\n\t\t\t\t},*/\r\n\t\t\t    getFillColor : d => [229,191,165,180],\r\n\t\t\t    onHover: ({object, x, y}) => {\r\n\t\t\t    \tif(object){\r\n\t\t\t    \t\t// console.log( object['id'] , object['neighbors'] )\r\n\t\t\t    \t}\r\n\t\t\t    },\r\n\t\t\t\tlineWidthUnits: 'meters',\r\n\t\t\t\tgetDashArray: [3, 2],\r\n\t\t\t\textensions: [new PathStyleExtension({dash: true})]\r\n\t\t  \t}),\r\n\t\t  \tnew ScatterplotLayer({\r\n\t\t        data : simulation ,\r\n\t\t        visible: true,\r\n\t\t\t    getPosition: d => d,\r\n\t\t\t    getFillColor: [255,255,255,255],\r\n\t\t\t    getLineColor: [0,0,0,255],\r\n\t\t        getRadius: 100,\r\n\t\t\t    pickable: true,\r\n\t\t\t    stroked: true,\r\n\t\t\t    filled: true,\r\n\t\t\t    radiusMinPixels: 4,\r\n\t\t\t    radiusMaxPixels: 100,\r\n\t\t\t    lineWidthMinPixels: 1,\r\n\t\t\t    //onHover : info =>  setTooltip(info.object, info.x, info.y)\r\n\t\t\t})\r\n\t   ]\r\n  \t}\r\n\r\n}\r\n\r\nfunction process(subProps){\r\n  \tif(!subProps){\r\n  \t\tconsole.log('undefined subProps in SimulationLayer')\r\n \t\treturn {region: [], simulation: []}\r\n  \t}\r\n  \t//console.log('subprops in process', subProps)\r\n\r\n  \t/*let {\r\n\t\tdata = [],\r\n\t\tvisible = true,\r\n\t\tradius,\r\n\t\tfillColor,\r\n\t\tstrokeColor,\r\n\t\topacity\r\n\t} = subProps*/\r\n\tlet data = subProps\r\n\r\n\t//console.log(\"Data show ...\")\r\n\t//console.log(data)\r\n\tif(data.length == 0){\r\n\t\treturn {region: [], simulation: []}\r\n\t}\r\n\t\t\r\n\t// get the region\r\n    // use a rectangle region to mock\r\n\tlet pdata = data.map(e => { return e['coordinates']})\r\n\t//console.log('pdata[0][0] ',pdata[0][0],typeof(pdata[0][0]))\r\n\t//let bounds = pdata.slice(0,100)\r\n\t//let bbox = getBbox(bounds)\r\n\tlet bbox = [120.32995, 120.74305, 27.8644295, 28.224756]\r\n\tpdata = pdata.filter(e => isWithinBouding(e,bbox,2))\r\n\tlet bboxRegionData = getPolygonfromBbox(bbox)\r\n\r\n\tlet sampleLength = 100, iterations = 10, step = 5, factor = 1.2\r\n\tconsole.log('bbox: ', bbox)\r\n\tlet initPoints = randomPointList(sampleLength,...bbox,1)\r\n\t//console.log('init points: ', initPoints)\r\n\tlet resPoints = simulate(initPoints, pdata, iterations, step, factor)\r\n\r\n\tdata = {}\r\n\tdata['region'] = [bboxRegionData]\r\n\tdata['simulation'] = resPoints\r\n\r\n\treturn data\r\n}\r\n\r\nfunction simulate(initPoints, data, iterLim, step=1000, factor=10){\r\n\tlet lastPoints = [...initPoints], resPoints = [...initPoints]\r\n\tlet epsilon = data.length/initPoints.length/factor\r\n\tfor(let i=0; i<iterLim; i++){\r\n\t\t//console.log('last points: ', lastPoints)\r\n\t\tresPoints.forEach((e,i) => {\r\n\t\t\tlet xaxis = 0, yaxis = 0\r\n\r\n\t\t\t// calculate attraction\r\n\t\t\tdata.forEach((d,j) => {\r\n\t\t\t\tlet dist = spatialDistance1(lastPoints[i], d)\r\n\t\t\t\tlet angl = angle1(lastPoints[i], d)\r\n\t\t\t\txaxis += 1/dist/dist*Math.cos(angl)\r\n\t\t\t\tyaxis += 1/dist/dist*Math.sin(angl)\r\n\t\t\t})\r\n\r\n\t\t\t// calculate repulsion\r\n\t\t\tlastPoints.forEach((v,j) => {\r\n\t\t\t\tif(i == j) return\r\n\t\t\t\tlet dist = spatialDistance1(lastPoints[i], v)\r\n\t\t\t\tlet angl = angle1(lastPoints[i], v)\r\n\t\t\t\txaxis -= 1/dist/dist*Math.cos(angl)*epsilon\r\n\t\t\t\tyaxis -= 1/dist/dist*Math.sin(angl)*epsilon\r\n\t\t\t})\r\n\r\n\t\t\t// update\r\n\t\t\t//console.log(yaxis,xaxis)\r\n\t\t\tlet bearing = 90-Math.atan2(yaxis,xaxis)/Math.PI*180\r\n\t\t\t//console.log('last point i: ', lastPoints[i], typeof(lastPoints[i][0]), typeof(lastPoints[i][1]))\r\n\t\t\t//console.log(step, bearing)\r\n\t\t\tlet newPoint = turf.destination(turf.point(lastPoints[i]), step, bearing)\r\n\t\t\t\r\n\t\t\tresPoints[i] = newPoint['geometry']['coordinates']\r\n\t\t})\r\n\t\tlastPoints = [...resPoints]\r\n\t}\r\n\treturn resPoints\r\n}\r\n\r\n\r\n\r\n\r\nfunction spatialDistance(a,b){\r\n\tvar from = turf.point([a['lng'],a['lat']]);\r\n\tvar to = turf.point([b['lng'],b['lat']]);\r\n\tvar options = {\r\n\t\tunits: 'kilometers'   //单位 千米\r\n\t};\r\n\tvar distance = turf.distance(from, to, options);\r\n\treturn distance\r\n}\r\n\r\nfunction spatialDistance1(a,b){\r\n\tvar from = turf.point(a);\r\n\tvar to = turf.point(b);\r\n\tvar options = {\r\n\t\tunits: 'kilometers'   //单位 千米\r\n\t};\r\n\tvar distance = turf.distance(from, to, options);\r\n\treturn distance\r\n}\r\n\r\nfunction angle1(a,b){ //rad, --->0 counterclockwiae => +\r\n\tvar from = turf.point(a);\r\n\tvar to = turf.point(b);\r\n\t\r\n\tvar angle = (90-turf.bearing(from, to))/180*Math.PI;\r\n\treturn angle\r\n}\r\n\r\nfunction isPointWithinPolygon( p , polygon ){\r\n\tvar points = turf.points([\r\n\t\t[ p['lng'],p['lat'] ]\r\n\t]);\r\n\r\n\tvar searchWithin = turf.polygon([\r\n\t\tpolygon.map((p)=> [p['lng'],p['lat']])\r\n\t]);\r\n\r\n\tvar ptsWithin = turf.pointsWithinPolygon(points, searchWithin);\r\n\t\r\n\tif(ptsWithin['features'].length > 0)\r\n\t\treturn true\r\n\treturn false\r\n}\r\n\r\nfunction isWithinBouding( p ,bound,mode) {\r\n    let res\r\n    if(mode == 1) res = ( p['lng'] > bound['lngMin'] && p['lng'] < bound['lngMax'] && p['lat'] > bound['latMin'] && p['lat'] < bound['latMax'] )\r\n    else if(mode == 2) res = ( p[0] > bound[0] && p[0] < bound[1] && p[1] > bound[2] && p[1] < bound[3] )\r\n    return res\r\n}\r\n\r\nfunction getBbox(bounds){\r\n    let bbox = []\r\n    bounds.map((p)=>{\r\n      bbox[0] = ( !bbox[0] || p[0] < bbox[0] ) ? p[0] : bbox[0]  // min Longitude\r\n      bbox[1] = ( !bbox[2] || p[0] > bbox[2] ) ? p[0] : bbox[2]  // max Longitude\r\n      bbox[2] = ( !bbox[1] || p[1] < bbox[1] ) ? p[1] : bbox[1]  // min Latitude\r\n      bbox[3] = ( !bbox[3] || p[1] > bbox[3] ) ? p[1] : bbox[3]  // mix Latitude\r\n    })\r\n    return bbox\r\n}\r\n\r\nfunction getPolygonfromBbox(bbox){\r\n\treturn [[bbox[0],bbox[2]],[bbox[0],bbox[3]],[bbox[1],bbox[3]],[bbox[1],bbox[2]],[bbox[0],bbox[2]]]\r\n}\r\n\r\nfunction random(lower, upper){\r\n\treturn lower + Math.random()*(upper-lower)\r\n}\r\n\r\nfunction randomList(length, lower, upper){\r\n\treturn Array(length).fill(0).map(e => { return random(lower, upper)})\r\n}\r\n\r\nfunction randomPointList(length, lnglower, lngupper, latlower, latupper, mode){\r\n\tif(mode == 1){\r\n\t\treturn Array(length).fill(0).map(e => { return [random(lnglower,lngupper),random(latlower,latupper)]})\r\n\t}\r\n\telse if(mode == 2){\r\n\t\treturn Array(length).fill(0).map(e => { return {lng: random(lnglower,lngupper), lat: random(latlower,latupper)} })\r\n\t}\r\n}\r\n","import { ScatterplotLayer } from '@deck.gl/layers';\nimport { hexToRGBArray,setTooltip  } from '../util.js'\nimport { createSimulationLayer } from './data-utility/SimulationLayer'\n\nconst id = 'pointLayer'\n\nexport const WeiboSinglePoint = ( subProps , mapId)=> {\n    const {\n      \tdata = [],\n\t\tvisible = true,\n\t\tradius,\n\t\tfillColor,\n\t\tstrokeColor,\n\t\topacity\n    } = subProps \n\n    return  new ScatterplotLayer({\n        id,\n        data : data ,\n        visible,\n\t    getPosition: d => d.coordinates,\n\t    getFillColor: hexToRGBArray(fillColor , 1 ),\n\t    getLineColor: hexToRGBArray(strokeColor , 1),\n        getRadius: radius,\n\t    opacity: opacity,\n\t    pickable: true,\n\t    stroked: true,\n\t    filled: true,\n\t    radiusMinPixels: 1,\n\t    radiusMaxPixels: 100,\n\t    lineWidthMinPixels: 1,\n\t    onHover : info =>  setTooltip(info.object, info.x, info.y ,mapId ) \n\t})\n\n }","import {  PolygonLayer, TextLayer } from '@deck.gl/layers';\nimport { CompositeLayer } from '@deck.gl/core'\nimport { hexToRGBArray,setTooltip  } from '../util.js'\n\nconst id = 'ChoroplethMapLayer'\n\nexport function createChoroplethMap( subProps , mapId , layerId ) {\n\n\tlet {\n\t\tdata = {},\n\t\tvisible = true,\n\t\tstrokeOpacity = 1,\n\t\tstrokeWidth = 1,\n\t\tstrokeColor = \"#5c5050\",\n\t\tfillOpacity = 0.6,\n\t} = subProps\n\n\tif(!data) return\n\n\tconsole.log( data )\n\treturn new VoronoiLayer({\n\t\t...subProps,\n\t\tdata,\n\t\tvisible,\n\t\topacity : strokeOpacity ,\n\t\twidth : strokeWidth,\n\t\tfillOpacity: fillOpacity,\n\t\tstrokeColor,\n\t\tlayerId : 'choroplethmap' + mapId\n\t})\n}\n\nclass VoronoiLayer extends CompositeLayer {\n\trenderLayers() {\n\t    return [\n\t      \t// 多边形框\n\t\t\tnew PolygonLayer({\n\t\t\t    id: `${id}-polygon-layer-${this.props['layerId']}`,\n\t\t\t\tvisible :  this.props['visible'],\n\t\t\t    data : this.props['data'],\n\t\t\t    pickable: true,\n\t\t\t    stroked: true,\n\t\t\t    filled: true,\n\t\t\t    wireframe: true,\n\t\t\t    lineWidthMinPixels: 1,\n\t\t\t    extruded: false,\n\t\t\t    getPolygon: d =>  d['polygon'],\n\t\t\t\tupdateTriggers: {\n\t\t\t\t    getFillColor: this.props['fillOpacity']\n\t\t\t\t},\n\t\t\t    getFillColor : d =>  {\n\t\t\t    \treturn hexToRGBArray( d['fillColor'] ,  this.props['fillOpacity'] )\n\t\t\t    },\n\t\t\t    getLineColor: hexToRGBArray(this.props['strokeColor'], this.props.opacity ),\n\t\t\t    getLineWidth: this.props['width'],\n\t\t\t    onHover: ({object, x, y}) => {\n\t\t\t    \tif(object){\n\t\t\t    \t\t// console.log( object['id'] , object['neighbors'] )\n\t\t\t    \t}\n\t\t\t    },\n\t\t\t\tlineWidthUnits: 'meters'\n\t\t  \t}),\n\t   ]\n  }\n}\nVoronoiLayer.layerName = id ;\n\n","import {  PolygonLayer, TextLayer } from '@deck.gl/layers';\nimport { CompositeLayer } from '@deck.gl/core'\nimport { hexToRGBArray,setTooltip  } from '../util.js'\n// import { createGlyph } from './data-utility/GlyphLayer'\n// import { createBarChart } from './data-utility/BarChartLayer'\n\nconst id = 'VoronoiLayer'\n\nexport function createVoronoiRegionLayer( subProps , mapId , layerId ){\n\tlet {\n\t\tdata = {},\n\t\tvisible = true,\n\t\tstrokeOpacity = 1,\n\t\tstrokeWidth = 1,\n\t\tstrokeColor = \"#5c5050\",\n\t\tfillOpacity = 0.6,\n\t} = subProps\n\n\tif(!data) return\n\n\treturn [\n\t\tnew VoronoiLayer({\n\t\t\t...subProps,\n\t\t\tdata,\n\t\t\tvisible,\n\t\t\topacity : strokeOpacity ,\n\t\t\twidth : strokeWidth,\n\t\t\tfillOpacity: fillOpacity,\n\t\t\tstrokeColor,\n\t\t\tlayerId : 'voronois' + mapId,\n\t\t}),\n\t\t// new createGlyph(subProps , mapId , layerId),\n\t\t// new createBarChart(subProps , mapId , layerId)\n\t]\n}\n\nclass VoronoiLayer extends CompositeLayer {\n\trenderLayers() {\n\t    return [\n\t      \t// 多边形框\n\t\t\tnew PolygonLayer({\n\t\t\t    id: `${id}-polygon-layer-${this.props['layerId']}`,\n\t\t\t\tvisible :  this.props['visible'],\n\t\t\t    data : this.props['data'],\n\t\t\t    pickable: true,\n\t\t\t    stroked: true,\n\t\t\t    filled: true,\n\t\t\t    wireframe: true,\n\t\t\t    lineWidthMinPixels: 1,\n\t\t\t    extruded: false,\n\t\t\t    getPolygon: d =>  d['polygon'],\n\t\t\t\tupdateTriggers: {\n\t\t\t\t    getFillColor: this.props['highLightId']\n\t\t\t\t},\n\t\t\t    getFillColor : d =>  {\n\t\t\t    \tlet highLightId = this.props['highLightId'],\n\t\t\t    \t\tfillColor = d['fillColor'],\n\t\t\t    \t\tcolor ,\n\t\t\t    \t\topacity \n\n\t\t\t    \tif( highLightId ){\n\t\t\t    \t\tcolor = ( highLightId != d['id'] ) ?  [255,255, 255, 0 ] : hexToRGBArray('#111111' , 0)\n\t\t\t    \t}else{\n\t\t\t    \t\tconst defaultColor = '#ffffff'\n\t\t\t    \t    color =  d['fillColor'] ?  d['fillColor'] : defaultColor\n\t\t\t    \t    opacity =  d['fillColor'] ?  this.props['fillOpacity'] : 0\n\t\t\t    \t    // console.log( opacity )\n\t\t\t    \t    color =  hexToRGBArray( color  , opacity )\n\t\t\t    \t    // console.log( color )\n\t\t\t    \t}\n\t\t\t    \treturn color\n\t\t\t    },\n\t\t\t    getLineColor: hexToRGBArray(this.props['strokeColor'], this.props.opacity ),\n\t\t\t    getLineWidth: this.props['width'],\n\t\t\t    onHover: ({object, x, y}) => {\n\t\t\t    \tif(object){\n\t\t\t    \t\t// console.log( object['id'] , object['neighbors'] )\n\t\t\t    \t}\n\t\t\t    },\n\t\t\t\tlineWidthUnits: 'meters'\n\t\t  \t}),\n\t   ]\n  }\n}\nVoronoiLayer.layerName = id ;\n\n","\nimport { ScatterplotLayer } from '@deck.gl/layers';\n\n\nconst vertexShader = `\\\n#define SHADER_NAME scatterplot-layer-vertex-shader\n\nattribute vec3 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceRadius;\nattribute float instanceLineWidths;\nattribute float instanceAngles;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform float opacity;\nuniform float radiusScale;\nuniform float radiusMinPixels;\nuniform float radiusMaxPixels;\nuniform float lineWidthScale;\nuniform float lineWidthMinPixels;\nuniform float lineWidthMaxPixels;\nuniform float stroked;\nuniform bool filled;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\nvarying float outerRadiusPixels;\n\nvec3 rotateZ(vec3 vector, float angle) {\n  mat2 rotationMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));\n  return vec3(rotationMatrix * vector.xy, vector.z);\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  outerRadiusPixels = clamp(\n    project_size_to_pixel(radiusScale * instanceRadius),\n    radiusMinPixels, radiusMaxPixels\n  );\n  float lineWidthPixels = clamp(\n    project_size_to_pixel(lineWidthScale * instanceLineWidths),\n    lineWidthMinPixels, lineWidthMaxPixels\n  );\n  outerRadiusPixels += stroked * lineWidthPixels / 2.0;\n  unitPosition = positions.xy;\n  geometry.uv = unitPosition;\n  geometry.pickingColor = instancePickingColors;\n\n  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;\n  \n  // \n  vec3 center = project_position(instancePositions);\n  vec3 vertex = positions * outerRadiusPixels;\n  vertex = rotateZ(vertex, instanceAngles);\n\n\n  vec3 offset = positions * project_pixel_size(outerRadiusPixels);\n  DECKGL_FILTER_SIZE(offset, geometry);\n  //gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);\n  gl_Position = project_common_position_to_clipspace(vec4(center + vertex, 1.0));\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n`;\n\nconst fragmentShader = `\\\n#define SHADER_NAME scatterplot-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool filled;\nuniform float stroked;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\nvarying float outerRadiusPixels;\n\nvoid main(void) {\n  geometry.uv = unitPosition;\n\n  float distToCenter = length(unitPosition) * outerRadiusPixels;\n  float inCircle = smoothedge(distToCenter, outerRadiusPixels);\n\n  if (inCircle == 0.0) {\n    discard;\n  }\n  if (unitPosition.x < 1.0 - abs(unitPosition.y) * 4.0) {\n    gl_FragColor = vFillColor;\n  } else {\n    discard;\n  }\n\n  gl_FragColor.a *= inCircle;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n`;\n\nexport  class MyArrowPlotLayer extends ScatterplotLayer {\n\n  getShaders() {\n    // console.log(super.getShaders().vs)\n    // console.log(super.getShaders().fs)\n    return {\n      ...super.getShaders(),\n      // vs: vertexShader,\n      // fs: fragmentShader\n    };\n  }\n\n  initializeState() {\n    super.initializeState();\n    this.state.attributeManager.addInstanced({\n      instanceAngles: {size: 1, accessor: 'getAngle'}\n    });\n  }\n}\n\nconst originFS = `\\\n#define SHADER_NAME scatterplot-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool filled;\nuniform float stroked;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\nvarying float outerRadiusPixels;\n\nvoid main(void) {\n  geometry.uv = unitPosition;\n\n  float distToCenter = length(unitPosition) * outerRadiusPixels;\n  float inCircle = smoothedge(distToCenter, outerRadiusPixels);\n\n  if (inCircle == 0.0) {\n    discard;\n  }\n\n  if (stroked > 0.5) {\n    float isLine = smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter);\n    if (filled) {\n      gl_FragColor = mix(vFillColor, vLineColor, isLine);\n    } else {\n      if (isLine == 0.0) {\n        discard;\n      }\n      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);\n    }\n  } else if (filled) {\n    gl_FragColor = vFillColor;\n  } else {\n    discard;\n  }\n\n  gl_FragColor.a *= inCircle;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}`\n","import { ArcLayer , LineLayer } from '@deck.gl/layers';\nimport { CompositeLayer } from '@deck.gl/core'\nimport { hexToRGBArray,setTooltip  } from '../util.js'\nimport { MyArrowPlotLayer } from './ArrowLayer'\nimport * as turf from '@turf/turf'\n\nconst id = 'RegionMoveLayer' + 'Vector'\n\nexport const createRegionMoveLayer = ( subProps ) => {\n\n\t\tconst { \n\t\t\tvisible = true,\n\t\t\tdata = {},\n\t\t\tvectorWidth = 5,\n\t\t\tarrowColor = '#5c5050',\n\t\t\tvectorColor = '#5c5050',\n\t\t\tarrowOpacity = 1,\n\t\t\tvectorOpacity = 1\n\t\t} = subProps\n\n\t\tif(!data['vectors'])   return\n\t\t\n\t\treturn new RegionMoveLayer({\n\t\t\tid,\n\t\t\t...subProps,\n\t\t\tdata : data['vectors'].map( (d)=> {\n\t\t\t\tlet { fromPoint,toPoint } = d\n\t\t\t\tlet [ _fromPoint,_toPoint ] = scaleLine( fromPoint,toPoint )\n\t\t\t\treturn {\n\t\t\t\t\t...d,\n\t\t\t\t\tfromPoint : _fromPoint,\n\t\t\t\t\ttoPoint : _toPoint\n\t\t\t\t}\n\t\t\t}),\n\t\t\twidth: vectorWidth,\n\t\t\tarrowColor: arrowColor,\n\t\t\tvectorColor: vectorColor,\n\t\t\tarrowOpacity:arrowOpacity,\n\t\t\tvectorOpacity:vectorOpacity,\n\t\t\tvisible\n\t\t})\n}\n\n\nclass RegionMoveLayer extends CompositeLayer {\n\trenderLayers() {\n\t\treturn [\n\t      new LineLayer({\n\t\t\t\tid: `${id}-line`,\n\t\t\t\tdata : this.props['data'],\n\t\t\t\tvisible:this.props['visible'],\n\t\t\t\tgetSourcePosition: d => [ d.fromPoint['lng'] , d.fromPoint['lat'] ],\n\t\t\t\tgetTargetPosition: d => [ d.toPoint['lng'] , d.toPoint['lat'] ],\n\t\t\t\tgetColor: d => hexToRGBArray( this.props['vectorColor'], this.props['vectorOpacity'] ),\n\t\t\t\tupdateTriggers: {\n\t\t\t\tgetWidth: this.props['width']\n\t\t\t\t},\n\t\t\t\tgetWidth: d =>  this.props['width'] * d['support'],\n\t\t\t\twidthScale: 1,\n\t\t\t\twidthUnits: 'meters'\n\t      }),\n\t      new MyArrowPlotLayer({\n\t\t        id: `${id}-arrow-scatter`,\n\t\t        data: this.props['data'],\n\t\t\t\tvisible:this.props['visible'],\n\t\t        getPosition: d => [ d['toPoint']['lng'] , d['toPoint']['lat'] ],\n\t\t        getColor: d => hexToRGBArray( this.props['arrowColor'], this.props['vectorOpacity'] ),\n\t\t        updateTriggers: {\n\t\t          getRadius: this.props['width']\n\t\t        },\n\t\t        getAngle: d =>  _getAngle( d['fromPoint'] , d['toPoint'] ),\n\t\t        getRadius: d =>  this.props['width'] * d['support'],\n\t\t        radiusScale: 0.5,\n\t\t        widthUnits: 'meters'\n\t      }),\n\t\t]\n\t}\n}\n\nRegionMoveLayer.layerName = id\n\n\nfunction _getAngle( p1 , p2 ) {\n\t\n\treturn 0\n\n\tlet p1Arr = [p1['lng'] , p1['lat']]\n\tlet p2Arr = [p2['lng'] , p2['lat']]\n    let fromPoint =  turf.point( p1Arr )\n    let toPoint =  turf.point( p2Arr )\n    let angle = turf.bearing(  fromPoint , toPoint )\n    // angle -= 180\n    let radius = degrees_to_radians( angle )\n    // console.log( angle  , radius)\n  \tvar line = turf.lineString([ p1Arr , p2Arr ]);\n\tvar scaleLine = turf.transformScale(line, 3);\n\t// console.log( scaleLine , line )\n    return radius\n}\n\n\nfunction scaleLine(  p1 , p2 ){\n\tconst scaleRatio  = 0.8 \n\tlet p1Arr = [p1['lng'] , p1['lat']]\n\tlet p2Arr = [p2['lng'] , p2['lat']]\n  \tlet line = turf.lineString([ p1Arr , p2Arr ]);\n\tlet scaleLine = turf.transformScale(line, scaleRatio );\n\n\tlet [ np1 , np2 ] = scaleLine['geometry']['coordinates']\n\n\treturn [\n\t\t{ lng : np1[0] , lat: np1[1] },\n\t\t{ lng : np2[0] , lat: np2[1] }\n\t]\n}\n\nfunction degrees_to_radians(degrees)\n{\n  var pi = Math.PI;\n  return degrees * (pi/180);\n}","import { IconLayer,ScatterplotLayer  } from '@deck.gl/layers';\nimport { hexToRGBArray,setTooltip  } from '../util.js'\n\nimport * as POIIcon from './position.png'\n// import * as POIIcon from './icon-atlas.png'\n\nconst id = 'PublicGeoLocationLayer' \n\nexport const PublicGeoLocationLayer = (subProps , mapId)=>{\n\tlet { \n\t\tvisible = true,\n\t\tdata = [],\n\t\topacity = 1,\n\t\tsize = 10\n\t} = subProps\n    return  new ScatterplotLayer({\n        id,\n        data,\n        visible,\n\t\tgetPosition: d => [d['lng'] , d['lat']],\n\t\tgetFillColor: d => hexToRGBArray( d['color'] , opacity) ,\n\t    getLineColor: d => hexToRGBArray( d['color'] , opacity) ,\n        getRadius: size,\n\t    opacity: opacity,\n\t    pickable: true,\n\t    stroked: true,\n\t    filled: true,\n\t    radiusMinPixels: 1,\n\t    radiusMaxPixels: 100,\n\t    lineWidthMinPixels: 1,\n\t    onHover : info =>  setTooltip(info.object, info.x, info.y , mapId)\n\t})\n}","import {\n    EditableGeoJsonLayer,\n    DrawPolygonMode,\n    DrawRectangleMode,\n    DrawCircleFromCenterMode,\n    ModifyMode,\n    ViewMode,\n    ScaleMode\n} from 'nebula.gl';\n\nimport Event from '@/util/event'\nimport { hexToRGBArray } from '../util.js'\nimport {\n    SELECT_STROKE_COLOR,\n    SELECT_STROKE_OPACITY,\n    SELECT_FILL_COLOR,\n    SELECT_FILL_OPACITY\n} from '../config'\n\nconst id = 'framSelect'\n\n//// https://nebula.gl/docs/api-reference/layers/editable-geojson-layer\nexport const FrameSelect = (subProps, mapId) => {\n    // console.log(JSON.stringify(subProps))\n    \n    let selectedFeatureIndexes = []\n    let ev = Event.get()\n\n    let method = subProps['method']\n    let mode\n    switch (method) {\n        case \"polygon\":\n            mode = DrawPolygonMode\n            break\n\n        case \"rect\":\n            mode = DrawRectangleMode\n            break\n\n        case 'circle':\n            mode = DrawCircleFromCenterMode\n            break\n\n        default:\n            mode = ViewMode\n            selectedFeatureIndexes = [0]\n            break\n    }\n\n    return new EditableGeoJsonLayer({\n        id,\n        visible: subProps['visible'],\n        data: subProps['data'],\n        mode,\n        selectedFeatureIndexes,\n        getFillColor: hexToRGBArray(SELECT_FILL_COLOR, SELECT_FILL_OPACITY),\n        getLineColor: hexToRGBArray(SELECT_STROKE_COLOR, SELECT_STROKE_OPACITY),\n        getLineWidth: 1,\n        lineWidthMinPixels: 2,\n        lineWidthMaxPixels: 2,\n        getTentativeFillColor: [255, 255, 255, 0],\n        getLineDashArray: [1, 2],\n        onEdit: ({ updatedData, editType, featureIndexes }) => {\n            if (editType == \"addFeature\")\n                ev.emit(mapId + 'endMapFrameSelect', updatedData)\n        },\n    })\n}\n\nconst defaultProps1 = {\n    \"cursor\": true,\n    \"method\": \"rect\",\n    \"data\": {\n        \"type\": \"FeatureCollection\",\n        \"features\": []\n    },\n    \"visible\": true,\n}\nconst defaultProps2 = {  \n    \"cursor\": false,\n    \"draw\": false,\n    \"data\": { \n         \"type\": \"FeatureCollection\", \n         \"features\": [\n            { \n               \"type\": \"Feature\", \n               \"properties\": {}, \n               \"geometry\": { \n                  \"type\": \"Polygon\", \n                  \"coordinates\": [\n                    [\n                        [120.65702003062492, 28.022439362641567],\n                        [120.67078422623482, 28.022439362641567],\n                        [120.67078422623482, 28.007001009810725],\n                        [120.65702003062492, 28.007001009810725],\n                        [120.65702003062492, 28.022439362641567]\n                    ]\n                  ] \n               } \n            }\n         ] \n   },\n   \"visible\": true\n}","import {  PolygonLayer, IconLayer } from '@deck.gl/layers';\nimport { CompositeLayer } from '@deck.gl/core'\n\nimport { PathStyleExtension } from '@deck.gl/extensions';\n\nimport { hexToRGBArray } from '../util.js'\n\nimport circle from '@turf/circle';\nimport distance from '@turf/distance';\n\nimport * as ICON from './arrow-circle.png'\n\nimport Event from '@/util/event'\n\nimport { SELECT_STROKE_COLOR,\n         SELECT_STROKE_OPACITY,\n         SELECT_FILL_COLOR,\n         SELECT_FILL_OPACITY } from '../config'\n\nconst id = 'circleLayer'  // 表示从 params 中取数据的 id  , 唯一\n\nconst circleFillColor = '#1f78b4'\n\nexport let positionMoveCallBack\n\nexport const  CircleLayer = ( subProps , mapId ) => {\n  const { \n    visible = true\n  } = subProps\n\n  // console.log(subProps)\n  let  ev = Event.get()\n\n  const center = subProps['center']\n  const radius = subProps['radius']\n  const nest = subProps['nest']\n\n  const circleGeoJson = circle(center, radius, { steps:64 } )\n  const circleData = circleGeoJson['geometry']['coordinates'] \n  \n  let iconData = center\n  circleData[0].map((lnglat) => {\n      if( lnglat[0] > iconData[0] )  iconData = lnglat\n  })\n  let data = {\n    'icon' :   [{ id:'icon' ,  coordinates: iconData , nest  }] , \n    'circle' :  circleData\n  }\n\n  const handleDragStart = (info) => {\n      const object = info['object']\n      if(object && object['id'] == 'icon' ){ \n        ev.emit(mapId + 'startMoveCircleHandle')\n      }\n  }\n  const handleDrag =  (info) => {\n      const coor = info['coordinate']\n      const object = info['object']\n      if(object && object['id'] == 'icon'  ){ \n          var newRadius = distance(center , coor);\n          ev.emit(mapId + 'movingCircleHanle' ,  { radius: newRadius , nest : object['nest'] } )\n      }\n  }\n  const handleDragEnd = (info) => {\n    ev.emit(mapId + 'endMoveCircleHandle')\n  }\n\n  const handleHover = (info) =>{\n  }\n  return new CircleSelectLayer({\n     id : `${id}-${nest}` ,\n     data,\n     handleDragStart,\n     handleDrag,\n     handleDragEnd,\n     handleHover,\n     visible,\n     fillOpacity :  nest == 'inner' ?  SELECT_FILL_OPACITY+0.4 : SELECT_FILL_OPACITY\n  })\n}\n\n\n\nclass CircleSelectLayer extends CompositeLayer {\n  initializeState() {\n\n  }\n\n  renderLayers(){\n      return[\n      // 圆形 \n      new PolygonLayer({\n        id:  `${id}-circle-polygon-layer` + getRamdomStamp(),\n        data : this.props.data['circle'],\n        visible: this.props['visible'],\n        pickable: false,\n        stroked: true,\n        filled: true,\n        wireframe: true,\n        lineWidthMinPixels: 2,\n        lineWidthMaxPixels: 2,\n        getPolygon: d => d,\n        getFillColor: d => hexToRGBArray(SELECT_FILL_COLOR ,  this.props['fillOpacity'] ) , \n      getLineColor: hexToRGBArray(SELECT_STROKE_COLOR , SELECT_STROKE_OPACITY ),\n        getLineWidth: 2,\n      }),\n\n      // handler\n      new IconLayer({\n        id : `${id}-icon-layer` + getRamdomStamp(),\n        data: this.props.data['icon'],\n        visible: this.props['visible'],\n        getIcon: (d) => { return {\n          url: ICON,\n          width: 128,\n          height: 128,\n        }},\n        sizeScale: 2,\n        getPosition: d => {\n          let coor = d['coordinates']\n          // console.log( coor )\n          coor.push( 100 )\n          return coor\n        },\n        getSize: 20,\n        pickable: true,\n        autoHighlight : true,\n      })\n    ]\n  }\n  onHover( info ){\n    // console.log(info)\n    this.props.handleHover(info)\n  }\n  onDragStart( info ){\n    this.props.handleDragStart( info )\n  } \n  onDrag(info){\n    this.props.handleDrag(info)\n  }\n  onDragEnd(){\n    this.props.handleDragEnd()\n  }\n}\n\nCircleSelectLayer.layerName = 'CircleSelectLayer' \n\n\nfunction getRamdomStamp(argument) {\n    return Math.random().toFixed(5).slice(2)\n}","import React, { Component,useRef,useEffect } from 'react';\nimport * as d3 from 'd3';\nimport * as turf from '@turf/turf'\n\nconst widthScaleBase = 2\n\n// https://deck.gl/#/documentation/deckgl-api-reference/viewports/web-mercator-viewport?section=project\nexport default ( props ) => {\n\tlet { \n\t\tviewport,\n\t\tdata,\n\t\twidthScale = -5,\n\t\tstrokeColor =\"#5c5050\",\n\t\tstrokeOpacity = 1,\n\t\tvisible = true,\n\t\ttranslate = 0,\n\t\tscale = 0.8,\n\t\tarrowSize = 1\n\t} = props\n\n\t// const arrowSize  = 2\n\n\tif(!viewport || !data ) return null \n\tlet { width,height,project } = viewport\n  \tconst inputEl = useRef(null);\n  \tdata = data.filter((d)=> d['start'] != d['end'])\n\tlet points = data.map( d => {\n\t\tlet { fromPoint,toPoint } = d\n\t\tlet [ _fromPoint,_toPoint ] = scaleLine( fromPoint,toPoint , scale , translate )\t\t\n\t\tlet from = _fromPoint\n\t\tlet to = _toPoint\n\t\treturn {\n\t\t\tfrom : project( [ from['lng'],from['lat'] ] ),\n\t\t\tto : project( [ to['lng'],to['lat'] ] ),\n\t\t\tsupport : d['support']\n\t\t}\n\t})\n\n\tconst render = () => {\n\t\tlet { width,height,project } = viewport\n\t    const selected = d3.select(inputEl.current).select('g')\n\t      .selectAll(\".arrow-line\")\n\t      .data(points)\n\n\t\tselected.exit().remove()\n\t      .style(\"transform\" , d => `rotate3d(1, 0, 0, ${viewport.pitch}deg)`)\n\n\t    const enter = selected\n\t      .enter()\n\t      .append(\"line\")\n\t      .attr(\"class\", \"arrow-line\")\n\n\n\t    let path = d3.select(inputEl.current)\n\t    \t.select('defs')\n\t    \t.select('#arrow')\n\t    \t.select('path')\n\t    \t.style('fill' , strokeColor)\n\n\t    selected\n\t      \t.merge(enter)\n\t\t    .attr(\"x1\", d => d['from'][0] )\n\t\t    .attr(\"y1\", d => d['from'][1] )\n\t\t    .attr(\"x2\", d => d['to'][0] )\n\t\t    .attr(\"y2\", d => d['to'][1])\n\t      \t.style(\"transform-origin\" , d => `0px  ${d['to'][1]}px`)   \n\t        .style(\"transform\" , d => `rotate3d(1, 0, 0, ${viewport.pitch}deg)`)\n\t        .attr(\"stroke-width\", d => d['support'] * Math.pow(widthScaleBase , widthScale) )\n\t        .style('opacity' , visible ? strokeOpacity : 0 )\n\t      \t.attr(\"stroke\", strokeColor )\n\t        .attr(\"marker-end\", \"url(#arrow)\")\n\t}\n\n\n\t// 每次更新都渲染\n\tuseEffect(() => {\n\t\t render()\n\t})\n\n\treturn (\n\t\t<svg \n\t\t\tstyle={{ 'position':'absolute','pointerEvents':'none' }}\n\t\t\tviewBox={`0 0 ${width} ${height}`}\n\t\t\tref={inputEl} \n\t\t\t>\n\t\t\t<defs>\n\t\t\t\t<marker\n\t\t\t\t  id=\"arrow\"\n\t\t\t\t  markerWidth=\"24\"\n\t\t\t\t  markerHeight=\"24\"\n\t\t\t\t  viewBox={`0 0 ${24 * 1/arrowSize} ${24 * 1/arrowSize}`}\n\t\t\t\t  refX=\"8\"\n\t\t\t\t  refY=\"12\"\n\t\t\t\t  markerUnits=\"userSpaceOnUse\"\n\t\t\t\t  orient=\"auto\">\n\t\t\t\t  <path \n\t\t\t\t  \td=\"M4,4 L20,12 L4,20 L12,12 L4,4\" \n\t\t\t\t  \tstyle={{ 'fill':'#f00' }}></path>\n\t\t\t\t</marker>\t\t\t\t\n\t\t\t</defs>\n\t      \t<g />\n\t    </svg>\n\t)\n}\n\n\nfunction scaleLine(  p1 , p2 , scale , length){\n\tconst scaleRatio  = scale || 0.8\n\tlet p1Arr = [p1['lng'] , p1['lat']]\n\tlet p2Arr = [p2['lng'] , p2['lat']]\n  \tlet line = turf.lineString([ p1Arr , p2Arr ]);\n\tlet scaleLine = turf.transformScale(line, scaleRatio );\n    let angle = turf.bearing(  p1Arr , p2Arr ) + 90\n    // let radius = degree2radian( angle )\n\t// console.log( angle )\n\tvar translatedLine = turf.transformTranslate(scaleLine, length/1000, angle)\n\t// console.log( translatedLine , scaleLine )\n\t// let [ np1 , np2 ] = scaleLine['geometry']['coordinates']\n\tlet [ np1 , np2 ] = translatedLine['geometry']['coordinates']\n\n\n\treturn [\n\t\t{ lng : np1[0] , lat: np1[1] },\n\t\t{ lng : np2[0] , lat: np2[1] }\n\t]\n}\n\nfunction degree2radian(degree){\n  var pi = Math.PI;\n  return degree * (pi/180);\n}\n","import React, { Component, useEffect, useState, useRef} from 'react';\nimport {render} from 'react-dom';\nimport MapGL ,{ StaticMap , FullscreenControl} from 'react-map-gl';\nimport DeckGL from '@deck.gl/react';\nimport { MapController, WebMercatorViewport } from '@deck.gl/core';\n\nimport './index.css'\n\nimport { PublicPolylineLayer }  from './layers/PublicPolylineLayer.js'\nimport { WeiboSinglePoint } from './layers/WeiboSinglePoint'\nimport { createChoroplethMap, } from './layers/ChoroplethMapLayer'\nimport { createVoronoiRegionLayer } from './layers/VoronoiLayer'\nimport { createRegionMoveLayer } from './layers/RegionMoveLayer'\nimport { PublicGeoLocationLayer } from './layers/PublicGeoLocationLayer'\nimport { FrameSelect } from './layers/FrameSelectLayer'\nimport { CircleLayer } from './layers/CircleLayer'\nimport GlyphLayer  from './layers/GlyphLayer'\nimport { INITIAL_VIEW_STATE,\n          MAPBOX_TOKEN,\n          MAP_STYLE,\n          CONSOLE_PRINT  } from './config'\nimport { createSimulationLayer } from './layers/data-utility/SimulationLayer.js'; \n\n\nconst Layers = (props) => {\n    // console.log( props )\n    let { mapId } = props\n    let layers = _getLayers( props['params'] , mapId )\n\n\n  \n    CONSOLE_PRINT && (()=>{\n      console.log(`Layers of Map: ${props['mapId']} : ` )\n      console.table( layers.map((layer)=>{\n          if(!layer) return null\n          let { id , lifecycle,props } = layer\n          let layerName = layer['__proto__']['constructor']['layerName']\n          return {\n            id,lifecycle,\n            layerName,\n            longitude: -3.2943888952729092,\n            latitude: 53.63605986631115,\n          }\n      }))\n    })() \n\n\n    const [viewport, setViewport] = useState()\n  \n    const mapRef = useRef();\n    // 第一次渲染完成后 获取 长宽 更新 \n    useEffect(()=>{\n        let { clientWidth, clientHeight } = mapRef.current  \n        let state = {\n          ...INITIAL_VIEW_STATE,\n          width : props['width'] || clientWidth ,\n          height : props['height'] || clientHeight\n        }\n        setViewport( new WebMercatorViewport( state ))\n    }, [])\n  \n\n  \treturn (\n  \t\t<div id=\"map\" ref={mapRef}>\n  \t\t\t<DeckGL \n  \t\t\t\tcontroller={  props['controller'] }\n  \t\t\t\tlayers={ layers } \n  \t\t\t\tinitialViewState={ INITIAL_VIEW_STATE }\n          getCursor={() => \n            props['params']['framSelect'] && props['params']['framSelect']['cursor'] ? 'crosshair' : 'grab'\n          }\n          onViewStateChange={ v => {\n            let { viewState } = v\n            // 更新 viewport\n            setViewport( new WebMercatorViewport(viewState) )\n          }}\n  \t\t\t>\n  \t\t\t\t<MapGL\n  \t\t\t\t  reuseMaps\n  \t\t\t\t  mapStyle={MAP_STYLE}\n  \t\t\t\t  preventStyleDiffing={true}\n  \t\t\t\t  mapboxApiAccessToken={MAPBOX_TOKEN}\n  \t\t\t\t>\n  \t\t\t\t</MapGL>\n  \t\t\t</DeckGL>\n        <GlyphLayer \n          viewport={viewport}\n          { ...props['params']['AnonymousTrajectoryLayer'] } \n        />\n  \t\t\t\n        <div\n  \t\t\t\tid={`tooltip${mapId}`}\n  \t\t\t\tstyle={{\n  \t\t\t\t\tposition: 'absolute',\n  \t\t\t\t\t'zIndex': 1,\n  \t\t\t\t\t'pointerEvents': 'none'\n  \t\t\t\t}}\n  \t\t\t>\n  \t\t\t</div>\n  \t\t </div>\n  \t);\n}\n\n// all layers control\nconst _getLayers = function( params , mapId){\n    if(!params)  return \n\n    let layers = []\n\n    Object.keys( params ).map(( id )=>{\n      let param = params[id],\n        fn\n      switch(id){\n        case 'framSelect':\n          fn = FrameSelect\n          break\n        case \"ChoroplethMap\":\n          fn = createChoroplethMap \n          break\n        case \"VoronoiRegion\":\n          fn = createVoronoiRegionLayer\n          break\n        case 'PublicWeiboPointsLayer':\n          fn = WeiboSinglePoint\n          break\n        case 'AnonymousPointsLayer':\n          fn = createChoroplethMap\n          break\n        case 'PublicTrajectoryLayer':\n          fn = PublicPolylineLayer\n          break\n        case 'AnonymousTrajectoryLayer':\n          // fn = [ createChoroplethMap , createRegionMoveLayer ]\n          break\n        case 'PublicPoiPointsLayer':\n          fn = PublicGeoLocationLayer\n          break\n        case  'circle':\n          fn = CircleLayer\n          break\n        default: return\n      }\n\n      if( param ){\n        if(!fn) return\n        if(!Array.isArray( fn ) ){\n            if(CircleLayer == fn){\n              layers.push( CircleLayer({\n                  ...param,\n                  radius : param['outerRadius'],\n                  nest : 'outer',\n              }, mapId ))\n              layers.push( CircleLayer({\n                  ...param,\n                  radius : param['innerRadius'],\n                  nest : 'inner'\n              },mapId ))\n              return \n            }else{\n              layers.push( fn.call( null , param , mapId , id ) )\n            }\n        }else{\n          fn.map((_fn)=>{\n            layers.push( _fn.call( null , param , mapId ) )\n\n          })\n        }\n      }\n    })\n\n    return layers\n}\n\n\nexport default  Layers","import * as React from 'react';\nimport './index.scss'\nimport Event from '@/util/event'\nimport PropTypes from 'prop-types';\nimport { generateMapId } from './util'\nimport { INITIAL_VIEW_STATE,CONSOLE_PRINT  } from './config'\nimport Layers from './Layers'\n\nexport default class Map extends React.Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            id : generateMapId(),\n            params : {},\n            layersParams : {},\n            controller : true\n        }\n    }\n    componentWillMount(){\n        let { id: mapId,layersParams } = this.state\n        let { params,datas } = this.props\n\n        let ev = Event.get()\n        // 地图框选部分\n        ev.on(mapId + 'startMapFrameSelect', this.setFrameSelect , this)\n        ev.on(mapId + 'endMapFrameSelect', this.finishFrameSelect , this)\n        ev.on(mapId + 'changeMapFrameSelectVisible',this.showFrameSelect , this)\n        // ev.on(mapId + '地图更新结束',this.updateFrameSelect , this)\n\n        // 地图圆选部分\n        ev.on(mapId + 'changeMapCircleSelectVisible' , this.changeCircleSelectVisible , this)\n        ev.on(mapId + 'movingCircleHanle', this.updatePoint , this)\n        ev.on(mapId + 'endMoveCircleHandle',this.handleDragEnd , this)\n        ev.on(mapId + 'startMoveCircleHandle',this.handleDragStart , this)\n\n        layersParams = mixParamsAndData(datas, params , layersParams )\n        this.setState({ layersParams  })\n        if( !params ) this.setState({ params })\n        this.updatePoint( {} )\n    }\n    componentDidMount(){\n        // 配合 getId 用于把 mapId 回传给父组件\n        this.props.onRef && this.props.onRef( this )\n        // this.setFrameSelect()\n    }\n    getId = () => {\n        return this.state['id']\n    }\n    \n    componentWillUnmount() {}\n\n    componentWillReceiveProps(nextProps){\n        let { params, layersParams } = this.state\n\n        if( !nextProps['params'] || !nextProps['datas'] ) return \n        \n        layersParams = mixParamsAndData( nextProps['datas'] , nextProps['params'] , layersParams)\n\n        this.setState({ \n            params,\n            layersParams\n        })\n\n\n        this.print({\n            params : nextProps['params'],\n            datas : nextProps['datas']\n        })\n    }\n\n\n    render() {\n        const { layersParams,controller,id } = this.state\n        const { props } = this\n\n        return (\n            <div className='deck-map'\n            >\n                <Layers\n                    { ...props }\n                    params={ layersParams }\n                    controller={ controller }\n                    mapId = { id }\n                />\n            </div>\n        );\n    }\n\n    /*****************************\n            地图框选部分 \n    *****************************/\n        // 可以开始框选\n    setFrameSelect( method = 'rect' , data ){\n        let { layersParams } = this.state\n        let defaultParams = {\n            'cursor' : true,\n            method,\n            data : data || {\n              type: 'FeatureCollection',\n              features: []\n            },\n            visible : true\n        }\n        layersParams['framSelect'] = defaultParams\n        layersParams['framSelect']['cursor'] = true\n        layersParams['framSelect']['method'] = method\n        this.setState({ layersParams })\n    }\n        // 框选完成后触发\n    finishFrameSelect(data){\n        let { layersParams } = this.state\n        let newFeatures = data['features'],\n            originFeatures = layersParams['framSelect']['data']['features']\n\n        layersParams['framSelect'] = {\n            'cursor' : false,\n            'draw' : false ,\n            'data' : {\n                type: 'FeatureCollection',\n                features: originFeatures.concat( newFeatures )\n            },\n            visible : true\n        }\n        this.setState({ layersParams })\n    }\n        // will apply later\n    updateFrameSelect( data ){\n        let { layersParams } = this.state\n        layersParams['framSelect'] = {\n            'cursor' : false,\n            'draw' : false ,\n            'data' : data,\n             visible : true\n        }\n        this.setState({ layersParams })\n    }\n        // Change Visible\n    showFrameSelect(visible){\n        let { layersParams } = this.state\n        if(!layersParams['framSelect']) return \n        layersParams['framSelect']['visible'] = visible\n        this.setState({ layersParams })\n    }\n\n    /******************************\n                圆形选择部分部分 \n    *******************************/\n    updatePoint( { center , radius , nest }  ){\n        let { layersParams   } = this.state\n\n        const GAP = 0.1\n\n        let lng = INITIAL_VIEW_STATE['longitude'] , \n            lat = INITIAL_VIEW_STATE['latitude']\n            \n        center = center ?  center : [ lng , lat ]\n        radius = radius ?  radius : 2\n\n        if(!nest){  // default\n            layersParams['circle'] = {\n                center , \n                innerRadius : radius , \n                outerRadius : radius + 1 , \n                visible : false\n            }\n        }else{\n            let { innerRadius,outerRadius } = layersParams['circle']\n            if(nest == 'inner'){\n                if( radius <= outerRadius - GAP && radius > 0)\n                    layersParams['circle']['innerRadius'] = radius\n            }else if(nest == 'outer'){\n                if( radius >= innerRadius + GAP )\n                    layersParams['circle']['outerRadius'] = radius\n            }\n        }\n        this.setState({ \n            layersParams\n        })\n    }\n        // Chnage Visible\n    changeCircleSelectVisible( visible ){   \n        const { layersParams } = this.state\n        layersParams['circle']['visible'] = visible\n        this.setState({\n            layersParams\n        })\n    }  \n        // 拖动开始\n    handleDragStart(){\n        this.setState({ controller:false })\n    }\n        // 拖动结束\n    handleDragEnd(){\n        let { id: mapId , layersParams } = this.state\n\n        this.setState({ controller:true })\n\n        let ev = Event.get()\n        ev.emit(mapId + 'endCircleRadiusChange' , layersParams['circle'] )\n    }\n    print( obj ){\n        if( CONSOLE_PRINT ){\n            console.clear()\n            console.log(`Map: ${this.state['id']} Props :` )\n            console.table( obj )\n        }\n    }\n}\n\n\n\nMap.propTypes = {\n    // 各 layers 的展示属性\n    params : PropTypes.object,\n    // 各 layers 的 数据\n    datas  : PropTypes.object \n}\n\n/*\n    datas : {\n        'layerName1' : data,\n        'layerName2' : data,\n    }\n    params : {\n        'layerName' : {...},\n    }\n    layersParams : {\n        'layerName' : {\n            {...params['layerName']},\n            data : datas['layerName']\n        }\n    }\n*/\nconst mixParamsAndData = (datas , params , layersParams) =>{\n        if(!datas || !params ) return layersParams\n        Object.keys(params).map((key)=>{\n            if( !layersParams[key] ) \n                layersParams[key] = {}\n            layersParams[key] = params[key]\n        })\n        Object.keys(datas).map((key)=>{\n            if( !layersParams[key] ) \n                layersParams[key] = {}\n            layersParams[key]['data'] = datas[key]   // data key\n        })\n\n        return layersParams\n}\n","import React, { Component } from 'react';\nimport { Row,\n         Col,\n         Slider,\n         Card,\n         Tabs,\n         Select,\n         Drawer,\n         Button,\n         Collapse,\n         Icon  } from 'antd';\nimport { defaultLayerConfigs }  from './config'\n\nconst { Panel } = Collapse;\n\n\nexport default class MyPanel extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n        \tconfigs : defaultLayerConfigs\n        }\n    }\n\n    componentWillMount(){\n        let { configs } = this.state\n        configs.map((config)=>{\n            config['renderParam']['visible'] = {  value:true }\n        })\n    }\n    componentDidMount( propName ){\n        let { handleRenderParamChange } = this.props\n        let { configs } = this.state\n\n        handleRenderParamChange && handleRenderParamChange(  configRenderParamsGetter(configs) )\n\n    }\n    onParamChange( id  , propName , value){\n    \tlet { configs } = this.state\n    \tlet [ layerId , paramCategory ] = resolveId( id )\n    \tconfigs.map((config)=>{\n    \t\tif( config['layerId'] == layerId ){\n    \t\t\tconfig[ paramCategory ][ propName ]['value'] = value\n    \t\t}\n    \t})\n    \tthis.setState({ configs })\n\n    \tlet { handleRenderParamChange } = this.props\n    \tif( paramCategory == 'renderParam')\n    \t\thandleRenderParamChange && handleRenderParamChange(  configRenderParamsGetter(configs) )\n    }\n    geneRenderPanel(layerId ,  renderParam ){\n    \tlet self = this\n    \treturn iterateObj( renderParam , ( renderPropName , paramObject )=>{\n    \t\tlet id = composeId(layerId, 'renderParam') ,\n    \t\t\tprop = renderPropName,\n    \t\t\tparam = {\n    \t\t\t\tid,prop,\n    \t\t\t\t...paramObject\n    \t\t\t}\n\n            if( !paramObject['renderFunc'] ) return\n    \t\treturn paramObject['renderFunc'].call( null , param , self )\t\t\n    \t})\n    }\n    geneQueryPanel(layerId ,  queryParam ){\n    \tlet { mapId } = this.props\n    \t\n        if('circleRadius' in queryParam )\n            queryParam['circleRadius']['mapId'] = mapId\n\n    \tlet self = this\n    \treturn iterateObj( queryParam , ( renderPropName , paramObject )=>{\n    \t\tlet id = composeId( layerId, 'dataQueryParam' ) ,\n    \t\t\tprop = renderPropName,\n    \t\t\tparam = {\n    \t\t\t\tid,prop,\n    \t\t\t\t...paramObject\n    \t\t\t}\n    \t\treturn paramObject['renderFunc'].call( null , param , self )\t\t\n    \t})\n    }\n\n    async handleQueryData(layerId){\n    \tlet { configs } = this.state \n    \tlet { handleQuery } = this.props\n\n    \tlet params = {}\n\n        let i \n    \tfor(i = 0;i < configs.length;i++ ){\n    \t\tlet configObj = configs[i]\n    \t\tif( configObj['layerId'] == layerId ){\n    \t\t\tparams = configObj['dataQueryParam']\n                configObj['loading'] = true\n    \t\t\tbreak\n    \t\t}\n    \t}\n\t\tparams = paramsValueGetter(params)\n\n        this.setState({ configs })\n\t\tif( handleQuery ){\n            configs[i]['length'] =  await handleQuery( layerId , params )\n            configs[i]['loading'] = false\n            this.setState({ configs })\n        }\n    }\n    geneOneLayer( layerConfig ){\n    \tlet { layerId,renderParam,dataQueryParam,loading,length  } = layerConfig\n    \treturn (\n    \t\t<Panel \n    \t\t\tkey={ composeId( layerId, 'renderParam' ) }\n   \t\t\t\theader={ layerId }\n             \tshowArrow={false}\n                extra={ genExtraVisibleIcon( composeId( layerId, 'renderParam' )   , renderParam['visible']['value'] , this) }\n  \t\t\t>\n  \t\t\t  { this.geneRenderPanel(layerId , renderParam ) }\n    \t\t</Panel>\n    \t)\n    }\n\n    render(){\n    \tlet { configs } = this.state\n    \treturn (\n    \t\t<Collapse\n                expandIconPosition='right'\n                defaultActiveKey={[ configs[0]['layerId'] ]}>\n              { configs.map((config)=> this.geneOneLayer(config)) }\n            </Collapse>\n\t\t  )\n    }\n}\n\n\n\nconst formKey = \";\"\nconst composeId = ( id , paramCategory ) =>  `${id}${formKey}${paramCategory}`\nconst resolveId = ( composed ) =>  composed.split(formKey)\n\nfunction iterateObj( obj , fn ){\n\tlet keys = Object.keys( obj ),\n\t\tvalue\n\treturn keys.map((key)=>{\n\t\tvalue = obj[key]\n\t\treturn fn( key , value )\n\t})\n}\nconst paramsValueGetter = ( paramObj ) =>  {\n\tlet newPamraObj = {}\n\tObject.keys(paramObj).map((key)=>{\n\t\tnewPamraObj[key] = paramObj[key]['value']\n\t})\n\treturn newPamraObj \n}\nconst configRenderParamsGetter = (configs) => {\n\tlet res = {}\n\tconfigs.map((config)=>{\n\t\tres[ config['layerId'] ] =  paramsValueGetter( config['renderParam'] )\n\t})\n\treturn res\n}\n\nconst genExtraDataNum = (num ) => {\n  if(num == undefined) return ( <div></div> )\n  return (\n    <h4> Length : { num } </h4>\n  )\n}\n\nconst genExtraVisibleIcon = (id , visible , self) => (\n  <Icon\n    type={ visible ?  \"eye\" : \"eye-invisible\"}\n    onClick={event => {\n      visible = !visible\n      self.onParamChange( id , 'visible' , visible )\n      // 避免触发 折叠事件\n      event.stopPropagation();\n    }}\n  />\n);\n\n\n","import { Icon }  from 'antd'\n\n// 参考 https://3x.ant.design/components/icon/#Custom-Font-Icon  // generated by iconfont.cn\nexport const MyIcon = Icon.createFromIconfontCN({\n    scriptUrl : \n'//at.alicdn.com/t/font_1663760_0bsgedjrt1bo.js'\n});\n\n\n","import React, { Component } from 'react';\nimport { connect } from 'react-redux'\nimport MyMap from '@/components/map/index.js'\nimport Event from '@/util/event'\nimport { Drawer, Button } from 'antd'\nimport './index.scss'\nimport ConfigPanel from '@/components/map/Panel'\nimport { MyIcon } from '@/components/iconfont'\n\nclass MapPanel extends Component {\n\tconstructor( props ){\n\t\tsuper(props)\n\t\tthis.state = {\n\t\t\tconfigVisible : false,\n\t\t\tparams : {}\n\t\t}\n\t}\n\tcomponentWillMount(){\n\t\tconsole.log(' global map init ')\n\t}\n\tcomponentDidMount(){\n\t\tlet mapId = this.mapRef.getId()\n\t\tthis.setState({ mapId })\n\t\t\n\t\tconst ev = Event.get()\n        ev.on(\"globalSetFrameRegion\", this.handleGlobalSetFrameRegion , this)\n\t}\n\thandleGlobalSetFrameRegion = ( fromId ) =>{\n\t\tconst mapId = this.mapRef.getId()\n\t\tconst ev = Event.get()\n\t\tev.emit( mapId + 'changeMapFrameSelectVisible' , true )\n      \tev.emit( mapId + 'startMapFrameSelect')\n      \tthis.handleGlobalFrameRegionCallBack( fromId )\n\t}\n\thandleGlobalFrameRegionCallBack = ( fromId )=>{\n\t\tlet { mapId } = this.state\n\t\tconst  ev = Event.get()\n\t\tconst  eventName = mapId + 'endMapFrameSelect'\n\t\tev.once( eventName , ( data )=>{\n\t\t\tev.emit( fromId + 'finishGlobalFrameRegion' , data)\n\t\t\tev.emit( mapId + 'changeMapFrameSelectVisible' , false )\n\t\t}, this)\n\t}\n\thandleRenderParamChange = ( newConfigs ) => {\n\t\t// console.log( newConfigs )\n\t\tthis.setState({ params:newConfigs })\n\t}\n\trender(){\n\t\tlet { map } = this.props\n\t\tlet { data } = map \n\t\tconst self = this\n\t\tlet { configVisible , params } = this.state\n\t\treturn (\n\t\t\t<div className='app'>\n\t\t\t\t<MyMap\n\t\t\t\t\t{...data}\n\t\t\t\t\tparams={ params }\n\t\t\t\t\tref={ref => self.mapRef = ref}/>\n\n\t            <Drawer\n\t              placement=\"left\"\n\t              onClose={() => this.setState({ configVisible:false }) }\n\t              mask={false}\n\t              visible={ configVisible }\n\t              getContainer={false}\n\t              style={{ position: 'absolute' , \n\t                       opacity : 0.9,\n\t                       left: '-10px',\n\t                       width: '400px',\n\t                       'pointerEvents':  configVisible ? 'all' : 'none'\n\t                    }}\n\t              width={450}\n\t            >\n\t              <ConfigPanel \n\t                mapId={this.state.mapId}\n\t                handleQuery={ this.handleQuery }\n\t                handleRenderParamChange={ this.handleRenderParamChange }\n\t              />\n\t            </Drawer>\n\n\t\t\t\t{!configVisible ? (<div className='config-btn'>\n\t\t\t\t\t<Button \n\t\t\t\t\t\tonClick={() => this.setState({ configVisible:true })}\n\t\t\t\t\t\ttype=\"primary\"\n\t\t\t\t\t\tshape=\"circle\"\n\t\t\t\t\t\tsize='large'>\n\t\t\t\t\t\t<MyIcon type='icon-configuration'/>\n\t\t\t\t\t</Button>\n\t\t\t\t</div>) : null }\n\n\t\t\t</div>\n\t\t)\n\t}\n}\n\n\n\nconst mapStateToProps = ({ map }) => {\n\treturn {\n\t\tmap \n\t}\n}\nconst mapDispatchToProps = dispatch => {\n\treturn {\n\t\t\n\t}\n}\n\nlet HOC = connect(mapStateToProps, mapDispatchToProps)(MapPanel)\nexport default HOC \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","\nexport const TYPE_RES_NODE = 'TYPE_RES_NODE'\nexport const TYPE_RES_PUBLIC_NODE = 'TYPE_RES_PUBLIC_NODE'\nexport const TYPE_COND_NODE = 'TYPE_COND_NODE'\n\n\nexport const RES_NODE = {\n\twidth : 500,\n\theight : 300\n}\n\nexport const COND_NODE = {\n\twidth : 300,\n\theight : 400\n}\n\n\nexport const COLOR_RED = '#80B1D3'\nexport const COLOR_BLUE = '#FB8072'\n\n\nexport const BBOX = [\n\t120.52615492589692, \n\t120.88484148600844, \n\t27.839332569287993,\n\t28.068424566577406, \n]","import React, { Component } from 'react';\nimport { DragSource } from 'react-dnd'\nimport './Node.scss'\nimport { Button } from 'antd';\nimport { MyIcon } from '@/components/iconfont'\nimport { TYPE_RES_NODE, TYPE_COND_NODE, TYPE_RES_PUBLIC_NODE } from '@/QueryPanel/config'\n\nconst THEME_COLOR = '#AFABAB'\nconst iconMap = {\n\t'people' : 'icon-xingren',\n\t'weibo'  : 'icon-weibo',\n\t'taxi'   : 'icon-chuzuche',\n\t'poi'\t : 'icon-points-mall'\n}\n\nclass Node extends Component {\n\tconstructor( props ){\n\t\tsuper(props)\n\t\tthis.state = {}\n\t}\n\tstatic defaultProps = {\n\t\tx : 20,\n\t\ty : 20\n\t}\n\thandleNodeDelete = () =>{\n\t\tlet { id, onNodeDelete } = this.props\n\t\tonNodeDelete && onNodeDelete(id)\n\t}\n\trender(){\n\t\tconst { props }  = this\n\t\tconst { connectDragSource } = this.props\n\t\tlet { type,x,y,width,height,source,num } = props\n\t\treturn connectDragSource(\n\t\t\t<div className='node'\n\t\t\t\tstyle={{\n\t\t\t\t\twidth,\n\t\t\t\t\theight,\n\t\t\t\t\tleft : x,\n\t\t\t\t\ttop :  y,\n\t\t\t\t\tborder: `2px solid ${source ? source['color'] : THEME_COLOR }`\n\t\t\t\t}}\n\t\t\t>\t\n\t\t\t\t{  type == TYPE_COND_NODE ? \n\t\t\t\t\t(\n\t\t\t\t\t\t<div className='node-header'>\n\t\t\t\t\t\t\t<div style={{ width:'50px'}}></div>\n\t\t\t\t\t\t\t<input className='node-header__title' defaultValue={'Condition Node'}/>\n\n\t\t\t\t\t\t\t<div className='node-header__btn-area'>\n\t\t\t\t\t\t\t\t<Button className='zoom-btn'>\n\t\t\t\t\t\t\t\t\t<MyIcon  type='icon-zuixiaohua'/>\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\tclassName='close-btn'\n\t\t\t\t\t\t\t\t\tonClick={ this.handleNodeDelete }>\n\t\t\t\t\t\t\t\t\t<MyIcon  type='icon-guanbi'/>\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)\n\t\t\t\t\t:(\n\t\t\t\t\t\t<div className='node-header'\n\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t'backgroundColor': source['color']\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<MyIcon className='node-header__type-icon'\n\t\t\t\t\t\t\t\ttype={source['icon']} />\n\t\t\t\t\t\t\t<div className='node-header__title'>\n\t\t\t\t\t\t\t\t{ source['name'] } x { _formatNumber(num , type) }\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\tclassName='close-btn'\n\t\t\t\t\t\t\t\tonClick={ this.handleNodeDelete }>\n\t\t\t\t\t\t\t\t<MyIcon  type='icon-guanbi'/>\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t\t{props.children}\n\t\t\t</div>\t\n\t\t)\n\t}\n}\n\n\nconst _formatNumber = ( num , type) => {\n\tif( type == TYPE_RES_PUBLIC_NODE ) return num\n\tif( num <= 10){\n\t\treturn '(below 10)'\n\t}else{\n\t\tnum = Math.floor(num / 10)\n\t\treturn num + '0+'\n\t}\n}\n\nconst sourceSpec =  {\n    beginDrag(props) {   // Required  \n      const { id, x, y } = props   // component's current props\n      return { id, x, y }    // 返回的 obj 会传给 dropTarget \n    },\n}\n\n// pass dragging state to  component \nfunction dragCollect( connect , monitor ){\n  return {\n    connectDragSource: connect.dragSource(),   // 到 props, 然后在 render 里面包裹 dom ; \n    // connect this source DOM to Dnd backend   ; connectDragSource 的 实例\n    isDragging: monitor.isDragging(),\n    //  DragSourceMonitor 的 实例 ； 获取当前 state \n  }\n} \n\nNode = DragSource( 'NODE' , sourceSpec , dragCollect)(Node)\nexport default Node","import React, { Component } from 'react';\nimport './NumberRow.scss'\n\nclass NumberRow extends Component {\n\tconstructor(props){\n\t\tsuper(props)\n\t\tthis.state = {}\n\t}\n\tstatic defaultProps = {\n\t\ttitle : 'xxx',\n\t\tvalue : 123,\n\t\tunit : 'km',\n\t\tonChange:()=>{}\n\t}\n\tonChange = ( event )=>{\n\t\tlet value = event.target.value\n\t\tlet { onChange,id } = this.props\n\t\tonChange && onChange.call( null , id , value )\n\t}\n\trender(){\n\t\tconst { title,value,unit } = this.props\n\t\treturn (\n\t\t\t<div className='config__row'>\n\t\t\t\t<div className='config__row__title'>\n\t\t\t\t\t{ title }\n\t\t\t\t</div>\n\t\t\t\t<input \n\t\t\t\t\tclassName='config__row__number'\n\t\t\t\t\tonChange={this.onChange}\n\t\t\t\t\tdefaultValue={ value } />\n\t\t\t\t<div className='config__row__unit'>\n\t\t\t\t\t{ unit }\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t)\n\t}\n}\n\nexport default NumberRow","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport * as d3 from 'd3';\n\nimport './Timeline.scss'\n\n\nconst GAP_VALUE = 15,\n\t  ELEMENT_TOP = 20\n\n\nclass Timeline extends Component{\n\tconstructor(props){\n\t\tsuper(props)\n\t\tthis.state = {\n\t\t\twidth : 360,\n\t\t\theight : 60,\n\t\t}\n\n\t}\n\tcomponentWillMount(){\n\t}\n\n\tcomponentWillReceiveProps( nextProps ){\n\t\t// console.log( nextProps )\n\t\tif( !isSameTime( this.props , nextProps ) ){\n\t\t\tthis.renderTimeline( nextProps ) \n\t\t}\n\t}\n\tcomponentDidMount(){\n\t\tlet self = this\n\t\tlet { clientWidth, clientHeight  } = this.containRef\n\t\t\n\t\t// console.log( clientWidth, clientHeight  )\n\t\tclientHeight = 60 \n\n\t\t\n\t\tthis.setState({\n\t\t\twidth : clientWidth,\n\t\t\theight : clientHeight\n\t\t},()=>{\n\t\t\tself.renderTimeline()\n\t\t})\n\t}\n\trenderTimeline( nextProps ){\n\t\tthis.clearTimeline()\n\t\tthis.setTimeScale( nextProps )\n\t\tthis.setAxis()\n\t\tthis.setZoom()\n\t\tthis.setBrush()\t\n\t}\n\n\tsetTimeScale( nextProps ){\n\t\tlet { width,height } = this.state\n\t\tlet { startTime,endTime } = nextProps || this.props\n\t\t\n\t\tconst DATE = \"2000-01-01 \"\n\t\tif( !startTime || !endTime ){\n\t\t\tstartTime =  \"2000-01-01 00:00:00\"\n\t\t\tendTime =  \"2000-01-01 12:00:00\"\n\t\t}else{\n\t\t\tstartTime = DATE + startTime\n\t\t\tendTime = DATE + endTime\n\t\t}\n\n\t\tlet timeStart = new Date( startTime ),\n\t\t\ttimeEnd = new Date( endTime )\n\t\t// https://github.com/d3/d3-scale#scaleTime\n\t\tlet timeRange = [\n\t\t\ttimeStart,\n\t\t\ttimeEnd\n\t\t]\n\t\tlet timeScale = d3.scaleTime()\n\t\t\t.range([0, width - 2*GAP_VALUE])\n\t\tlet timeScale2 = d3.scaleTime()\n\t\t\t.range([0, width - 2*GAP_VALUE])\n\n\t\ttimeScale.domain(timeRange)\n\t\ttimeScale2.domain(timeRange)\n\n\t\tthis.timeScale = timeScale\n\t\tthis.timeScale2 = timeScale2\n\n\t\tthis.timeStart = timeStart\n\t\tthis.timeEnd = timeEnd\n\t}\n\tsetAxis(){\n\t\tlet { timeScale } = this\n\t\tlet { width,height } = this.state\n\n\t\tlet axisFunc =  d3.axisBottom(timeScale)\n\n\t\t\taxisFunc.ticks(  4 )  //显示的个数\n\t\t\t\t.tickFormat(  d3.timeFormat(\"%H:%M\")  ) // https://github.com/d3/d3-time-format  \n\t\t\n\t\tlet topAxis =  d3.select( this.refs.axisSvg )\n\t\t\t\t\t\t\t.append('g')\n\t\t\t\t\t\t    .call(axisFunc);\n\t\t\n\t\ttopAxis.attr(\"transform\" , `translate(${GAP_VALUE}, -2 )`)\n\n\t\tthis.syncAsix = function(){\n\t\t\ttopAxis.call(axisFunc)\n\t\t}\n\t}\n\tsetZoom( item ){\n\t\tlet svg = d3.select(this.refs.zoomSvg)\n\t\tlet zoomFunc = d3.zoom()\n\t\t\t.scaleExtent([0.5, 100])\n\t\t\t.on('zoom',()=>{\n\t\t\t\t// console.log('zoom')\n\t\t\t\tthis.zoomedFunc()\n\t\t\t})\n\t\tsvg.call( zoomFunc )\n\t}\n\tzoomedFunc(){\n\t\tlet { timeScale,timeScale2,s } = this\n\t\tlet t = d3.event.transform\n\t\tif(!s) return\n\t\tlet s_t = [ timeScale.invert(s[0]),timeScale.invert(s[1]) ]\n\t\t//更新 timeScale\n\t\ttimeScale.domain(t.rescaleX(timeScale2).domain())   //  timeScal2 不变\n\n\t\tlet s_ = [ timeScale(s_t[0]) , timeScale(s_t[1]) ]\t\n\t\t\n\t\tthis.syncAsix() \t\n\t\tthis.syncBrush( s_ )\n\t}\n\n\tsetBrush(){\n\t\tlet self = this\n\n\t\tlet { width,height } = this.state\n\n\t\tlet brushFunc = d3.brushX()\n\t\t    .extent([[0, 0], [ width-2*GAP_VALUE, 10 ]])\n\t\t    // .extent([[0, 0], [w * 0.9, Config.vRectHeight]])\n\t\t    .on(\"start\", ()=>{\n\t\t    \tthis.setBrushStyle()\n\t\t    })\n\t\t    .on(\"brush\",()=>{\n\t\t    \tthis.s = d3.event.selection\n\t\t    \tthis.setBrushStyle()\n\t\t    })\n\t\t    .on(\"end\", self.hanldeTimeChange.bind(self) );\n\n\t\tthis.setBrushStyle()\n\n\t\tlet brushG = d3.select(this.refs.brushSvg)\n\t\t\t\t.append('g')\n\t\t      \t.call(brushFunc)\n      \t\t\t.call(brushFunc.move, [0 , width-2*GAP_VALUE ]);  //拖动框\n\t\t\n\t\tbrushG.attr(\"transform\" , `translate(${GAP_VALUE},${ELEMENT_TOP})`)\n\n\n\t\tthis.syncBrush = ( move )=>{\n\t\t\td3.select( self.refs.brushSvg ).select('g')\n\t\t\t\t.call( brushFunc.move , move )\n\t\t}\n\t}\n\thanldeTimeChange(){\n\t\tlet { height,width,brushRadius  } = this.state\n\t\tlet { timeStart, timeEnd , timeScale } = this\n\t\tlet { onChange } = this.props\n\n\t\tlet brushG = d3.select( this.refs.brushSvg ),\n\t\t\trectStart = +brushG.select('.handle--w').attr('x') + 3,\n\t\t\trectEnd = +brushG.select('.handle--e').attr('x') + 3,\t\n\t\t\tnewTimeStart = timeScale.invert(rectStart),\n\t\t\tnewTimeEnd = timeScale.invert(rectEnd)\n\n\n\t\tif( timeStart.toString() == newTimeStart.toString() \n\t\t\t&& timeEnd.toString() == newTimeEnd.toString()){\n\t\t\t// console.log('time unchange ')\n\t\t}else{\n\t\t\tthis.timeStart = newTimeStart\n\t\t\tthis.timeEnd  = newTimeEnd\n\n\t\t\tonChange && onChange( newTimeStart , newTimeEnd)\n\t\t\t// onChange && debounce( 1000 , ()=>{\n\t\t\t\t// onChange( newTimeStart , newTimeEnd )\n\t\t\t// })\n\t\t}\t\n\t}\n\tclearTimeline(){\n\t\td3.select(this.refs.axisSvg).selectAll('*').remove()\n\t\td3.select(this.refs.brushSvg).selectAll('*').remove()\n\t\td3.select(this.refs.zoomSvg).selectAll('*').remove()\n\t}\n\trender(){\n\t\tconst self = this\n\t\tlet { width,height } = this.state\n\n\t\treturn (\n\t\t\t<div className='timeline-contain'\n\t\t\t\tref={ref => self.containRef = ref}\n\t\t\t>\n\t\t\t\t{width >= 10 && height >= 10 \n\t\t\t\t\t? (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t<svg  ref=\"axisSvg\" \n\t\t\t\t\t\t\twidth={width}\n\t\t\t\t\t\t\theight={height}\n\t\t\t\t\t\t/>\t\t\t\t\n\t\t\t\t\t\t<svg  ref=\"zoomSvg\" \n\t\t\t\t\t\t\tclassName=\"zoom-contain\"\n\t\t\t\t\t\t\twidth={width}\n\t\t\t\t\t\t\theight={height}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<svg  ref=\"brushSvg\"\n\t\t\t\t\t\t\tclassName='brush-contain'\n\t\t\t\t\t\t\twidth={width}\n\t\t\t\t\t\t\theight={height}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t</>\n\t\t\t\t\t)\n\t\t\t\t\t: null\n\t\t\t\t}\n\n\t\t\t</div>\n\t\t)\n\t}\n\n\tsetBrushStyle(){\n\t\tlet { height } = this.state\n\n\t\tlet radius = height - ELEMENT_TOP*2\n\t\tradius = ( radius > 10 ) ? radius : 10\n\n\t\tlet brushG = d3.select( this.refs.brushSvg )\n    \tbrushG.select('.selection')\n    \t\t\t.attr('height', radius)\n\n\n    \tbrushG.select('.overlay')\n    \t\t.attr('height', radius)\n\n    \tbrushG.select('.handle--e')\n    \t\t.attr('width', radius)\n    \t\t.attr('height', radius)\n    \t   \t.attr('transform',`translate(-${radius/2},0)`)\n    \t\t.attr('rx',radius)\n    \t\t.attr('ry',radius)\n    \t\t.attr('y',0)\n\n    \tbrushG.select('.handle--w')\n    \t   \t.attr('width',radius)\n    \t\t.attr('height',radius)\n    \t   \t.attr('transform',`translate(-${radius/2},0)`)\n    \t\t.attr('rx',radius)\n    \t\t.attr('ry',radius)\n    \t\t.attr('y',0)\n\t}\n\n}\n\nMap.propTypes = {\n    startTime : PropTypes.string,   //  \"2007-02-20 00:00:22\"\n    endTime: PropTypes.string,\n    width: PropTypes.number,\n    height: PropTypes.number,\n    onChange  : PropTypes.func  \n}\n\nlet debounceTimer\nfunction debounce( delay , fn ){\n\tlet delaySecond = delay || 2000\n\tlet context = this\n\tclearTimeout( debounceTimer )\n\tdebounceTimer = setTimeout( function(){\n\t\tfn()\n\t} , delaySecond )\n}\n\nfunction isSameTime( prevProps , nextProps ) {\n\tlet timeStart = prevProps['startTime'],\n\t\ttimeEnd = prevProps['endTime'],\n\t\tnewTimeStart = nextProps['startTime'],\n\t\tnewTimeEnd = nextProps['endTime']\n\n\t// console.log( timeStart ,timeEnd ,newTimeStart , newTimeEnd )\n\tif( !timeStart && !timeEnd && !newTimeStart && !newTimeEnd)\n\t\treturn true\n\t\n\tif( !timeStart && !timeEnd && newTimeStart && newTimeEnd)\n\t\treturn false\n\n\treturn timeStart.toString() == newTimeStart.toString()  \n\t\t&& timeEnd.toString() == newTimeEnd.toString()\n}\n\n\nexport default Timeline","import React, { Component } from 'react';\nimport './Step.scss'\nimport { MyIcon } from '@/components/iconfont'\n\n\nexport class Steps extends Component {\n\tstatic defaultProps = {\n\t\tcurrent : 1,\n\t\tsteps : [\n\t\t\t{ title : 'Spatial Partition', },\n\t\t\t{ title : 'Information Graph', },\n\t\t\t{ title : 'Exploration', }\n\t\t],\n\t}\n\thandleChange = (i) =>{\n\t\tlet { changeStep } = this.props\n\t\tchangeStep && changeStep(i)\n\t}\n\trender(){\n\t\tconst self = this\n\t\tlet { steps , current } = this.props\n\t\treturn (\n\t\t\t<div className='steps-contain'>\n\t\t\t\t{\n\t\t\t\t\tsteps.map((step,i)=>{\n\t\t\t\t\t\tlet checked = i < current\n\t\t\t\t\t\tlet arrow =  i != (steps.length - 1)  ? <Arrow  checked={ checked } /> : null\n\t\t\t\t\t\treturn(\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t<Step \n\t\t\t\t\t\t\t\t\ttitle={step['title']}\n\t\t\t\t\t\t\t\t\ti={i} \n\t\t\t\t\t\t\t\t\tchecked={ checked }\n\t\t\t\t\t\t\t\t\thandleClick={self.handleChange}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t{ arrow }\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t)\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t</div>\n\t\t)\n\t}\n}\n\n\nexport function Step(props){\n\tlet { checked, title, handleClick, i  } = props\n\treturn (\n\t\t<div\n\t\t\tclassName={ checked ? 'step-contain' : 'step-contain unchecked' }\n\t\t\tonClick={handleClick.bind(null,i+1)}\n\t\t\t>\n\t\t\t{ title }\n\t\t</div>\n\t)\n}\n\n\nexport function Arrow(props){\n\tlet { checked } = props\n\treturn (\n\t\t<div \n\t\t\tclassName={ checked ? 'arrow-contain' : 'arrow-contain unchecked' }\n\t\t>\n\t\t\t<MyIcon type='icon-arrow-'/>\n\t\t</div>\n\t)\n}","import React, { Component } from 'react';\nimport { connect } from 'react-redux'\n\nimport Node from './Node.js'\nimport MyMap from '@/components/map/index.js'\nimport NumberRow from '@/components/config/NumberRow'\nimport './ResNode.scss'\nimport { Steps,Popover,Button, Divider} from 'antd';\nimport { MyIcon } from '@/components/iconfont'\nimport Timeline from '@/components/time/Timeline'\nimport Event from '@/util/event'\nimport { Steps as MySteps } from '@/components/config/Step'\n\nconst { Step } = Steps;\n\n\nclass ResNode extends Component{\n\tconstructor( props ){\n\t\tsuper(props)\n\t\tthis.state = {\n\t\t\tcurrent: 1,\n\t\t\tsteps : [\n\t\t\t\t{ title : 'Spatial Partition', },\n\t\t\t\t{ title : 'Information Graph', },\n\t\t\t\t{ title : 'Exploration', }\n\t\t\t],\n\t\t\trunning : false , \n\t\t\tparams : [\n\t\t\t\t{ \n\t\t\t\t\tid : 'minRaidus' , \n\t\t\t\t\ttitle: 'Minimum Distance Within a Aroup' ,\n\t\t\t\t\tvalue :  1,\n\t\t\t\t\tunit : 'km',\n\t\t\t\t\tstep: 1,\n\t\t\t\t},\n\t\t\t\t{ \n\t\t\t\t\tid : 'maxRaidus' , \n\t\t\t\t\ttitle: 'Maximum Region Radius' ,\n\t\t\t\t\tvalue :  2,\n\t\t\t\t\tunit : 'km',\n\t\t\t\t\tstep: 1,\n\t\t\t\t},\n\t\t\t\t{ \n\t\t\t\t\tid : 'time' , \n\t\t\t\t\ttitle: 'Time Interval' ,\n\t\t\t\t\tvalue :  10,\n\t\t\t\t\tunit : 'min',\n\t\t\t\t\tstep: 2,\n\t\t\t\t},\n\t\t\t\t{ \n\t\t\t\t\tid : 'k' , \n\t\t\t\t\ttitle: 'K in K-Anonymity' ,\n\t\t\t\t\tvalue :  5,\n\t\t\t\t\tunit : '',\n\t\t\t\t\tstep: 3,\n\t\t\t\t},\n\t\t\t],\n\t\t\ttimeRange : null,\n\t\t\tregion : null\n\t\t}\n\t}\n\tchangeStep = current => {\n\t\tthis.setState({ current });\n\t}\n\thandleValueChange = ( paramId , value ) => {\n\t\tlet { params } = this.state\n\t\tparams.map((param) => {\n\t\t\tif(param['id'] == paramId)\n\t\t\t\tparam['value'] = value\n\t\t})\n\t\tthis.setState({ params })\n\t}\n\thandleRun = async () =>{\n\t\tconst { current,params  } = this.state\n\t\tconst { id, condNodeId, source } = this.props\n\t\tlet condition\n\t\tswitch( current ){\n\t\t\tcase 1:\n\t\t\t\tlet minRaidus = getParamsValue( params , 'minRaidus') \n\t\t\t\tthis.setState({ running:true })\n\t\t\t\tcondition = { \n\t\t\t\t\tradius : minRaidus,\n\t\t\t\t\tid,\n\t\t\t\t\tcondNodeId,\n\t\t\t\t\tsource\n\t\t\t\t} \n\t\t\t\tawait this.props.onSpatialPartition( condition )\n\t\t\t\tthis.setState({ running:false })\n\t\t\t\tbreak\n\n\t\t\tcase 2:\n\t\t\t\tthis.setState({ running:true })\n\t\t\t\tcondition = this.getCondition()\n\t\t\t\tawait this.props.onInformationGraph( condition )\n\t\t\t\tthis.setState({ running:false })\n\t\t\t\tbreak\n\n\t\t\tcase 3:\n\t\t\t\tthis.setState({ running:true })\n\t\t\t\tcondition = this.getCondition()\n\t\t\t\tawait this.props.onVisualization( condition )\n\t\t\t\tthis.setState({ running:false })\n\t\t\t\tbreak\n\t\t}\n\t}\n\thandleTimeChange = ( start , end ) =>{\n\t\tconst { params,region  } = this.state\n\t\tlet timeRange = [ \n\t\t\tstart.toString(),\n\t\t\tend.toString()\n\t\t]\n\t\tlet condition = this.getCondition({ timeRange })\n\t\tthis.props.onVisualization( condition )\n\t\tthis.setState({ timeRange })\n\t}\n\thandleRegionSelect = () => {\n\t\tconst self  = this\n\t\tconst { id } = this.props\n\t\tconst ev = Event.get()\n\t\tconst eventName =  id + 'finishGlobalFrameRegion'\n\t\t\n\t\t// 注册回调\n\t\tev.once(eventName , ( data )=>{\n\t\t\tlet region = data['features'][0]['geometry']['coordinates'][0]\n\t\t\tlet condition = self.getCondition( {region} )\n\t\t\tself.props.onVisualization( condition )\n\t\t\tself.setState({ region })\n\t\t})\n\t\t// 触发\n\t\tev.emit('globalSetFrameRegion' , id)\t\n\t}\n\tgetCondition = ( extra ) => {\n\t\tconst { params , timeRange , region  } = this.state\n\t\tconst { id,condNodeId,source } = this.props\n\t\tconst  condition ={\n\t\t\tk : getParamsValue(params , 'k'),\n\t\t\ttimeInterval : getParamsValue(params , 'time'),\n\t\t\tid,\n\t\t\tcondNodeId,\n\t\t\tregion,\n\t\t\ttimeRange,\n\t\t\tsource,\n\t\t\t...extra // 覆盖\n\t\t}\n\t\treturn condition\n\t}\n\tswitchToGlobalMap = () =>{\n\t\tlet { data,id } = this.props\n\t\tthis.props.switchToGlobalMap( { data,id } )\n\t}\n\trender(){\n\t\tconst { props } = this\n\t\tconst { current,steps,params,running } = this.state\n\t\treturn(\n\t\t\t<Node {...props}> \n\t\t\t\t<div className=\"naviga\">\n\t\t\t\t\t<MySteps\n\t\t\t\t\t\tcurrent={current}\n\t\t\t\t\t\tchangeStep={this.changeStep}\n\t\t\t\t\t\tsteps={ steps }\n\t\t\t\t\t/>\n\t\t        </div>\n\n\t\t        <div className='left'>\n\t\t        \t<div className='config'>\n\t\t        \t\t\n\t\t        \t\t{\n\t\t        \t\t\tcurrent == 1 ? (\n\t\t        \t\t\t\t<div className='select-contain'>\n\t\t\t\t\t\t\t\t<Divider className='header'> Partition Method </Divider>\n\t\t\t\t        \t\t<select>\n\t\t\t\t\t\t\t\t  <option value =\"1\">density-based clustering</option>\n\t\t\t\t\t\t\t\t  <option value =\"2\">NxN grid clustering</option>\n\t\t\t\t\t\t\t\t  <option value =\"3\">using station region</option>\n\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t</div>) : null\n\t\t        \t\t}\n\n\t\t\t\t\t\t<Divider className='header'> Parameters </Divider>\n\t\t        \t\t{\n\t\t        \t\t\tparams.filter((param) => param['step'] == current )\n\t\t        \t\t\t\t.map((param)=>(\n\t\t\t\t        \t\t<NumberRow\n\t\t\t\t        \t\t\tkey={ param['id'] }\n\t\t\t\t        \t\t\t{...param}\n\t\t\t\t        \t\t\tonChange={this.handleValueChange} />\n\t\t        \t\t))}\n\t\t        \t</div>\n\n\t\t\t\t\t<div className='bottom'>\n\t        \t\t\t<Button type='primary'\n\t\t        \t\t\t\tcolor={'red'}\n\n\t\t        \t\t\tloading={this.state['running'] }\n\t        \t\t\t\tonClick={ this.handleRun }\n\t        \t\t\t\tclassName='submit-btn type-public'> \n\t        \t\t\t\t\t{ current != 3 ? 'Run' : 'Visualization' } \n\t\t\t\t\t\t</Button>\n\t        \t\t</div>\n\t\t        </div>\n\n\n\t        \t{ current != 3 \n\t\t          ?\t(<div className='right float-box'>\n\t\t\t        \t<MyMap {...props['data']} />\n\t\t\t\t\t\t<div className='open-btn'>\n\t\t\t\t\t\t\t<Button \n\t\t\t\t\t\t\t\tonClick={this.switchToGlobalMap}\n\t\t\t\t\t\t\t\tsize='small'>\n\t\t\t\t\t\t\t\t<MyIcon type='icon-open_in_new-px'/>\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>)\n\t\t\t\t  : (\n\t\t\t\t  \t<div className='right config divide-left'>\n\t\t\t\t\t\t<Divider className='header'> Region Selection </Divider>\n\t\t\t\t\t\t<div className='config__icon'>\n\t\t\t\t\t\t\t<div className='config__icon__title'>\n\t\t\t\t\t\t\t\tRectangle\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className='config__icon__entity'>\n\t\t\t\t\t\t\t\t<Button \n\t\t\t\t\t\t\t\t\tonClick={ this.handleRegionSelect }\n\t\t\t\t\t\t\t\t\tsize='small'>\n\t\t\t\t\t\t\t\t\t<MyIcon type='icon-box-select'/>\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<Divider className='header'> Timeline  </Divider>\n\t\t\t\t\t\t\n\t\t\t\t\t\t<div className='config__time'>\n\t\t\t\t\t\t\t<Timeline \n\t\t\t\t\t\t\t\tstartTime={ props['timeRange'] && props['timeRange']['start'] }\n\t\t\t\t\t\t\t\tendTime={   props['timeRange'] && props['timeRange']['end'] }\n\t\t\t\t\t\t\t\tonChange={this.handleTimeChange}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className='bottom'\n\t\t\t        \t\t\tstyle={{\n\t\t\t        \t\t\t\tpaddingLeft : '5px'\n\t\t\t        \t\t\t}}\n\t\t\t\t\t\t>\n\t\t        \t\t\t<Button type='primary'\n\t\t\t        \t\t\tloading={ false }\n\t\t        \t\t\t\tonClick={null}\n\t\t        \t\t\t\tclassName='submit-btn type-public'> Save as Picture </Button>\n\t\t        \t\t</div>\n\t\t\t\t  \t</div>\n\t\t\t\t  )\n\t\t\t\t}\n\n\t\t\t</Node>\n\t\t)\n\t}\n}\n\n\nconst mapStateToProps = ({ map }) => {\n\treturn {\n\t}\n}\nconst mapDispatchToProps = dispatch => {\n\treturn {\n\t\tswitchToGlobalMap : ( argvs ) => dispatch({\n\t\t\ttype : 'SWITCH_TO_GLOBAL_MAP',\n\t\t\tpayload : argvs\n\t\t})\n\t}\n}\n\nlet HOC = connect(mapStateToProps, mapDispatchToProps)(ResNode)\nexport default HOC\n\n\nvar customDot = (dot, { status, index }) => (\n  <Popover\n    content={\n      <span>\n        step {index} status: {status}\n      </span>\n    }\n  >\n    {dot}\n  </Popover>\n);\n\n\nconst getParamsValue = (params ,  paramId ) =>{\n\tconst set = new Map()\n  \tparams.map(( item ) => set.set( item['id'] , item ))\n  \tlet param = set.get( paramId )\n  \tif( param )\n  \t\treturn param['value']\n  \treturn null\n}\n","import React from \"react\";\nimport {\n  G2,\n  Chart,\n  Geom,\n  Axis,\n  Tooltip,\n  Coord,\n  Label,\n  Legend,\n  View,\n  Guide,\n  Shape,\n  Facet,\n  Util\n} from \"bizcharts\";\nimport DataSet from \"@antv/data-set\";\nimport { POI_COLOR_MAP }  from '@/../server/config'\n\n\nconst styles ={\n  mainTitle:{\n    fontSize:18,\n    color:'#707070',\n    textAlign:\"center\"\n  }\n}\n\nclass Basic extends React.Component {\n  render() {\n    let { statics  } = this.props\n\n    let data = Object.keys( statics ).map((type)=>{\n      return {\n         type,\n         count : statics[type]\n      }\n    })\n\n    const scale = {\n      count:{\n        alias: 'Numbers'\n      },\n      type:{\n        alias: \"Types\"\n      }\n\n    };\n\n    const ds = new DataSet();\n    const dv = ds.createView().source(data);\n    dv.source(data).transform({\n      type: \"sort\",\n      callback(a, b) {\n        // 排序依据，和原生js的排序callback一致\n        return  b.count - a.count;\n      }\n    });\n    return (\n        <Chart\n          scale={scale}\n          data={dv} forceFit\n          height={220}\n          padding={[ 20, 30, 30, 20]}\n        >\n          <h3 className='main-title' style={styles.mainTitle}>\n            The Distirbuion of POI's Types\n          </h3>\n          <Coord />\n          <Axis\n            title={{\n              offset: 10,\n              position: 'end'\n            }}\n            label={null}\n            name=\"type\"\n          />\n          <Axis\n            title={{\n              offset: 5,\n              position: 'end'\n            }}\n            label={null}\n            name=\"count\" />\n          <Tooltip \n\n          />\n          <Geom \n            type=\"interval\"\n            position=\"type*count\"\n            color={\"#FB8072\"}\n            tooltip={['type*count', (type, count) => {\n              return {\n                name: type,\n                value: count\n              };\n            }]}\n            />\n          {/*<Legend name='type' position='top-center' offsetX={5}/>*/}\n        </Chart>\n    );\n  }\n}\n\nexport default Basic","import React, { Component } from 'react';\nimport { connect } from 'react-redux'\nimport Node from './Node.js'\nimport MyMap from '@/components/map/index.js'\nimport { Tabs, Select, Button } from 'antd';\nimport './ResNodePublic.scss'\nimport LineChart from '@/components/chart/line.js'\nimport { MyIcon } from '@/components/iconfont'\n\nconst { TabPane } = Tabs;\nconst { Option } = Select;\n\nclass ResNodePublic extends Component{\n\tconstructor( props ){\n\t\tsuper(props)\n\t\tthis.state = {\n\t\t\tmode : 2 || 2,\n\t\t\tsubMode : 2\n\t\t}\n\t}\n\n\n\tswitchToGlobalMap = () =>{\n\t\tlet { data,id } = this.props\n\t\tthis.props.switchToGlobalMap( { data,id } )\n\t}\n\n\thandleCheck = (i) =>{\n\t\tconsole.log( i)\n\t}\n\trender(){\n\t\tconst { props } = this\n\t\tconst { mode } = this.state\n\t\treturn (\n\t\t\t<Node {...props} > \n\t\t\t\t<div className='public'>\n\t\t\t\t\t<div className='left'>\n\t\t\t\t\t\t<div \n\t\t\t\t\t\t\tclassName={ mode == 1 ? 'sub choose' : 'sub'}\n\t\t\t\t\t\t\tonClick={()=>{this.setState({ mode:1 })}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tData Records\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div \n\t\t\t\t\t\t\tclassName={ mode == 2 ? 'sub choose' : 'sub'}\n\t\t\t\t\t\t\tonClick={()=>{this.setState({ mode:2 })}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tData Statistics\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className='right'>\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmode == 1 \n\t\t\t\t\t\t\t? this.geneRecords()\n\t\t\t\t\t\t\t: this.geneStatics()\n\t\t\t\t\t\t}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</Node>\n\t\t)\n\t}\n\tgeneRecords = () => {\n\t\tconst { props } = this\n\t\tlet { data } = props\n\t\tlet pois = data['datas']['PublicPoiPointsLayer']\n\t\treturn(\n\n\t\t\t<div className='record-contain'>\n\t\t\t\t<div className='head-row record-row'>\n\t\t\t\t\t<div className='record-row__check'>\n\t\t\t\t\t\t<input type=\"checkbox\" \n\t\t\t\t\t\t\tonClick={this.handleCheck.bind(this,'*')}\t\n\t\t\t\t\t\t\tid='all' />\n      \t\t\t\t\t<label htmlFor='all'> </label>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className='record-row__title'>\n\t\t\t\t\t\tSelect ALL\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div className='record-area'>\n\t\t\t\t\t{\n\n\t\t\t\t\t\tpois.map((poi,i)=>(\n\t\t\t\t\t\t<div className='record-row'>\n\n\t\t\t\t\t\t\t<div className='record-row__check' key={i}>\n\t\t\t\t\t\t\t\t<input type=\"checkbox\" \n\t\t\t\t\t\t\t\t\tonClick={this.handleCheck.bind(this,i)}\n\t\t\t\t\t\t\t\t\tid={i} />\n\t\t      \t\t\t\t\t<label htmlFor={i}> </label>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className='record-row__title'>\n\t\t\t\t\t\t\t\t{ poi['name'] }\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t))\n\t\t\t\t\t}\n\t\t\t\t</div>\n\t\t\t</div>\t\t\t\n\t\t)\n\t}\n\tgeneStatics = () => {\n\t\tlet { subMode } = this.state\n\t\treturn(\n\t\t<div\n\t\t\tstyle={{\n\t\t\t\tposition:'relative',\n\t\t\t\twidth : '100%',\n\t\t\t\theight : '100%',\n\t\t\t}}\n\t\t>\n\t\t\t<div className='middle'>\n\t\t\t\t{\n\t\t\t\t\tsubMode == 1\n\t\t\t\t\t\t? this.geneMa()\n\t\t\t\t\t\t: this.geneChart()\n\t\t\t\t}\n\t\t\t</div>\n\t\t\t<div className='left'\n\t\t\t\tstyle={{\n\t\t\t\t\t'float' : 'right'\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<div \n\t\t\t\t\tclassName={ subMode == 1 ? 'sub choose' : 'sub'}\n\t\t\t\t\tonClick={()=>{this.setState({ subMode:1 })}}\n\t\t\t\t>\n\t\t\t\t\tHeatMap\n\t\t\t\t</div>\n\t\t\t\t<div \n\t\t\t\t\tclassName={ subMode == 2 ? 'sub choose' : 'sub'}\n\t\t\t\t\tonClick={()=>{this.setState({ subMode:2 })}}\n\t\t\t\t>\n\t\t\t\t\tTypes\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t)\n\t}\n\tgeneMa = () =>{\n\t\tconst { props } = this\n\t\treturn (\n   \t\t\t<MyMap {...props['data']} />\n\t\t)\n\t}\n\tgeneChart = ()=>{\n\t\tconst { props } = this\n\n\t\treturn (\n\t\t\t<LineChart {...props['data']} />\n\t\t)\n\t}\n}\n\nconst mapStateToProps = ({ map }) => {\n\treturn {\n\t}\n}\nconst mapDispatchToProps = dispatch => {\n\treturn {\n\t\tswitchToGlobalMap : ( argvs ) => dispatch({\n\t\t\ttype : 'SWITCH_TO_GLOBAL_MAP',\n\t\t\tpayload : argvs\n\t\t})\n\t}\n}\n\nlet HOC = connect(mapStateToProps, mapDispatchToProps)(ResNodePublic)\nexport default HOC","import React, { Component } from 'react';\n\nimport Node from './Node.js'\nimport MyMap from '@/components/map/index.js'\nimport NumberRow from '@/components/config/NumberRow'\nimport './CondNode.scss'\nimport { Collapse, Button, Popover, Divider, Checkbox, Row, Col} from 'antd';\nimport Event from '@/util/event'\nimport { MyIcon } from '@/components/iconfont'\nimport { POI_TYPES,POI_COLOR_MAP }  from '@/../server/config'\nimport { COLOR_RED,COLOR_BLUE } from '@/QueryPanel/config'\nconst CheckboxGroup = Checkbox.Group;\n\n\n\nclass CondNode extends Component{\n\tconstructor( props ){\n\t\tsuper(props)\n\t\tthis.state = {\n\t\t\tdataSource : [{\n\t\t\t\tname :  'people',\n\t\t\t\tcolor : COLOR_RED, \n\t\t\t\ticon : \t'icon-7',\n\t\t\t},\n\t\t\t{\n\t\t\t\tname : 'weibo' ,\n\t\t\t\tcolor : COLOR_RED, \n\t\t\t\ticon : \t'icon-weibo'\n\t\t\t},\n\t\t\t{\n\t\t\t\tname : 'taxi' ,\n\t\t\t\tcolor : COLOR_RED, \n\t\t\t\ticon : \t'icon-chuzuche'\n\t\t\t},\n\t\t\t{\n\t\t\t\tname : 'poi' ,\n\t\t\t\tcolor : COLOR_BLUE, \n\t\t\t\ticon : \t'icon-poi'\n\t\t\t}],\n\t\t\tselected: null,\n\t\t\ttime : {\n\t\t\t\tstart : '00:00',\n\t\t\t\tend : '23:59'\n\t\t\t},\n\t\t\tregions : [],\n\t\t\tquerying : false,\n\t\t\tmaps: [],\n    \t\tcheckedList: POI_TYPES.slice(2,6) ,\n    \t\tindeterminate: true,\n    \t\tcheckAll: false,\n\t\t}\n\t}\n\tcomponentWillMount(){\n\t\tlet { dataSource,selected } = this.state\n\n\t\tthis.setState({ selected:dataSource[3] })\n\t}\n\thandleTimeChange = ( label , event) => {\n\t\tlet value = event.target.value\n\t\tlet { time } = this.state\n\t\ttime[ label ] = value\n\t\tthis.setState({ time })\n\t}\n\thandleRegionSelect = () =>{\n\t\tconst self  = this\n\t\tconst { maps } = this.state\n\t\tconst { id } = this.props\n\t\tconst ev = Event.get()\n\t\tconst eventName =  id + 'finishGlobalFrameRegion'\n\t\t\n\t\tev.once(eventName , ( data )=>{\n\t\t\tlet { regions } = self.state\n\t\t\tmaps.push({\n\t\t\t\tparams : {\n\t\t\t\t\t'framSelect' : {\n\t\t\t\t\t    \"cursor\": false,\n\t\t\t\t\t    \"draw\": false,\n\t\t   \t\t\t\t\"visible\": true\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tdatas : {\n\t\t\t\t\t'framSelect' : data\n\t\t\t\t}\n\t\t\t})\n\t\t\tlet region = data['features'][0]['geometry']['coordinates'][0]\n\t\t\tregions.push( region )\n\t\t\tself.setState({ maps,regions })\n\t\t})\n\t\tev.emit('globalSetFrameRegion' , id)\n\t}\n\thandleCondDelete = (map , e)=>{\n\t\tlet { regions } = this.state\n\t\te.preventDefault() \n\t\tlet { maps } = this.state \n\t\tmaps = maps.filter((_map,i) =>{\n\t\t\tif(_map != map){\n\t\t\t\treturn true\n\t\t\t}else{\n\t\t\t\tregions.splice(i,1)\n\t\t\t\treturn false\n\t\t\t}\n\t\t})\n\t\tthis.setState({ maps,regions })\n\t}\n\thandleQuery = async () =>{\n\t\tlet { selected,time,regions,checkedList } = this.state\n\t\tlet { onQuery,id } = this.props\n\t\tconst condition = {\n\t\t\tcondNodeId : id , \n\t\t\tsource : selected,\n\t\t\ttime,\n\t\t\tcheckedList,\n\t\t\tregions : regions[0]  // to do later\n\t\t}\n\t\tif( onQuery ){\n\t\t\tthis.setState({ querying :true })\n\t\t\tlet res = await onQuery( id , condition )\n\t\t\tthis.setState({ querying : false })\n\t\t}\n\t}\n\n\t  onChangeType = checkedList => {\n\t    this.setState({\n\t      checkedList,\n\t      indeterminate: !!checkedList.length && checkedList.length < POI_TYPES.length,\n\t      checkAll: checkedList.length === POI_TYPES.length,\n\t    });\n\t  };\n\n\t  onCheckAllChange = e => {\n\t    this.setState({\n\t      checkedList: e.target.checked ? POI_TYPES : [],\n\t      indeterminate: false,\n\t      checkAll: e.target.checked,\n\t    });\n\t  };\n\n\trender(){\n\t\tconst self = this\n\t\tconst { props } = this\n\t\tconst { dataSource, selected, time, regions, maps,checkedList  } = this.state\n\n\t\treturn(\n\t\t\t<Node {...props} > \n\t\t\t\t<div  className='data-source'>\n\t\t\t\t\t{\n\t\t\t\t\t\tdataSource.map((source,i)=>{\n\t\t\t\t\t\t\treturn(\n\t\t\t\t\t\t\t\t<Popover content={ source['name'] } title={null} key={i} >\n\t\t\t\t\t\t\t\t\t<Button \n\t\t\t\t\t\t\t\t\t\tstyle={{ \n\t\t\t\t\t\t\t\t\t\t\tbackgroundColor : source['color'] , \n\t\t\t\t\t\t\t\t\t\t\topacity :  source['name'] == selected['name'] ? 1 : 0.3\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\tonClick={() => { self.setState({ selected:source })}}\n\t\t\t\t\t\t\t\t\t\ttype=\"primary\" \n\t\t\t\t\t\t\t\t\t\tsize='large'\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<MyIcon type={source['icon']}/>\n\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t</Popover>\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t})\n\t\t\t\t\t}\t\n\t\t\t\t</div>\n\n\t\t\t\t<Divider className='header'>Input Tools</Divider>\n\t\t\t\t\t\n\t\t\t\t<div  className='input'>\n\t\t\t\t\t<div className='input__row'>\n\t\t\t\t\t\t<div className='input__row__title'>\n\t\t\t\t\t\t\tRegion Selection\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className='input__row__selectbtn'\n\t\t\t\t\t\t\tonClick={this.handleRegionSelect}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<MyIcon type='icon-frame-select'/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{\n\t\t\t\t\t\tselected['name'] != 'poi' ? (\n\t\t\t\t\t\t\t<div className='input__row'>\n\t\t\t\t\t\t\t\t<div className='input__row__title'>\n\t\t\t\t\t\t\t\t\tTime Selection\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div className='input__row__time'>\n\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\tonChange={this.handleTimeChange.bind(this,'start')}\n\t\t\t\t\t\t\t\t\t\tdefaultValue={ time['start'] }\n\t\t\t\t\t\t\t\t\t\tclassName={`input__row__time--start  ${( checkTime(time['start']) ? '' : 'error' )}`}/>\n\t\t\t\t\t\t\t\t\t~\n\t\t\t\t\t\t\t\t\t<input \n\t\t\t\t\t\t\t\t\t\tonChange={this.handleTimeChange.bind(this,'end')}\n\t\t\t\t\t\t\t\t\t\tdefaultValue={ time['end'] }\n\t\t\t\t\t\t\t\t\t\tclassName={`input__row__time--end  ${( checkTime(time['end']) ? '' : 'error' )}`}/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t): null\n\t\t\t\t\t\t\t/*<div className='input__blcok'>\n\t\t\t\t\t\t\t          <Checkbox\n\t\t\t\t\t\t\t            indeterminate={this.state.indeterminate}\n\t\t\t\t\t\t\t            onChange={this.onCheckAllChange}\n\t\t\t\t\t\t\t            checked={this.state.checkAll}\n\t\t\t\t\t\t\t          >\n\t\t\t\t\t\t\t          \tSelect All Types\t\t\t\n\t\t\t\t\t\t\t          </Checkbox>\n\t\t\t\t\t\t\t        <br />\n\t\t\t\t\t\t\t        <CheckboxGroup\n\t\t\t\t\t\t\t\t\t  value={this.state.checkedList}\n\t\t\t\t\t\t\t          onChange={this.onChangeType}\n\t\t\t\t\t\t\t        >\n\t\t\t\t\t\t\t            <Row>\n\t\t\t\t\t\t\t\t\t      {POI_TYPES.map((type)=>(\n\t\t\t\t\t\t\t\t\t      \t<Col span={8} key={type}>\n\t\t\t\t\t\t\t\t\t\t\t\t<Checkbox value={type}>{type}</Checkbox>\n\t\t\t\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t\t\t\t style={{ \n\t\t\t\t\t\t\t\t\t\t\t\t\t \tbackgroundColor: POI_COLOR_MAP[type],\n\t\t\t\t\t\t\t\t\t\t\t\t\t \twidth : '20px',\n    \t\t\t\t\t\t\t\t\t\t\t\t\theight: '10px',\n    \t\t\t\t\t\t\t\t\t\t\t\t\tdisplay: 'inline-block'\n\t\t\t\t\t\t\t\t\t\t\t\t\t }}\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t       \t</Col>\n\t\t\t\t\t\t\t\t\t       ))} \n\t\t\t\t\t\t\t\t\t    </Row>\n\t\t\t\t\t\t\t        </CheckboxGroup>\n\t\t\t\t\t\t\t</div>*/\n\t\t\t\t\t\t\n\t\t\t\t\t}\n\n\t\t\t\t</div>\n\n\t\t\t\t<Divider className='header'>Condition List</Divider>\n\n\t\t\t\t<div  className='cond'>\n\t\t\t\t\t{ maps.map((map,i)=>(\n\t\t\t\t\t\t<details className='cond__row' key={i}>\n\t\t\t\t            <summary>\n\t\t\t\t            \t<div className='cond__row__title'>\n\t\t\t\t            \t\tRegion\n\t\t\t\t            \t</div>\n\t\t\t\t            \t<div className='cond__row__btn'\n\t\t\t\t            \t\tonClick={this.handleCondDelete.bind(this , map)}\n\t\t\t\t            \t>\n\t\t\t\t            \t\t<MyIcon  type='icon-shanchu' />\n\t\t\t\t            \t</div>\n\t\t\t\t            </summary>\n\t\t\t            \t<div className='cond__row__map float-box'>\n\t\t\t            \t\t<MyMap  { ...map }\n\t\t\t            \t\t\tref={ref => map.mapRef = ref}/>\n\t\t\t\t            </div>\n\t\t\t\t        </details>\n\t\t\t\t\t))}\n\n\n\t\t\t\t</div>\t\n\n\t\t\t\t<div className='bottom'>\n\t\t        \t<Button\n\t\t        \t\tloading={this.state['querying'] }\n\t\t        \t\tdisabled={ !checkCondition(selected , time , regions ,checkedList ) }\n\t\t        \t\tonClick={this.handleQuery} \n\t\t        \t\ttype='primary' \n\t\t        \t\tclassName='submit-btn'> \n\t\t        \t\tQuery  \n\t\t        \t</Button>\n\t\t\t\t</div>\n\n\t\t\t</Node>\n\t\t)\n\t}\n}\n\nexport default CondNode\n\n/*  Check hour and minutes */\n// e.g. checkTime('05:20')\nconst checkTime = (timeStr) =>{\n\tlet reg = /^(\\d\\d):(\\d\\d)$/\n\tlet res = timeStr.match(reg)\n\tif(!res) return false\n\n\tlet hours = parseInt(res[1])\n\tlet minutes = parseInt(res[2])\n\tif( minutes >= 0 && minutes < 60 && hours>=0 && hours < 24)\n\t\treturn true\n\treturn false\n}\n\nconst checkCondition = ( source , time , regions ,checkedList ) => {\n\tif(source['name'] == 'poi'){\n\t\treturn checkedList.length > 0\n\t}\n\tlet cSource = ( source != null)\n\tlet cTime = ( checkTime( time['start'] ) && checkTime( time['end'] ) )\n\tlet cRegion = regions.length > 0\n\n\treturn ( cSource && cTime && cRegion )\n}","import React,{ Component } from 'react'\n\nimport './Links.scss'\n\nclass Links extends React.Component{\n  constructor() {\n    super(...arguments)\n    this.state = {}\n  }\n  static defaultProps = {\n    width : 100,\n    height : 100,\n  }\n  render(){\n    let { width,height,links } = this.props\n    return (\n     <svg className='links-panel' \n          width={width} \n          height={height}  >\n          <ArrowDefine />\n          {\n            links.map((link,i)=>(\n              <Link key={i} link={link} />\n            ))\n          }\n      </svg>\n    )\n  }\n}\n\n\n\nclass Link extends Component{\n  constructor() {\n    super(...arguments)\n    this.state = {}\n  }\n  static defaultProps = {\n    link : {\n        start : {\n          x : 100 ,\n          y : 100\n        },\n        end : {\n          x : 250,\n          y : 250\n        }\n    }\n  }\n  render(){\n    let { link } = this.props\n    let { start,end } = link\n\n    let _path = svgPathCurv(start , end , 1 )\n\n    return(\n        <path\n          d={_path}\n          className=\"link\"\n          markerEnd={ \"url(#arrow)\" }\n          strokeDasharray={\"10, 5\"}\n        >  \n        </path>\n    )\n  }\n}\n\n\nconst ArrowDefine = () => {\n  const ID = \"arrow\"\n  return (\n    <defs>\n      <marker\n        id={ ID }\n        markerWidth=\"26\"\n        markerHeight=\"26\"\n        viewBox=\"0 0 36 36\"\n        refX=\"18\"\n        refY=\"18\"\n        markerUnits=\"userSpaceOnUse\"\n        orient=\"auto\">\n        <path \n          d=\"M6,6 L30,18 L6,30 L18,18 L6,6\" \n          style={{ 'fill':'#bfbfbf' }}></path>\n      </marker>\n    </defs>\n  )\n}\n\n\n// https://blog.csdn.net/ouyang111222/article/details/51153638\nfunction svgPathCurv(a,b,curv) {\n    /*\n     * 弯曲函数.\n     * a:a点的坐标{x:10,y:10}\n     * b:b点的坐标{x:10,y:20}\n     * curv:弯曲程度 取值 -5 到 5 \n     */\n    curv = curv ? curv : 0;\n    var s, q, l, path = '',k2\n    var s = 'M' + a.x + ',' + a.y + ' ';\n\n    /*\n     * 控制点必须在line的中垂线上\n     * **求出k2的中垂线(中垂线公式)**\n     */\n    k2 = -(a['x'] - b['x']) / (b['y'] - a['y']);\n    /*\n     * 弯曲程度是根据中垂线斜率决定固定控制点的X坐标或者Y坐标,通过中垂线公式求出另一个坐标\n     * 默认A/B中点的坐标+curv*30,可以通过改基数30改变传入的参数范围\n     */\n\n     const _center = ( s ,e ) => {\n      return {\n          x : (s['x'] + e['x']) / 2,\n          y : (s['y'] + e['y']) / 2\n       }\n     }\n\n     let c0 = _center(a , b) ,\n         c1 = _center(a , c0),\n         c2 = _center(c0 , b)\n\n\n     if( k2 > 50 || k2 < -50){\n        k2 = 50\n     } \n\n     c1['x']  = c1['x'] + curv  \n     c1['y']  = k2 * curv + c1['y']\n\n     c2['x']  = c2['x'] - curv  \n     c2['y']  = -k2 * curv + c2['y']\n\n\n    //定义控制点的位置\n\n    q = 'C' + c1['x'] + ',' + c1['y'] + ' ' + c2['x'] + ',' + c2['y'] + ' ';\n    //l=lineto\n    l = b['x'] + ',' + b['y'] + ' ';\n    //结果例: M10,10Q35,15,10,20 \n    path = s + q + l ;\n    return path;\n}\n\nexport default Links","const ADDRESS = (process.env.NODE_ENV == \"development\") \n    ?  'localhost'\n    : '116.62.46.132'\n    \nconst PORT = 3001\n\n/** 用于向后端发起查询请求的辅助类 */\nexport class Query {\n  data = {};\n  queryData = {};\n  url = `ws://${ADDRESS}:${PORT}/ws`;\n  ws = null;\n  /**\n   * 构造函数，初始化查询url。\n   * @param {url} url 查询路径\n   * @param {queryData} queryData 发送给服务区的数据\n   */\n  constructor(url = '', queryData  = null) {\n    this.url += url;\n    this.queryData = queryData;\n  }\n\n  /**\n   * 私有函数，向服务器端发送数据，构造异步迭代器。\n   */\n  async _connect() {\n    this.ws = await connect(this.url);\n    this.queryData = JSON.stringify(this.queryData)\n    this.ws.send(this.queryData);\n    const that = this;\n    this.data[Symbol.asyncIterator] = async function* () {\n      while (that.ws.readState != 3) {\n        yield (await oncePromise(that.ws, 'message')).data;\n      }\n    };\n  }\n\n  /**\n   * 获取服务端传输的数据。\n   * @return {data} 返回异步的可迭代对象data。\n   */\n  async getData() {\n    await this._connect();\n    return this.data;\n  } \n}\n\n\nexport async function fetchWS( router , param = null ){\n\n  const q = new Query(router, param )\n  const data = await q.getData()\n  for await (const d of data) {\n      const res = JSON.parse(d)\n      return res\n  }\n}\n\n/**\n * Promise封装的WebSocket函数，用于向后端建立连接。\n * @param {url} url 查询路径\n * @return {PromiseObject} 返回Promise封装的WebSocket对象\n*/\nfunction connect(url) {\n  return new Promise((resolve, reject) => {\n    const ws = new WebSocket(url);\n    ws.onopen = function() {\n      resolve(ws);\n    };\n    ws.onerror = function() {\n      reject(ws);\n    };\n  });\n}\n\n/**\n * Promise封装添加事件函数，每个事件仅触发一次。\n * @param {emitter} emitter 监听事件的对象\n * @param {event} event 监听的事件\n * @return {PromiseObject} 返回Promise封装的对象\n */\nconst oncePromise = (emitter, event) => {\n  return new Promise((resolve) => {\n    const handler = (...args) => {\n      emitter.removeEventListener(event, handler);\n      resolve(...args);\n    };\n    emitter.addEventListener(event, handler);\n  });\n};","import { RES_NODE ,COND_NODE ,TYPE_RES_NODE, TYPE_COND_NODE } from './config'\n\n\nlet idBase = 0\nconst TIMES = 1000\nexport const geneNode = ( type,width,height , baseNode ) =>{\n\n\tlet node = ( type == TYPE_COND_NODE ) ? COND_NODE : RES_NODE \n\n\twidth = ( type == TYPE_COND_NODE ) ? width/2 : width\n\tconst _gen = () => {\n\t\tlet x = width * Math.random()  - node['width'],\n\t\t\ty = height * Math.random() -  node['height']\n\t\treturn { x ,y }\n\t}\n\tconst rightThanBaseNode = (x,y) =>{\n\t\tif( baseNode ){\n\t\t\treturn (  x > baseNode['x'] && Math.abs( y - baseNode['y'] ) < 200 )\n\t\t}\n\t\treturn true\n\t}\n\n\tlet { x , y } = _gen()\n\n\tlet count = 0\n\twhile( x < 0 || y < 0 || !rightThanBaseNode(x,y) ){\n\t\tlet res = _gen()\n\t\tx = res['x']\n\t\ty = res['y']\n\t\tcount++\n\t\tif(count > TIMES) break;\n\t}\n\t\n\treturn {\n\t\tid : idBase++,\n\t\ttype , \n\t\tx,\n\t\ty,\n\t\twidth : node['width'],\n\t\theight : node['height'],\n\t}\n}\n\n\nexport const geneLink = ( nodeStart , nodeEnd ) =>{\n\treturn {\n\t\tstart : {\n\t\t\t id : nodeStart['id'],\n\t\t\t x : nodeStart['x'] + COND_NODE['width'] + 4,\n\t\t\t y : nodeStart['y'] + COND_NODE['height'] / 2\n\t\t},\n\t\tend : {\n\t\t\tid : nodeEnd['id'],\n\t\t\tx  : nodeEnd['x'] - 4,\n\t\t\ty  : nodeEnd['y'] + RES_NODE['height'] / 2\n\t\t}\n\t}\n}","import { COLOR_RED as COLOR_PRIVATE,\n\t\t COLOR_BLUE as COLOR_PUBLIC } from './config'\n\nexport const taxiSearchCondition =  () => {\n\treturn {\n\t\t  \"condNodeId\": 0,\n\t\t  \"source\": {\n\t\t\t\tname : 'taxi' ,\n\t\t\t\tcolor : COLOR_PRIVATE , \n\t\t\t\ticon : \t'icon-chuzuche'\n\t\t\t},\n\t\t  \"time\": {\n\t\t    \"start\": \"01:22\",\n\t\t    \"end\": \"08:45\"\n\t\t  },\n\t\t  \"regions\": [\n\t\t    [\n\t\t      120.60172173806302,\n\t\t      28.03901714020917\n\t\t    ],\n\t\t    [\n\t\t      120.7091164652158,\n\t\t      28.03901714020917\n\t\t    ],\n\t\t    [\n\t\t      120.7091164652158,\n\t\t      27.987819597085878\n\t\t    ],\n\t\t    [\n\t\t      120.60172173806302,\n\t\t      27.987819597085878\n\t\t    ],\n\t\t    [\n\t\t      120.60172173806302,\n\t\t      28.03901714020917\n\t\t    ]\n\t\t  ]\n\t\t}\n}\n\nexport const taxiGraphCondition =  (resNodeId , condNodeId ) => {\n\treturn {\n\t\t  \"id\": resNodeId,\n\t\t  \"condNodeId\": condNodeId,\n\t\t  \"k\": 5,\n\t\t  \"timeInterval\": 10,\n\t\t  \"region\": [\n\t\t    [\n\t\t      120.60466748065197,\n\t\t      28.0314177803758\n\t\t    ],\n\t\t    [\n\t\t      120.70310305847188,\n\t\t      28.0314177803758\n\t\t    ],\n\t\t    [\n\t\t      120.70310305847188,\n\t\t      27.983296387860495\n\t\t    ],\n\t\t    [\n\t\t      120.60466748065197,\n\t\t      27.983296387860495\n\t\t    ],\n\t\t    [\n\t\t      120.60466748065197,\n\t\t      28.0314177803758\n\t\t    ]\n\t\t  ],\n\t\t  \"timeRange\": [\n\t\t    \"Sat Jan 01 2000 01:22:00 GMT+0800 (中国标准时间)\",\n\t\t    \"Sat Jan 01 2000 08:34:07 GMT+0800 (中国标准时间)\"\n\t\t  ],\n\t\t  \"source\":{\n\t\t  \t\"name\":\"taxi\",\n\t\t  \t\"color\": COLOR_PRIVATE ,\n\t\t  \t\"icon\":\"icon-chuzuche\"\n\t\t  }\n\t}\n}\n\n\nexport const weiboSearchCondition = () =>{\n\treturn {\n\t  \"condNodeId\": 0,\n\t  \"source\":{\n\t\t\tname : 'weibo' ,\n\t\t\tcolor : COLOR_PRIVATE, \n\t\t\ticon : \t'icon-weibo'\n\t\t},\n\t  \"time\": {\n\t    \"start\": \"07:22\",\n\t    \"end\": \"08:45\"\n\t  },\n\t  \"regions\": [\n\t    [\n\t      120.60172173806302,\n\t      28.03901714020917\n\t    ],\n\t    [\n\t      120.7091164652158,\n\t      28.03901714020917\n\t    ],\n\t    [\n\t      120.7091164652158,\n\t      27.987819597085878\n\t    ],\n\t    [\n\t      120.60172173806302,\n\t      27.987819597085878\n\t    ],\n\t    [\n\t      120.60172173806302,\n\t      28.03901714020917\n\t    ]\n\t  ]\n\t}\t\n}\n\nexport const weiboGraphCondition = ( resNodeId , condNodeId )=>{\n\treturn {\n\t\t  \"id\": resNodeId,\n\t\t  \"condNodeId\": condNodeId,\n\t\t  \"k\": 5,\n\t\t  \"timeInterval\": 10,\n\t\t  \"region\": [\n\t\t    [\n\t\t      120.60466748065197,\n\t\t      28.0314177803758\n\t\t    ],\n\t\t    [\n\t\t      120.70310305847188,\n\t\t      28.0314177803758\n\t\t    ],\n\t\t    [\n\t\t      120.70310305847188,\n\t\t      27.983296387860495\n\t\t    ],\n\t\t    [\n\t\t      120.60466748065197,\n\t\t      27.983296387860495\n\t\t    ],\n\t\t    [\n\t\t      120.60466748065197,\n\t\t      28.0314177803758\n\t\t    ]\n\t\t  ],\n\t\t  \"timeRange\": [\n\t\t    \"Sat Jan 01 2000 01:22:00 GMT+0800 (中国标准时间)\",\n\t\t    \"Sat Jan 01 2000 08:34:07 GMT+0800 (中国标准时间)\"\n\t\t  ]\n\t\t}\n}\n\n\nexport const  poiQueryCondition = () =>{\n\treturn {\n\t  \"condNodeId\": 0,\n\t  \"source\":{\n\t\t\tname : 'poi' ,\n\t\t\tcolor : COLOR_PUBLIC, \n\t\t\ticon : \t'icon-poi'\n\t\t}\n\t}\n}","import React, { Component } from 'react';\nimport { connect } from 'react-redux'\nimport { Button } from 'antd';\nimport { DropTarget } from 'react-dnd'\nimport { RES_NODE, COND_NODE, TYPE_RES_PUBLIC_NODE,\n\t\tTYPE_RES_NODE, TYPE_COND_NODE } from './config'\nimport ResNode from '@/components/query/ResNode.js'\nimport ResNodePublic from '@/components/query/ResNodePublic.js'\nimport CondNode from '@/components/query/CondNode.js'\nimport Links from '@/components/query/Links.js'\nimport { MyIcon } from '@/components/iconfont'\nimport { fetchWS } from '@/util/query.js'\nimport * as util from './util'\nimport './index.scss'\nimport { colorScale }  from '@/components/map/util'\nimport { taxiSearchCondition,\n\t\t taxiGraphCondition,\n\t\t weiboSearchCondition,\n\t\t weiboGraphCondition,\n\t\t poiQueryCondition } from './mock.js'\n\nclass QueryPanel extends Component {\n\tconstructor( props ){\n\t\tsuper(props)\n\t\tthis.state = {\n\t\t\tnodes : [],\n\t\t\twidth : 100,\n\t\t\theight : 100,\n\t\t\tlinks : []\n\t\t}\n\t}\n\tcomponentDidMount(){\n      \tlet { clientWidth, clientHeight } = this.panelRef  // after Did Mount\n\n      \tthis.setState({\n      \t\twidth : clientWidth,\n      \t\theight : clientHeight\n      \t})\n\n      \t// let condNodeId = this.addCondNode()\n      \t// this.mockTaxi()\n      \t// this.mockWeibo()\n      \t// this.mockPOI()\n\t}\n\tmoveNode(id,x,y){\n      \tlet { scrollHeight , scrollWidth } = this.panelRef\n      \t// console.log( scrollHeight , scrollWidth )\n\t  \tlet { nodes,links }  = this.state\n\n\t  \tnodes = nodes.map((node)=>{\n\t  \t\tif(node['id'] == id){\n\t  \t\t\tnode['x'] = x\n\t  \t\t\tnode['y'] = y\n\t  \t\t}\n\t  \t\treturn node\n\t  \t})\n\t  \tlinks = links.map((link)=>{\n\t  \t\tlet { start,end } = link\n\t  \t\tif(start['id'] == id  || end['id'] == id){\n\t  \t\t\tlet startNode = nodes.find((node)=> node['id'] == start['id'])\n\t  \t\t\tlet endNode   = nodes.find((node)=> node['id'] == end['id'])\n\t  \t\t\treturn util.geneLink( startNode,endNode )\n\t  \t\t}\n\t  \t\treturn link\n\t  \t})\n\n\t\tthis.setState({ \n\t\t\tnodes,links,\n\t\t\twidth : scrollWidth,\n\t\t\theight : scrollHeight\n\t\t})\n\t}\n\t// For Cond Node to Query \n\thandleQuery = async ( id , condition ) => {\n\t\tconsole.log(condition)\n\t\tlet { nodes } = this.state\n\t\tlet { source, time, regions, condNodeId } = condition\n\t\tlet condNode = nodes.find((node)=>node['id'] == condNodeId)\n\t\tlet node\n\t\tif( source['name'] == 'poi'){\n\t\t\tnode = this.geneNode(TYPE_RES_PUBLIC_NODE , condNode)\n\t\t}else{\n\t\t\tnode = this.geneNode(TYPE_RES_NODE , condNode)\n\t\t}\n\t    node['timeRange'] = condition['time']\n\t    node['source'] = source\n\n\t\tconst params = {\n\t\t\tradius : 1 ,\n\t\t\t...condition,\n\t\t\tid : node['id']\n\t\t}\n\n\t\tlet data  ,num \n\t\tswitch(source['name']){\n\t\t\tcase \"taxi\":\n\t\t\t\tdata = await fetchWS('/taxiSpatialPartition' , params )\n\t\t\t\tnum = data['num']\n\t\t\t    data = {\n\t\t\t    \tparams : {\n\t\t\t    \t\t'VoronoiRegion' : {},\n\t\t\t    \t\t'AnonymousTrajectoryLayer' : {}\n\t\t\t    \t},\n\t\t\t    \tdatas : {\n\t\t\t    \t\t'VoronoiRegion' : data['data'] \n\t\t\t    \t}\n\t\t\t    }\n\t\t\t    break\n\n\t\t\tcase \"weibo\":\n\t\t\t\tdata = await fetchWS('/weiboSpatialPartition' , params )\n\t\t\t\tnum = data['num']\n\t\t\t    data = {\n\t\t\t    \tparams : {\n\t\t\t    \t\t'VoronoiRegion' : {},\n\t\t\t    \t\t'ChoroplethMap' : {}\n\t\t\t    \t},\n\t\t\t    \tdatas : {\n\t\t\t    \t\t'VoronoiRegion' : data['data']\n\t\t\t    \t}\n\t\t\t    }\n\t\t\t\tbreak\n\n\t\t\tcase \"poi\":\n\t\t\t\tlet datas = await fetchWS('/pois',params)\n\t\t\t\tnum = datas['num']\n\t\t\t\tdata = {\n\t\t\t    \tparams : {\n\t\t\t    \t\t'PublicPoiPointsLayer' : {}\n\t\t\t    \t},\n\t\t\t    \tdatas : {\n\t\t\t    \t\t'PublicPoiPointsLayer' : datas['data']\n\t\t\t    \t},\n\t\t\t    \tstatics : datas['statics']\n\t\t\t\t}\n\t\t\t\tbreak\n\t\t\t\t\n\t\t\tdefault:\n\t\t\t\tdata = []\n\n\t\t}\n\t\tnode['num'] = num\n\t\tthis.addResNode( node , data , id )\n\t\treturn node['id']\n\t}\n\t// Res Node first Run Btn \n\thandleSpatialPartition = async (condition) => {\n\t\tconsole.log( condition )\n\t\tlet { id, source } = condition\n\t\tlet { nodes } = this.state\n\n\t\tlet data \n\t\tswitch(source['name']){\n\t\t\tcase \"taxi\":\n\t\t\t\tdata = await fetchWS('/taxiSpatialPartition' , condition )\n\t\t\t    break\n\t\t\tcase \"weibo\":\n\t\t\t\tdata = await fetchWS('/weiboSpatialPartition' , condition )\n\t\t\t\tbreak\n\n\t\t\tdefault:\n\t\t\t\tdata = []\n\t\t}\n\t\t\n\t    nodes.map((node)=>{\n\t    \tif(node['id'] == id){\n\t\t\t\tnode['num'] = data['num']\n\t    \t\tnode['data']['datas']['VoronoiRegion'] = data['data']\n\t    \t}\n\t    })\n\t    this.setState({  nodes })\n\t    return\n\t}\n\t// Res Node Second Run Btn\n\thandleInformationGraph = async (condition) => {\n\t\tlet { nodes } = this.state\n\t\tlet { id,source } = condition\n\t\tlet data , retNode\n\t    nodes.map((node)=>{\n\t    \tif(node['id'] == id){\n\t    \t\tretNode = node\n\t    \t}\n\t    })\n\n\t\tswitch(source['name']){\n\t\t\tcase \"taxi\":\n\t\t\t\tdata = await fetchWS('/taxiInformationGraph' , condition )\n\t    \t\tretNode['data']['datas']['AnonymousTrajectoryLayer'] = data\n\t\t\t    break\n\n\t\t\tcase \"weibo\":\n\t\t\t\tdata = await fetchWS('/weiboInformationGraph' , condition )\n\n\t\t\t\tlet scale = colorScale(  data , (d)=>d['support'] )\n\t\t\t\tdata = data.map((d)=> {\n\t\t\t\t\td['fillColor'] = scale( d['support'] )\n\t\t\t\t\treturn d\n\t\t\t\t})\n\t    \t\tretNode['data']['datas']['ChoroplethMap'] = data\n\n\t\t\t\tbreak\n\t\t\tdefault:\n\t\t\t\tdata = []\n\t\t}  \n\n\t    this.setState({  nodes })\n\t    return retNode\n\t}\n\t// Res Node Third Step\n\thandleVisualization = async (condition) =>{\n\t\t// console.log(  condition )\n\t\tlet { id } = condition\n \t\tlet node = await this.handleInformationGraph( condition )\n \t\tlet { data } = node\n \t\tthis.props.switchToGlobalMap({ id,data })\n\t\treturn\n\t}\n\tgeneNode = ( type = TYPE_COND_NODE , condNode ) => {\n\t\t// let { clientWidth, clientHeight } = this.panelRef  // after Did Mount\n      \tlet { scrollHeight , scrollWidth } = this.panelRef\n\t\tlet node = util.geneNode(type, scrollWidth ,scrollHeight , condNode)\t\n\t\treturn node \n\t}\n\taddResNode = (node , data , condNodeId) => {\n\t\tlet { nodes } = this.state \n\t\tnode['data'] = data\n\t\tnode['condNodeId'] = condNodeId\n\t\tnodes.push( node )\n\t\tthis.setState({ nodes })\n\n\t\tlet startNode = nodes.find((node)=>node['id'] == condNodeId)\n\t\tthis.addLink( startNode , node )\n\t}\t\n\taddCondNode = () =>{\n\t\tlet { nodes } = this.state \n\t\tlet node = this.geneNode( TYPE_COND_NODE )\n\t\tnodes.push( node )\t\n\t\tthis.setState({ nodes })\n\t\treturn node['id']\n\t}\n\taddLink = (startNode , endNode ) =>{\n\t\tlet { links } = this.state\n\t\tlinks.push(  util.geneLink( startNode , endNode ) )\n\t\tthis.setState({ links })\n\t}\n\thandleDeleteNode = ( id ) =>{\n\t\tlet { nodes,links } = this.state\n\t\tnodes = nodes.filter((node)=> node['id'] != id )\n\t\tlinks = links.filter((link)=> link['start']['id'] != id && link['end']['id'] )\n\t\tthis.setState({ nodes,links })\n\t}\n\trender(){\n\t\tconst self = this\n    \tconst { connectDropTarget } = this.props\n\t\tconst { nodes } = this.state\n\t\treturn connectDropTarget(\n\t\t\t<div className='query-app' ref={ref => self.panelRef = ref }> \n\n\t\t\t\t{\n\t\t\t\t\tnodes.map((node,i)=>{\n\t\t\t\t\t\tlet { type } = node\n\t\t\t\t\t\tif(type == TYPE_RES_NODE){\n\t\t\t\t\t\t\treturn ( \n\t\t\t\t\t\t\t\t<ResNode  \n\t\t\t\t\t\t\t\t\tkey={i} {...node} \n\t\t\t\t\t\t\t\t\tonNodeDelete={this.handleDeleteNode}\n\t\t\t\t\t\t\t\t\tonSpatialPartition={this.handleSpatialPartition}\n\t\t\t\t\t\t\t\t\tonInformationGraph={this.handleInformationGraph}\n\t\t\t\t\t\t\t\t\tonVisualization={this.handleVisualization}\n\t\t\t\t\t\t\t\t/> \n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t}else if(type == TYPE_RES_PUBLIC_NODE){\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<ResNodePublic \n\t\t\t\t\t\t\t\t\tkey={i} {...node} \n\t\t\t\t\t\t\t\t\tonNodeDelete={this.handleDeleteNode}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\treturn ( \n\t\t\t\t\t\t\t\t<CondNode  \n\t\t\t\t\t\t\t\t\tonNodeDelete={this.handleDeleteNode}\n\t\t\t\t\t\t\t\t\tkey={i} {...node}\n\t\t\t\t\t\t\t\t\tonQuery={this.handleQuery}\n\t\t\t\t\t\t\t\t/> \n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t}\n\n\t\t\t\t<Links\n\t\t\t\t\tlinks={this.state.links}\n\t\t\t\t\twidth={this.state.width}\n\t\t\t\t\theight={this.state.height}\n\t\t\t\t/>\n\t\t\t\t\n\t\t\t\t<div className='add-btn'>\n\t\t\t\t\t<Button \n\t\t\t\t\t\tonClick={self.addCondNode}\n\t\t\t\t\t\ttype=\"primary\" shape=\"circle\"  size='large'>\n\t\t\t\t\t\t<MyIcon type='icon-add'/>\n\t\t\t\t\t</Button>\n\t\t\t\t</div>\n\n\t\t\t</div>\n\t\t)\n\t}\n\tasync mockTaxi(){\n      \tlet condNodeId = this.addCondNode()\n      \tlet cond = taxiSearchCondition()\n\n\t\tlet resNodeId = await this.handleQuery( condNodeId , cond )\n\t\tcond = taxiGraphCondition( condNodeId , resNodeId )\n\t\t// this.handleVisualization( cond )\n\t}\n\tasync mockWeibo(){\n      \tlet condNodeId = this.addCondNode()\n      \tlet cond = weiboSearchCondition()\n\t\tlet resNodeId = await this.handleQuery( condNodeId , cond )\n\t\tcond = weiboGraphCondition( condNodeId,resNodeId )\n\t\t// this.handleVisualization( cond )\n\t}\n\tasync mockPOI(){\n      \tlet condNodeId = this.addCondNode()\n      \tlet cond = poiQueryCondition()\n\n\t\tlet resNodeId = await this.handleQuery( condNodeId , cond )\n\n\t\t// this.handleVisualization( cond )\n\t}\n}\n\nconst mapStateToProps = ({}) => {\n\treturn {}\n}\nconst mapDispatchToProps = dispatch => {\n\treturn {\n\t\tswitchToGlobalMap : ( argvs ) => dispatch({\n\t\t\ttype : 'SWITCH_TO_GLOBAL_MAP',\n\t\t\tpayload : argvs\n\t\t})\n\t}\n}\n\nconst targetSpec =  {\n\t// called when a item is dropped on target\n  drop(props, monitor, component) { \n    if (!component) {   //该组件的实例     \n      return null\n    }\n    const item = monitor.getItem()   //  获取 drag 对象 ，来自与 dragsource 的 beginDrag的返回    // monitor 为 DropTargetMonitor 的实例\n    const delta = monitor.getDifferenceFromInitialOffset()\n    if(!delta || !item)  return\n    const x = Math.round(item.x + delta.x)\n    const y = Math.round(item.y + delta.y)\n    component.moveNode(item.id, x, y)  //调用本组件的函数\n\n  },\n\t// 拖动的时候也触发\n  hover(props, monitor, component) {  \n    if (!component) {     \n      return null\n    }\n\n    return\n    \n    const item = monitor.getItem() \n    const delta = monitor.getDifferenceFromInitialOffset()\n    const x = Math.round(item.x + delta.x)\n    const y = Math.round(item.y + delta.y)\n    component.moveNode(item.id, x, y) \n  },\n}\n\nfunction collect( connect , monitor ){\n  return {\n    connectDropTarget: connect.dropTarget(),\n  }\n} \n\nQueryPanel = DropTarget('NODE' , targetSpec , collect )(QueryPanel)\nQueryPanel = connect(mapStateToProps, mapDispatchToProps)(QueryPanel)\n\nexport default QueryPanel","import React, { Component } from 'react';\nimport './App.scss';\nimport MapPanel from './MapPanel/index'\nimport QueryPanel from './QueryPanel/index'\nimport { connect } from 'react-redux'\nimport PropTypes from 'prop-types'\n\nclass App extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {}\n    }\n    render() {\n      return (\n        <div className=\"App\">\n            <div className='map-view' >\n              <MapPanel />\n            </div>\n\n            <div className='query-view' >\n              <QueryPanel />\n            </div>\n        </div>\n      );\n    }\n}\n\n\nexport default  App\n","\nconst INITIAL_STATE = {\n\tcurrentMapId : -1,\n\tdata : {}\n}\n\nexport default function update( state = INITIAL_STATE , action) {\n\tswitch( action.type ){\n\t\tcase 'SWITCH_TO_GLOBAL_MAP':\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tcurrentMapId : action.payload['id'],\n\t\t\t\tdata : action.payload['data']\n\t\t\t}\n\t\tdefault: \n\t\t\treturn state\n\t}\n}\n\n","import { combineReducers } from 'redux'\n\nimport map from './map'\n\nexport default combineReducers({\n\tmap\n})\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport 'antd/dist/antd.css';\nimport * as serviceWorker from './serviceWorker';\nimport App from './App'\nimport store from './store/index.js'\n\nimport { createStore} from 'redux'\nimport { Provider } from 'react-redux'\nimport { DndProvider } from 'react-dnd'\nimport Backend from 'react-dnd-html5-backend'\n\nfunction Index() {\n\treturn (\n\t\t<Provider store={createStore(store)}>\n\t\t\t<DndProvider backend={Backend}>\n\t\t\t\t    <App />\n\t\t\t</DndProvider>\n\t\t</Provider>\t\t\n\t)\n}\n\nReactDOM.render(<Index/> , document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}